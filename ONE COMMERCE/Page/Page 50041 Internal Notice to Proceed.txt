OBJECT Page 50041 Internal Notice to Proceed
{
  OBJECT-PROPERTIES
  {
    Date=07/05/18;
    Time=10:14:32 PM;
    Modified=Yes;
    Version List=NAVW25.00.00.03;
  }
  PROPERTIES
  {
    CaptionML=ENU=Internal Notice to Proceed;
    SourceTable=Table50040;
    PageType=Document;
    PromotedActionCategoriesML=ENU=New,Process,Report,Approve,Release,Posting,Prepare,Jobs,Request Approval,General;
    OnOpenPage=BEGIN
                 SetDocNoVisible;
                 SetControlVisibility;
               END;

    OnAfterGetRecord=BEGIN
                       SetControlVisibility;

                       CALCFIELDS(Comments);
                       IF Comments.HASVALUE THEN BEGIN
                         Comments.CREATEINSTREAM(InStr);
                         InStr.READ(CommentTxt);
                       END;

                       CurrPage.ApprovalEntry.PAGE.GetApprovers(Rec);
                     END;

    OnModifyRecord=BEGIN

                     CurrPage.ApprovalEntry.PAGE.GetApprovers(Rec);
                   END;

    OnAfterGetCurrRecord=BEGIN
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);

                           CurrPage.ApprovalEntry.PAGE.GetApprovers(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 139     ;0   ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 40      ;1   ;Action    ;
                      Name=ChangeLogs;
                      CaptionML=ENU=Change Logs;
                      PromotedIsBig=Yes;
                      Image=ChangeLog;
                      OnAction=VAR
                                 ChangeLogPage@1000 : Page 595;
                                 TableIds@1001 : Text;
                               BEGIN
                                 TableIds := FORMAT(DATABASE::"Internal Notice to Proceed");
                                 ChangeLogPage.SetPageFilter(TableIds, "No.");
                                 ChangeLogPage.RUN;
                               END;
                                }
      { 39      ;1   ;Action    ;
                      Name=Approvals;
                      CaptionML=ENU=Approvals;
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Page 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Internal Notice to Proceed",6,"No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 197     ;1   ;ActionGroup;
                      CaptionML=ENU=Sales }
      { 194     ;2   ;Action    ;
                      Name=Sales Invoices;
                      Description=View Invoices;
                      Image=Invoice;
                      OnAction=VAR
                                 InvoicesList@1000 : Page 143;
                               BEGIN
                                 InvoicesList.FilterINTP(Rec);
                                 InvoicesList.RUN;
                               END;
                                }
      { 195     ;2   ;Action    ;
                      Name=Shipments;
                      Description=View Invoices;
                      Image=Invoice;
                      OnAction=VAR
                                 PostedSalesShipments@1000 : Page 142;
                               BEGIN
                                 PostedSalesShipments.FilterINTP(Rec);
                                 PostedSalesShipments.RUN;
                               END;
                                }
      { 198     ;1   ;ActionGroup;
                      CaptionML=ENU=Purchases }
      { 196     ;2   ;Action    ;
                      Name=Purchase Invoice;
                      Description=View Invoices;
                      Image=Invoice;
                      OnAction=VAR
                                 PurchaseInvoices@1000 : Page 146;
                               BEGIN
                                 PurchaseInvoices.FilterINTP(Rec);
                                 PurchaseInvoices.RUN;
                               END;
                                }
      { 199     ;2   ;Action    ;
                      Name=Receipts;
                      Description=View Invoices;
                      Image=Invoice;
                      OnAction=VAR
                                 ReceiptsList@1000 : Page 145;
                               BEGIN
                                 ReceiptsList.FilterINTP(Rec);
                                 ReceiptsList.RUN;
                               END;
                                }
      { 201     ;2   ;Action    ;
                      Name=Purchase Orders;
                      Description=View Purchase Orders;
                      Image=Document;
                      RunPageMode=View;
                      OnAction=VAR
                                 PurchaseOrderList@1000 : Page 9307;
                               BEGIN
                                 PurchaseOrderList.FilterINTP(Rec);
                                 PurchaseOrderList.RUN;
                               END;
                                }
      { 92      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 91      ;1   ;ActionGroup;
                      ActionContainerType=Reports }
      { 90      ;2   ;Action    ;
                      Name=Print;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Print;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 PrintDocument;
                               END;
                                }
      { 103     ;1   ;ActionGroup;
                      CaptionML=ENU=Approval }
      { 102     ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=ENU=Approve;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 101     ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=ENU=Reject;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 100     ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=ENU=Delegate;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 99      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=ENU=Comments;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 98      ;1   ;ActionGroup;
                      CaptionML=ENU=Release;
                      Image=ReleaseDoc }
      { 97      ;2   ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=ENU=Re&lease;
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000 : Codeunit 414;
                               BEGIN
                                 PerformManualRelease(Rec);
                               END;
                                }
      { 96      ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=ENU=Re&open;
                      Promoted=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1001 : Codeunit 414;
                               BEGIN
                                 PerformManualReOpen(Rec);
                               END;
                                }
      { 95      ;1   ;ActionGroup;
                      CaptionML=ENU=Request Approval;
                      Image=SendApprovalRequest }
      { 94      ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=ENU=Send A&pproval Request;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category9;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckNTPApprovalsWorkflowEnabled(Rec) THEN
                                   ApprovalsMgmt.OnSendNTPForApproval(Rec);
                               END;
                                }
      { 93      ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=ENU=Cancel Approval Re&quest;
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExist;
                      Image=Cancel;
                      PromotedCategory=Category9;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelNTPApprovalRequest(Rec);
                               END;
                                }
      { 159     ;1   ;ActionGroup;
                      CaptionML=ENU=Documents }
      { 190     ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=ENU=Incoming Document;
                      Image=Documents }
      { 222     ;3   ;Action    ;
                      Name=ViewIncomingDoc;
                      AccessByPermission=TableData 50040=M;
                      CaptionML=ENU=View Incoming Document;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNoUsingMyDocs("Incoming Document Entry No.");
                               END;
                                }
      { 223     ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 50040=M;
                      CaptionML=ENU=Select Incoming Document;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocumentFromMyDocuments("Incoming Document Entry No."));
                               END;
                                }
      { 224     ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      AccessByPermission=TableData 50040=M;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Incoming Document From File;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromCustomDocument("Incoming Document Entry No.", DATABASE::"Internal Notice to Proceed", "No.");
                               END;
                                }
      { 225     ;3   ;Action    ;
                      Name=RemoveIncomingDoc;
                      AccessByPermission=TableData 50040=M;
                      CaptionML=ENU=Remove Incoming Document;
                      Enabled=HasIncomingDocument;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 "Incoming Document Entry No." := 0;
                               END;
                                }
      { 226     ;2   ;ActionGroup;
                      Name=ConfidentialDoc;
                      CaptionML=ENU=Confidential Document;
                      Image=Lock }
      { 154     ;3   ;Action    ;
                      Name=Documents;
                      CaptionML=ENU=Document List;
                      Image=List;
                      OnAction=VAR
                                 IncomingDocuments@1000 : Page 190;
                               BEGIN
                                 IncomingDocuments.FilterByINTP("No.");
                                 IncomingDocuments.RUN;
                               END;
                                }
      { 38      ;3   ;Action    ;
                      Name=AttachFile;
                      CaptionML=ENU=Attach File;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocument@1001 : Record 130;
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IF IncomingDocumentAttachment.Import THEN BEGIN
                                   IncomingDocument.GET(IncomingDocumentAttachment."Incoming Document Entry No.");
                                   IncomingDocument.VALIDATE("INTP No.",Rec."No.");
                                   IncomingDocument.MODIFY(TRUE);
                                   PAGE.RUN(PAGE::"Incoming Document",IncomingDocument);
                                 END;
                               END;
                                }
      { 118     ;1   ;ActionGroup;
                      CaptionML=ENU=Jobs;
                      ActionContainerType=NewDocumentItems }
      { 110     ;2   ;Action    ;
                      Name=Jobs;
                      CaptionML=ENU=Jobs;
                      Description=View Job;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Job;
                      PromotedCategory=Category8;
                      RunPageMode=View;
                      OnAction=VAR
                                 JobsList@1000 : Page 89;
                               BEGIN
                                 JobsList.FilterINTP(Rec);
                                 JobsList.RUN;
                               END;
                                }
      { 54      ;2   ;Action    ;
                      Name=Job Task Line;
                      RunObject=Page 1002;
                      RunPageLink=Job No.=FIELD(Job No.);
                      Promoted=Yes;
                      Visible=False;
                      PromotedIsBig=Yes;
                      Image=TaskList;
                      PromotedCategory=Category8 }
      { 111     ;2   ;Action    ;
                      Name=Sales Details;
                      RunObject=Page 5200;
                      RunPageLink=No.=FIELD(Salesperson No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Employee;
                      PromotedCategory=Category8 }
      { 200     ;2   ;Action    ;
                      Name=Customer Details;
                      RunObject=Page 21;
                      RunPageLink=No.=FIELD(Customer No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Category8 }
      { 85      ;1   ;ActionGroup;
                      CaptionML=ENU=General }
      { 83      ;2   ;Action    ;
                      Name=Job Orders;
                      CaptionML=ENU=Job Orders;
                      Description=View Job;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=List;
                      PromotedCategory=Category10;
                      RunPageMode=View;
                      OnAction=VAR
                                 JobOrdersList@1000 : Page 50012;
                               BEGIN
                                 JobOrdersList.FilterINTP(Rec);
                                 JobOrdersList.RUN;
                               END;
                                }
      { 193     ;2   ;Action    ;
                      Name=Cash Advances;
                      Description=View Posted Cash Advances;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=List;
                      PromotedCategory=Category10;
                      RunPageMode=View;
                      OnAction=VAR
                                 CashAdvList@1000 : Page 50020;
                               BEGIN
                                 CashAdvList.FilterINTP(Rec);
                                 CashAdvList.RUN;
                               END;
                                }
      { 192     ;2   ;Action    ;
                      Name=Posted Cash Advances;
                      Description=View Posted Cash Advances;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=List;
                      PromotedCategory=Category10;
                      RunPageMode=View;
                      OnAction=VAR
                                 PostedCashAdvList@1000 : Page 50024;
                               BEGIN
                                 PostedCashAdvList.FilterINTP(Rec);
                                 PostedCashAdvList.RUN;
                               END;
                                }
      { 203     ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=ENU=Dimensions;
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(50040),
                                  No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category10 }
      { 219     ;1   ;ActionGroup;
                      CaptionML=ENU=Create Request }
      { 220     ;2   ;Action    ;
                      Name=RequestToReopen;
                      CaptionML=ENU=Request to Reopen;
                      Image=Open;
                      OnAction=VAR
                                 Ticket@1003 : Record 50562;
                                 PageRequestToReopen@1000 : Page 50659;
                                 FieldErrorTxt@1001 : TextConst 'ENU=Reason for reopening must have a value.';
                                 Decision@1002 : Boolean;
                               BEGIN
                                 { Note: Need to Update the below code for the new table
                                 Ticket.ReopenDocument
                                 }
                                 IF "Approval Status" = "Approval Status"::Open THEN
                                   EXIT;

                                 OnCheckINTPReleaseRestriction;
                                 REPEAT
                                   CLEAR(PageRequestToReopen);
                                   Decision := PageRequestToReopen.RUNMODAL = ACTION::Yes;
                                   IF Decision AND (PageRequestToReopen.GetReasonForReopening = '') THEN
                                     Decision := TRUE
                                   ELSE
                                     Decision := FALSE;
                                 UNTIL Decision = FALSE;

                                 IF PageRequestToReopen.GetReasonForReopening = '' THEN
                                   EXIT;

                                 Ticket.CreateTicketForReopeningOfDocument(Rec, PageRequestToReopen.GetReasonForReopening);
                                 COMMIT;
                               END;
                                }
      { 218     ;1   ;ActionGroup;
                      CaptionML=ENU=Notification }
      { 221     ;2   ;Action    ;
                      Name=Sent Notification;
                      Image=MailSetup;
                      OnAction=VAR
                                 SentNotifiationEntry@1000 : Record 1514;
                                 ApprovalEntry@1001 : Record 454;
                                 RecIDFilter@1002 : Text;
                               BEGIN
                                 SentNotifiationEntry.SETRANGE("Triggered By Record", Rec.RECORDID);
                                 IF SentNotifiationEntry.FINDSET THEN
                                   REPEAT
                                     SentNotifiationEntry.MARK(TRUE);
                                   UNTIL SentNotifiationEntry.NEXT = 0;
                                 ApprovalEntry.SETRANGE("Record ID to Approve", Rec.RECORDID);
                                 IF ApprovalEntry.FINDSET THEN
                                   REPEAT
                                     SentNotifiationEntry.SETRANGE("Triggered By Record", ApprovalEntry.RECORDID);
                                     IF SentNotifiationEntry.FINDSET THEN
                                       REPEAT
                                         SentNotifiationEntry.MARK(TRUE);
                                       UNTIL SentNotifiationEntry.NEXT = 0;
                                   UNTIL ApprovalEntry.NEXT = 0;
                                 SentNotifiationEntry.SETRANGE("Triggered By Record");
                                 SentNotifiationEntry.MARKEDONLY(TRUE);
                                 PAGE.RUN(PAGE::"Sent Notification Entries", SentNotifiationEntry);
                               END;
                                }
      { 227     ;2   ;Action    ;
                      Name=Person to Notify;
                      RunObject=Page 50065;
                      RunPageLink=Table ID=CONST(50040),
                                  No.=FIELD(No.);
                      Image=PersonInCharge;
                      OnAction=VAR
                                 PersontoNotify@1000 : Record 50024;
                               BEGIN
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 89  ;0   ;Container ;
                ContainerType=ContentArea }

    { 106 ;1   ;Group     ;
                Name=General;
                GroupType=Group }

    { 86  ;2   ;Group     ;
                GroupType=Group }

    { 112 ;3   ;Field     ;
                SourceExpr="No.";
                Style=Strong;
                StyleExpr=TRUE;
                OnAssistEdit=BEGIN
                               IF AssistEdit THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 117 ;3   ;Field     ;
                ToolTipML=ENU=Issue a Notice to Mobilize if project is with Purchase Order from customer.;
                SourceExpr="Notice To Mobilize" }

    { 119 ;3   ;Field     ;
                SourceExpr="Clustering Mobilization" }

    { 121 ;3   ;Field     ;
                SourceExpr="Per Site Mobilization" }

    { 124 ;3   ;Field     ;
                ToolTipML=ENU=With Purchase Order from Client;
                SourceExpr="w/ P.O";
                Importance=Additional;
                Editable="Notice To Mobilize" }

    { 125 ;3   ;Field     ;
                ToolTipML=ENU=Purchase Order No. from Client;
                SourceExpr="P.O No. (Customer)";
                Editable="Notice To Mobilize";
                ShowMandatory=True }

    { 126 ;3   ;Field     ;
                ToolTipML=ENU=Purchase Order Date from Client;
                SourceExpr="P.O Date (Customer)";
                Editable="Notice To Mobilize";
                ShowMandatory=True }

    { 105 ;3   ;Field     ;
                SourceExpr="No of Sites" }

    { 113 ;3   ;Field     ;
                SourceExpr="Site Names";
                MultiLine=Yes }

    { 79  ;3   ;Field     ;
                SourceExpr="Job No." }

    { 62  ;3   ;Field     ;
                CaptionML=ENU=Customer No.;
                SourceExpr="Customer No.";
                ShowMandatory=TRUE }

    { 61  ;3   ;Field     ;
                SourceExpr="Customer Name" }

    { 104 ;3   ;Field     ;
                SourceExpr="Project Name";
                MultiLine=Yes;
                RowSpan=2;
                ShowMandatory=True }

    { 165 ;3   ;Field     ;
                SourceExpr="Project Name 2";
                Importance=Additional;
                MultiLine=Yes }

    { 84  ;2   ;Group     ;
                GroupType=Group }

    { 81  ;3   ;Field     ;
                SourceExpr="Document Date" }

    { 59  ;3   ;Field     ;
                SourceExpr="Vendor No.";
                Visible=false }

    { 58  ;3   ;Field     ;
                SourceExpr="Vendor Name";
                Visible=false }

    { 57  ;3   ;Field     ;
                ToolTipML=ENU=Purchase Order No. to Supplier;
                SourceExpr="P.O No. To Supplier";
                Visible=false }

    { 116 ;3   ;Field     ;
                ToolTipML=ENU="Issue a Notice to Proceed if project is without Purchase Order from customer. ";
                SourceExpr="Notice To Proceed" }

    { 120 ;3   ;Field     ;
                SourceExpr="Supply Only";
                ShowMandatory=TRUE }

    { 202 ;3   ;Field     ;
                SourceExpr="Project Category Code" }

    { 122 ;3   ;Field     ;
                ToolTipML=ENU=Demo POC (Proof of Concept);
                SourceExpr="Demo POC" }

    { 60  ;3   ;Field     ;
                ToolTipML=ENU=Without Purchase Order from Client;
                SourceExpr="w/o P.O";
                Importance=Additional;
                Editable="Notice To Proceed" }

    { 123 ;3   ;Field     ;
                ToolTipML=ENU=Release Date of Purchase Order;
                SourceExpr="Release Date of P.O";
                Editable="Notice To Proceed" }

    { 127 ;3   ;Field     ;
                SourceExpr="Sales Engineer No.";
                OnValidate=VAR
                             DimVal@1000 : Record 349;
                             TempDimSetEntry@1001 : TEMPORARY Record 480;
                             DimRecSetEntry@1007 : Record 480;
                             DimMgt@1002 : Codeunit 408;
                             DefaultDimensionLocal@1003 : Record 352;
                             ResourceLocal@1004 : Record 156;
                             OldDimSetID@1005 : Integer;
                             NewDimSetID@1008 : Integer;
                             PreSalesCodeLocal@1006 : Code[20];
                           BEGIN
                             //start
                             //OldDimSetID := Rec."Dimension Set ID";
                             //TempDimSetEntry.RESET;
                             //DimMgt.GetDimensionSet(TempDimSetEntry, OldDimSetID);
                             //
                             //PreSalesCodeLocal := 'PRE-SALES';
                             //TempDimSetEntry.SETRANGE("Dimension Code", PreSalesCodeLocal);
                             ////MESSAGE(FORMAT(DimRecSetEntry.FINDFIRST));
                             //IF NOT DimRecSetEntry.FINDFIRST THEN BEGIN
                             //  IF DefaultDimensionLocal.GET(156, "Sales Engineer No.", PreSalesCodeLocal) THEN BEGIN
                             //      DimVal.GET(PreSalesCodeLocal, DefaultDimensionLocal."Dimension Value Code");
                             //      TempDimSetEntry.INIT;
                             //      TempDimSetEntry.VALIDATE("Dimension Set ID", OldDimSetID);//"Dimension Set ID" := OldDimSetID;
                             //      TempDimSetEntry.VALIDATE("Dimension Code", PreSalesCodeLocal);
                             //      TempDimSetEntry.VALIDATE("Dimension Value Code", DefaultDimensionLocal."Dimension Value Code");
                             //      TempDimSetEntry.VALIDATE("Dimension Value ID", DimVal."Dimension Value ID");//"Dimension Value ID" := DimVal."Dimension Value ID";
                             //      TempDimSetEntry.INSERT;
                             //  END;
                             //END;
                             //
                             //NewDimSetID := DimMgt.GetDimensionSetID(TempDimSetEntry);
                             //MESSAGE(FORMAT(NewDimSetID <> OldDimSetID));
                             //IF NewDimSetID <> OldDimSetID THEN BEGIN
                             //  Rec."Dimension Set ID" := NewDimSetID;
                             //  Rec.MODIFY;
                             //END;

                               /////////////////////////////////////////////////////////
                              ////////////////////working /////////////////////////////
                             /////////////////////////////////////////////////////////
                             //PreSalesCodeLocal := 'PRE-SALES';
                             //IF DefaultDimensionLocal.GET(156, "Sales Engineer No.", PreSalesCodeLocal) THEN BEGIN
                             //    DimVal.GET(PreSalesCodeLocal, DefaultDimensionLocal."Dimension Value Code");
                             //    TempDimSetEntry.INIT;
                             //    TempDimSetEntry.VALIDATE("Dimension Code", PreSalesCodeLocal);
                             //    TempDimSetEntry.VALIDATE("Dimension Value Code", DefaultDimensionLocal."Dimension Value Code");
                             //    TempDimSetEntry."Dimension Value ID" := DimVal."Dimension Value ID";
                             //    TempDimSetEntry.INSERT;
                             //    Rec."Dimension Set ID" := DimMgt.GetDimensionSetID(TempDimSetEntry);
                             //    Rec.MODIFY;
                             //END;
                           END;

                ShowMandatory=True }

    { 158 ;3   ;Field     ;
                Lookup=Yes;
                SourceExpr="Sales Engineer";
                Importance=Additional;
                DrillDownPageID=Page0 }

    { 128 ;3   ;Field     ;
                SourceExpr="Project Manager No." }

    { 160 ;3   ;Field     ;
                Lookup=Yes;
                SourceExpr="Project Manager";
                Importance=Additional;
                DrillDownPageID=Page0 }

    { 115 ;3   ;Field     ;
                SourceExpr="Salesperson No.";
                ShowMandatory=True }

    { 161 ;3   ;Field     ;
                Lookup=Yes;
                SourceExpr=Salesperson;
                Importance=Additional;
                DrillDownPageID=Page0 }

    { 167 ;3   ;Field     ;
                ToolTipML=ENU=Cost Analyst in-charge;
                SourceExpr="Cost Analyst No.";
                ShowMandatory=True }

    { 168 ;3   ;Field     ;
                Lookup=Yes;
                SourceExpr="Cost Analyst";
                Importance=Additional;
                LookupPageID=Page0 }

    { 53  ;3   ;Field     ;
                SourceExpr="Complete Equip. Date" }

    { 52  ;3   ;Field     ;
                SourceExpr="Proj. Target Complete Date";
                ShowMandatory=True }

    { 164 ;3   ;Field     ;
                SourceExpr="xrec. Delivery To Client Whse.";
                Visible=FALSE }

    { 51  ;3   ;Field     ;
                SourceExpr="Dlvr.-Cust. Whse.";
                ShowMandatory=TRUE }

    { 163 ;3   ;Field     ;
                SourceExpr="Date of Dlvr.-Cust. Whse.";
                ShowMandatory=("Dlvr.-Cust. Whse." = "Dlvr.-Cust. Whse."::Yes) }

    { 207 ;3   ;Field     ;
                Name=Comments;
                SourceExpr=CommentTxt;
                Editable=False;
                OnAssistEdit=VAR
                               CustomLongText@1001 : Page 50061;
                               CaptionValue@1000 : Text;
                             BEGIN
                               CaptionValue := Rec.FIELDCAPTION(Comments);
                               CustomLongText.SetCaption(CaptionValue);
                               CustomLongText.SetText(CommentTxt); // Pass the Terms and Condition from Rec

                               IF CustomLongText.RUNMODAL = ACTION::Cancel THEN
                                 EXIT;

                               TESTFIELD("Approval Status", "Approval Status"::Open);
                               Comments.CREATEOUTSTREAM(OutStr);
                               CommentTxt := CustomLongText.GetText;
                               OutStr.WRITE(CommentTxt);
                               MODIFY(TRUE);
                             END;
                              }

    { 88  ;3   ;Field     ;
                SourceExpr="Job Order No.";
                Visible=False }

    { 87  ;3   ;Field     ;
                ToolTipML=ENU=Service Report No.;
                SourceExpr="SR No.";
                Visible=False }

    { 80  ;3   ;Field     ;
                SourceExpr="Document Time";
                Visible=false }

    { 49  ;3   ;Field     ;
                SourceExpr="Created At";
                Importance=Additional }

    { 129 ;3   ;Field     ;
                SourceExpr="Modified At";
                Importance=Additional }

    { 9   ;3   ;Field     ;
                SourceExpr="Related INTP No." }

    { 32  ;3   ;Field     ;
                SourceExpr="RFQ No." }

    { 155 ;3   ;Field     ;
                ToolTipML=ENU=Indicate if the transaction requires customer deposit;
                SourceExpr="Advance Deposit" }

    { 213 ;3   ;Field     ;
                SourceExpr=Status;
                Visible=FALSE }

    { 56  ;3   ;Field     ;
                SourceExpr="Approval Status" }

    { 64  ;1   ;Group     ;
                CaptionML=ENU=Customer & Project Details;
                Visible=False;
                GroupType=Group }

    { 77  ;1   ;Group     ;
                CaptionML=ENU=Concerned Personnel;
                GroupType=Group }

    { 209 ;2   ;Field     ;
                SourceExpr="HRD-00 Dept." }

    { 72  ;2   ;Field     ;
                SourceExpr="ACC-00 Dept." }

    { 70  ;2   ;Field     ;
                SourceExpr="AUD-00 Dept." }

    { 73  ;2   ;Field     ;
                SourceExpr="INV-00 Dept." }

    { 75  ;2   ;Field     ;
                SourceExpr="LOG-00 Dept." }

    { 14  ;2   ;Field     ;
                SourceExpr="OSP-00 Dept." }

    { 13  ;2   ;Field     ;
                SourceExpr="PMD-00 Dept." }

    { 67  ;2   ;Field     ;
                SourceExpr="PUR-00 Dept." }

    { 71  ;2   ;Field     ;
                SourceExpr="QAU-00 Dept." }

    { 66  ;2   ;Field     ;
                ToolTipML=ENU=Sales Account Manager (SAM/Head);
                SourceExpr="SAL-00 Dept." }

    { 69  ;2   ;Field     ;
                SourceExpr="PMO-00 Dept." }

    { 1   ;2   ;Field     ;
                SourceExpr="TAU-00 Dept." }

    { 74  ;2   ;Field     ;
                SourceExpr="WMU-00 Dept." }

    { 191 ;2   ;Field     ;
                SourceExpr="RMS-DT Dept." }

    { 76  ;2   ;Group     ;
                CaptionML=ENU=Finance;
                GroupType=Group }

    { 68  ;3   ;Field     ;
                SourceExpr="FIN-AP Dept." }

    { 65  ;3   ;Field     ;
                SourceExpr="FIN-AR Dept." }

    { 2   ;2   ;Group     ;
                CaptionML=ENU=Technical;
                GroupType=Group }

    { 7   ;3   ;Field     ;
                SourceExpr="CPE-00 Dept." }

    { 6   ;3   ;Field     ;
                CaptionML=ENU=Information Communication System;
                SourceExpr="ICT-00 Dept." }

    { 3   ;3   ;Field     ;
                SourceExpr="POW-00 Dept." }

    { 4   ;3   ;Field     ;
                SourceExpr="TRM-WRD Dept." }

    { 5   ;3   ;Field     ;
                SourceExpr="TRM-WRL Dept." }

    { 55  ;3   ;Field     ;
                SourceExpr="WRL-A1 Dept." }

    { 63  ;3   ;Field     ;
                SourceExpr="WRL-A2 Dept." }

    { 78  ;3   ;Field     ;
                SourceExpr="SCU-01 Dept." }

    { 50  ;1   ;Group     ;
                CaptionML=ENU=Engineering Activities;
                GroupType=Group }

    { 48  ;2   ;Field     ;
                SourceExpr="Site Acquisition" }

    { 33  ;2   ;Group     ;
                CaptionML=ENU=Site Survey Activity;
                GroupType=Group }

    { 47  ;3   ;Field     ;
                SourceExpr="Site Survey" }

    { 130 ;3   ;Field     ;
                ToolTipML=ENU=Approved Memorandum of Agreement/Memorandum of Understanding;
                SourceExpr="Approved MOA/MOU";
                Enabled="Site Survey" }

    { 131 ;3   ;Field     ;
                ToolTipML=ENU=Approved Restricted Area Access Work Authorization/Work Permit;
                SourceExpr="Approved RAAWA/Work Permit";
                Enabled="Site Survey" }

    { 132 ;3   ;Field     ;
                SourceExpr="Floor Plans from Customer";
                Enabled="Site Survey" }

    { 133 ;3   ;Field     ;
                SourceExpr="Ctctd. Strctrd. Cblng Subcon";
                Enabled="Site Survey" }

    { 34  ;2   ;Group     ;
                CaptionML=ENU=Installation Activity;
                GroupType=Group }

    { 46  ;3   ;Field     ;
                SourceExpr=Installation }

    { 134 ;3   ;Field     ;
                ToolTipML=ENU=Approved Bill of Quantity;
                SourceExpr="Approved BOQ";
                Enabled=Installation }

    { 135 ;3   ;Field     ;
                ToolTipML=ENU=Approved High Level Design and Technical Site Survey Report Design;
                SourceExpr="Approved HLD and TSSR Design";
                Enabled=Installation }

    { 136 ;3   ;Field     ;
                ToolTipML=ENU=Approved Work Permit/Restricted Area Access Work Authorization;
                SourceExpr="Approved Work Permit/RAAWA";
                Enabled=Installation }

    { 137 ;3   ;Field     ;
                SourceExpr="Signed Notice to Install";
                Enabled=Installation }

    { 138 ;2   ;Field     ;
                SourceExpr=Troubleshooting }

    { 36  ;2   ;Field     ;
                SourceExpr=Maintenance }

    { 37  ;2   ;Field     ;
                ToolTipML=ENU=Quality Audit/Trial/Proof of Concept;
                SourceExpr="Quality Audit/Trial/POC" }

    { 31  ;2   ;Field     ;
                SourceExpr="Building Clearance" }

    { 45  ;2   ;Field     ;
                SourceExpr=Commissioning }

    { 28  ;2   ;Field     ;
                ToolTipML=ENU=Delivery to Customers Warehouse;
                SourceExpr="Delivery To Customers Whse." }

    { 42  ;2   ;Field     ;
                SourceExpr="Final Acceptance" }

    { 43  ;2   ;Field     ;
                SourceExpr="Preliminary Acceptance" }

    { 44  ;2   ;Field     ;
                SourceExpr=Testing }

    { 41  ;2   ;Field     ;
                SourceExpr=Rectification }

    { 30  ;2   ;Field     ;
                SourceExpr="Shipment (Air Freight)" }

    { 29  ;2   ;Field     ;
                SourceExpr="Shipment (Sea Freight)" }

    { 27  ;2   ;Field     ;
                SourceExpr="Q. Others Please Specify" }

    { 26  ;2   ;Field     ;
                SourceExpr="Q. Others Remarks";
                Editable="Q. Others Please Specify" }

    { 25  ;1   ;Group     ;
                CaptionML=ENU=Attachments;
                GroupType=Group }

    { 24  ;2   ;Field     ;
                SourceExpr="A. Notice To Proceed" }

    { 23  ;2   ;Field     ;
                SourceExpr="ATP/CTF" }

    { 22  ;2   ;Field     ;
                SourceExpr="A. Signed Trial" }

    { 21  ;2   ;Field     ;
                ToolTipML=ENU=Purchase Order from Client;
                SourceExpr="A. P.O. From Client" }

    { 20  ;2   ;Field     ;
                ToolTipML=ENU=Purchase Order to Supplier;
                SourceExpr="A. P.O. To Supplier" }

    { 35  ;2   ;Field     ;
                SourceExpr="Exception Report" }

    { 156 ;2   ;Field     ;
                Name=Exception No. (RFE#);
                ToolTipML=ENU=Request for Exception No.;
                SourceExpr="Exception Report No.";
                Editable="Exception Report" }

    { 19  ;2   ;Field     ;
                SourceExpr="A. Bill Of Materials";
                Visible=False }

    { 18  ;2   ;Field     ;
                SourceExpr="A. Allocated Budget";
                Visible=False }

    { 17  ;2   ;Field     ;
                SourceExpr="A. Others Please Specify" }

    { 16  ;2   ;Field     ;
                SourceExpr="A. Others Remarks";
                Editable="A. Others Please Specify" }

    { 15  ;1   ;Group     ;
                CaptionML=ENU=Warranty;
                GroupType=Group }

    { 12  ;2   ;Field     ;
                SourceExpr="Within Warranty" }

    { 11  ;2   ;Field     ;
                SourceExpr="With Maintenance Service" }

    { 10  ;2   ;Field     ;
                SourceExpr="Expired Warranty" }

    { 8   ;2   ;Field     ;
                SourceExpr=Remarks }

    { 140 ;1   ;Group     ;
                CaptionML=ENU=Signatories;
                Visible=False;
                GroupType=Group }

    { 141 ;2   ;Field     ;
                SourceExpr="Issued By No." }

    { 142 ;2   ;Field     ;
                SourceExpr="Audit Resp. No." }

    { 143 ;2   ;Field     ;
                SourceExpr="Finance Resp. No." }

    { 144 ;2   ;Field     ;
                SourceExpr="Accounting Resp. No." }

    { 145 ;2   ;Field     ;
                SourceExpr="Inventory Resp. No." }

    { 146 ;2   ;Field     ;
                SourceExpr="Warehouse Resp. No." }

    { 147 ;2   ;Field     ;
                SourceExpr="Reviewed Resp. No." }

    { 148 ;2   ;Field     ;
                SourceExpr="Legal Resp. No." }

    { 149 ;2   ;Field     ;
                SourceExpr="Technical In-charge No." }

    { 150 ;2   ;Field     ;
                SourceExpr="CEO Resp. No." }

    { 204 ;1   ;Group     ;
                CaptionML=ENU=Invoicing;
                Visible=False;
                GroupType=Group }

    { 211 ;2   ;Field     ;
                SourceExpr="Currency Code" }

    { 205 ;2   ;Field     ;
                SourceExpr="Prices Including VAT" }

    { 206 ;2   ;Field     ;
                SourceExpr=Amount }

    { 212 ;2   ;Field     ;
                SourceExpr="Total Amt. Invoice" }

    { 151 ;1   ;Group     ;
                CaptionML=ENU=Dimensions;
                Visible=False;
                GroupType=Group }

    { 152 ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code" }

    { 153 ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code" }

    { 215 ;1   ;Group     ;
                CaptionML=ENU=Job Setup;
                GroupType=Group }

    { 216 ;2   ;Field     ;
                SourceExpr="Require Job in Purch. Docs.";
                Visible=FALSE }

    { 82  ;1   ;Part      ;
                Name=ApprovalEntry;
                CaptionML=ENU=Approver;
                SubPageView=SORTING(Entry No.)
                            ORDER(Descending);
                SubPageLink=Document No.=FIELD(No.),
                            Table ID=CONST(50040);
                PagePartID=Page50088;
                Editable=False;
                PartType=Page;
                ShowFilter=No }

    { 107 ;    ;Container ;
                ContainerType=FactBoxArea }

    { 208 ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                PagePartID=Page193;
                Visible=false;
                PartType=Page;
                ShowFilter=No }

    { 166 ;1   ;Part      ;
                CaptionML=ENU=Person to Notify;
                SubPageLink=Table ID=CONST(50040),
                            No.=FIELD(No.);
                PagePartID=Page50204;
                PartType=Page }

    { 214 ;1   ;Part      ;
                Name=Default Dimension;
                CaptionML=ENU=Default Dimension;
                SubPageLink=Table ID=CONST(50040),
                            No.=FIELD(No.);
                PagePartID=Page50624;
                PartType=Page }

    { 108 ;1   ;Part      ;
                PartType=System;
                SystemPartID=Notes }

    { 109 ;1   ;Part      ;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {
    VAR
      NoticeToProceed@1003 : Record 50040;
      TotalPurchaseLine@1008 : Record 39;
      ReleaseMgmt@1000 : Codeunit 50551;
      Text1@1017 : Text;
      ProjectName@1012 : Text[50];
      Text3@1011 : Text;
      Text4@1010 : Text;
      Text5@1009 : Text;
      CommentTxt@1007 : Text;
      BlankTxt@1004 : ARRAY [1000000] OF Text;
      ShortcutDimCode@1018 : ARRAY [8] OF Code[20];
      DocNoVisible@1014 : Boolean;
      HasIncomingDocument@1013 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1002 : Boolean;
      OpenApprovalEntriesExist@1001 : Boolean;
      EnableReleaseBtn@1015 : Boolean;
      EnableCancelBtn@1016 : Boolean;
      InStr@1005 : InStream;
      OutStr@1006 : OutStream;

    LOCAL PROCEDURE SetControlVisibility@7();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      EnableCancelBtn := (("Approval Status" = "Approval Status"::Open) OR ("Approval Status" = "Approval Status"::Released));
      EnableReleaseBtn := ("Approval Status" = "Approval Status"::Open);
      HasIncomingDocument := "Incoming Document Entry No." <> 0;
    END;

    LOCAL PROCEDURE ValidateSaveShortcutDimCode@19(FieldNumber@1001 : Integer;VAR ShortcutDimCode@1000 : Code[20]);
    BEGIN
      //ValidateShortcutDimCode(FieldNumber,ShortcutDimCode);
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE SetDocNoVisible@1();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
    BEGIN
      DocNoVisible := DocumentNoVisibility.INTPDocumentNoIsVisible("No.");
    END;

    BEGIN
    END.
  }
}

