OBJECT Table 50010 RTPS Document
{
  OBJECT-PROPERTIES
  {
    Date=02/21/24;
    Time=[ 9:46:00 PM];
    Modified=Yes;
    Version List=X8OC0.01,NAVOC1.00.03,NAVOC1.00.02;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Customer Name,Timeline;
    OnInsert=BEGIN
               InitInsert;

               IF GetFilterContNo <> '' THEN BEGIN
                 VALIDATE("Contact No.", GetFilterContNo);
                 IF GETFILTER("Opportunity No.") <> '' THEN
                   IF GETRANGEMIN("Opportunity No.") = GETRANGEMAX("Opportunity No.") THEN
                     VALIDATE("Opportunity No.",GETRANGEMIN("Opportunity No."));
               END;
             END;

    OnModify=BEGIN
               IF Status <> Status::Completed THEN BEGIN
                 CLEAR("Completed By");
                 CLEAR("Completed Date");
               END;

               IF Status <> Status::Cancelled THEN BEGIN
                 CLEAR("Cancelled By");
                 CLEAR("Cancelled Date");
               END;
               "Modified By User ID" := USERID;
             END;

    OnDelete=BEGIN
               TESTFIELD(Status, Status::Open);
             END;

    CaptionML=ENU=Request for Technical/Product Support;
    LookupPageID=Page50011;
  }
  FIELDS
  {
    { 10  ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 16  ;   ;Project Description ;Text250       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 17  ;   ;Employee No.        ;Code20        ;TableRelation=Employee;
                                                   OnValidate=BEGIN
                                                                TestRTPSAdmin;

                                                                IF "Employee No." <> '' THEN
                                                                  Emp.GET("Employee No.")
                                                                ELSE BEGIN
                                                                  CLEAR(Emp);
                                                                END;
                                                                "Employee Name" := Emp."First Name"+' '+Emp."Last Name";
                                                              END;
                                                               }
    { 18  ;   ;Employee Name       ;Text50        ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 19  ;   ;Project Description 2;Text250       }
    { 20  ;   ;Customer No.        ;Code20        ;TableRelation=Customer WHERE (Customer Type=CONST(Customer));
                                                   OnValidate=VAR
                                                                RecordRestrictionMgt@1000 : Codeunit 1550;
                                                              BEGIN
                                                                TestRTPSAdmin;
                                                                IF "Opportunity No." <> '' THEN
                                                                  ERROR(Text062, FIELDCAPTION("Customer No."), FIELDCAPTION("Opportunity No."), "Opportunity No.");

                                                                 IF "Customer No." = '' THEN BEGIN
                                                                   INIT;
                                                                   "No. Series" := xRec."No. Series";
                                                                   InitRecord;
                                                                  EXIT;
                                                                 END;

                                                                GetCust("Customer No.");
                                                                Cust.CheckBlockedCustOnDocs(Cust,1,FALSE,FALSE);
                                                                RecordRestrictionMgt.CheckRecordHasUsageRestrictions(Cust.RECORDID);
                                                                Cust.TESTFIELD("Gen. Bus. Posting Group");
                                                                Cust.TESTFIELD("Customer Posting Group");
                                                                Cust.TESTFIELD("VAT Bus. Posting Group");
                                                                "Customer Name" := Cust.Name;
                                                                IF NOT SkipSellToContact THEN
                                                                  UpdateBillToCont("Customer No.");

                                                              END;
                                                               }
    { 30  ;   ;Customer Name       ;Text50        ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 40  ;   ;Date Requested      ;Date          ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 50  ;   ;Contact No.         ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1004 : Record 5054;
                                                                Opportunity@1002 : Record 5092;
                                                                Cont@1000 : Record 5050;
                                                                Customer@1001 : Record 18;
                                                              BEGIN
                                                                TestRTPSAdmin;

                                                                IF ("Contact No." <> xRec."Contact No.") AND
                                                                   (xRec."Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF ("Contact No." = '') AND ("Opportunity No." <> '') THEN
                                                                    ERROR(Text049,FIELDCAPTION("Contact No."));
                                                                  IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text005,FALSE,FIELDCAPTION("Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    IF "Opportunity No." <> '' THEN BEGIN
                                                                      Opportunity.GET("Opportunity No.");
                                                                      IF Opportunity."Contact No." <> "Contact No." THEN BEGIN
                                                                        MODIFY;
                                                                        Opportunity.VALIDATE("Contact No.","Contact No.");
                                                                        Opportunity.MODIFY;
                                                                      END
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Customer No." <> '') AND ("Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Contact No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    IF ContBusinessRelation."Contact No." <> Cont."Company No." THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Customer No.");
                                                                END;

                                                                UpdateCustomer("Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Customer No." <> '' THEN
                                                                IF Cont.GET("Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Contact No." <> '' THEN
                                                                IF Cont.GET("Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Contact No.",Cont."No.");
                                                              END;
                                                            END;
                                                             }
    { 51  ;   ;Contact Name        ;Text100       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 60  ;   ;Site Survey         ;Boolean       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                SetScopeDeliverables;

                                                                IF "Site Survey" = FALSE THEN BEGIN
                                                                  "SS Schedule" := '';
                                                                  "SS Area" := '';
                                                                  "SSS Expected Date From" := 0D;
                                                                  "SSS Expected Date To" := 0D;
                                                                  "SSS Actual Date From" := 0D;
                                                                  "SSS Actual Date To" := 0D;
                                                                END
                                                                ELSE BEGIN
                                                                  "SSS Expected Date From" := TODAY;
                                                                  "SSS Expected Date To" := TODAY;
                                                                END;
                                                              END;

                                                   Description=SS }
    { 61  ;   ;SS Schedule         ;Text100       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                TESTFIELD("Site Survey",TRUE);
                                                              END;

                                                   CaptionML=ENU=Site Survey Schedule;
                                                   Description=SSS }
    { 62  ;   ;SS Area             ;Text100       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                TESTFIELD("Site Survey",TRUE);
                                                              END;

                                                   CaptionML=ENU=Site Survey Area }
    { 63  ;   ;SSS Expected Date From;Date        ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                IF "SSS Expected Date From" > "SSS Expected Date To" THEN BEGIN
                                                                  "SSS Expected Date To" := "SSS Expected Date From";
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Expected Date From }
    { 64  ;   ;SSS Expected Date To;Date          ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                IF "SSS Expected Date To" > Timeline THEN
                                                                  IF CONFIRM(Text006, TRUE, FIELDCAPTION("SSS Expected Date To"), FIELDCAPTION(Timeline), Timeline) THEN
                                                                    Timeline := "SSS Expected Date To"
                                                                  ELSE
                                                                    ERROR('');
                                                                IF "SSS Expected Date To" < "SSS Expected Date From" THEN BEGIN
                                                                  "SSS Expected Date From" := "SSS Expected Date To";
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Expected Date To }
    { 65  ;   ;SSS Actual Date From;Date          ;OnValidate=BEGIN

                                                                IF "SSS Actual Date From" > "SSS Actual Date To" THEN BEGIN
                                                                  "SSS Actual Date To" := "SSS Actual Date From";
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Actual Date From }
    { 66  ;   ;SSS Actual Date To  ;Date          ;OnValidate=BEGIN

                                                                IF "SSS Actual Date To" < "SSS Actual Date From" THEN BEGIN
                                                                  "SSS Actual Date From" := "SSS Actual Date To";
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Actual Date To }
    { 70  ;   ;Demo Testing        ;Boolean       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                SetScopeDeliverables;
                                                                IF "Demo Testing" = FALSE THEN BEGIN
                                                                  "DT Equipment" :='';
                                                                  "DT Area" := '';
                                                                  "DTS Expected Date From" := 0D;
                                                                  "DTS Expected Date To" := 0D;
                                                                  "DTS Actual Date From" := 0D;
                                                                  "DTS Actual Date To" := 0D;
                                                                END ELSE BEGIN
                                                                  "DTS Expected Date From" := TODAY;
                                                                  "DTS Expected Date To" := TODAY;
                                                                END;
                                                              END;

                                                   Description=DT }
    { 71  ;   ;DT Equipment        ;Text100       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                TESTFIELD("Demo Testing",TRUE);
                                                              END;

                                                   CaptionML=ENU=Equipment }
    { 73  ;   ;DT Area             ;Text100       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                TESTFIELD("Demo Testing",TRUE);
                                                              END;

                                                   CaptionML=ENU=Area }
    { 74  ;   ;DTS Expected Date From;Date        ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                IF ("DTS Expected Date From" > "DTS Expected Date To") OR ("DTS Expected Date To" = 0D) THEN
                                                                    "DTS Expected Date To" := "DTS Expected Date From";
                                                              END;

                                                   CaptionML=ENU=Expected Date From }
    { 75  ;   ;DTS Expected Date To;Date          ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                IF "DTS Expected Date To" > Timeline THEN
                                                                  IF CONFIRM(Text006, TRUE, FIELDCAPTION("DTS Expected Date To"), FIELDCAPTION(Timeline), Timeline) THEN
                                                                    Timeline := "DTS Expected Date To"
                                                                  ELSE
                                                                    ERROR('');
                                                                IF ("DTS Expected Date To" < "DTS Expected Date From") OR ("DTS Expected Date From" = 0D)  THEN
                                                                    "DTS Expected Date From" := "DTS Expected Date To";
                                                              END;

                                                   CaptionML=ENU=Expected Date To }
    { 76  ;   ;DTS Actual Date From;Date          ;OnValidate=BEGIN

                                                                IF "DTS Actual Date From" > "DTS Actual Date To" THEN
                                                                    "DTS Actual Date To" := "DTS Actual Date From";
                                                                IF "DTS Actual Date From" = 0D THEN
                                                                  CLEAR("DTS Actual Date To");
                                                              END;

                                                   CaptionML=ENU=Actual Date From }
    { 77  ;   ;DTS Actual Date To  ;Date          ;OnValidate=BEGIN

                                                                IF ("DTS Actual Date To" < "DTS Actual Date From") OR ("DTS Actual Date From" = 0D) THEN
                                                                    "DTS Actual Date From" := "DTS Actual Date To";
                                                              END;

                                                   CaptionML=ENU=Actual Date To }
    { 80  ;   ;Bill of Materials   ;Boolean       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                SetScopeDeliverables;
                                                                IF "Bill of Materials" = FALSE THEN BEGIN
                                                                    CLEAR("Information of Project");
                                                                    CLEAR("Date of Submission to PM/AM");
                                                                    CLEAR(Design);
                                                                END ELSE BEGIN
                                                                  "Information of Project" := "Project Description";
                                                                  "Date of Submission to PM/AM" := CREATEDATETIME(Timeline, 180000T);
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Bill of Materials (BOM) }
    { 81  ;   ;Information of Project;Text250     ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                TESTFIELD("Bill of Materials",TRUE);
                                                              END;
                                                               }
    { 85  ;   ;Design              ;Boolean       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 90  ;   ;Date of Submission to PM/AM;DateTime;
                                                   OnValidate=VAR
                                                                TempDate@1000 : Date;
                                                              BEGIN
                                                                TestRTPSAdmin;
                                                                TESTFIELD("Bill of Materials",TRUE);
                                                                TempDate := DT2DATE("Date of Submission to PM/AM");

                                                                IF TempDate > Timeline THEN
                                                                  IF CONFIRM(Text006, TRUE, FIELDCAPTION("Date of Submission to PM/AM"), FIELDCAPTION(Timeline), Timeline) THEN
                                                                    Timeline := TempDate
                                                                  ELSE
                                                                    ERROR('');
                                                              END;

                                                   CaptionML=ENU=Date of Submission to PM/AM }
    { 100 ;   ;Target Audience     ;Boolean       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;

                                                   Description=PP }
    { 101 ;   ;PP Engineering      ;Boolean       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;

                                                   CaptionML=ENU=Engineering }
    { 102 ;   ;PP Business / Marketing;Boolean    ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;

                                                   CaptionML=ENU=Business/Marketing }
    { 103 ;   ;PP Others           ;Boolean       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                IF "PP Others" = FALSE THEN
                                                                  "PP Others Remarks" := '';
                                                              END;

                                                   CaptionML=ENU=Others }
    { 104 ;   ;PP Others Remarks   ;Text200       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;

                                                   CaptionML=ENU=Others }
    { 105 ;   ;Date Of Presentation;Date          ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                IF "Date Of Presentation" > Timeline THEN
                                                                  IF CONFIRM(Text006, TRUE, FIELDCAPTION("Date Of Presentation"), FIELDCAPTION(Timeline), Timeline) THEN
                                                                    Timeline := "Date Of Presentation"
                                                                  ELSE
                                                                    ERROR('');
                                                              END;
                                                               }
    { 106 ;   ;Product Presentation;Boolean       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                SetScopeDeliverables;
                                                                 IF NOT "Product Presentation" THEN BEGIN
                                                                    "Date Of Presentation" := 0D;
                                                                    "PP Engineering" := FALSE;
                                                                    "PP Business / Marketing" := FALSE;
                                                                    "PP Others" := FALSE;
                                                                    CLEAR("PP Others Remarks");
                                                                 END ELSE BEGIN
                                                                  "Date Of Presentation" := TODAY;
                                                                 END;
                                                              END;
                                                               }
    { 110 ;   ;Appropriate Solution Tech;Boolean  ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;

                                                   CaptionML=ENU=Appropriate Solution/Tech. }
    { 120 ;   ;Recomended Solution / Equip.;Boolean;
                                                   OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                IF "Recomended Solution / Equip." = FALSE THEN
                                                                  "Recom. Sol/Equip Remarks" := '';
                                                              END;

                                                   CaptionML=ENU=Recommended Solution/Equipment }
    { 121 ;   ;Recom. Sol/Equip Remarks;Text100   ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                TESTFIELD("Recomended Solution / Equip.",TRUE);
                                                              END;

                                                   CaptionML=ENU=Recommended Solution/Equipment }
    { 130 ;   ;Stipulated Deadline ;Boolean       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                IF "Stipulated Deadline" = FALSE THEN
                                                                  "Stipulated Deadline Remarks" :='';
                                                              END;
                                                               }
    { 131 ;   ;Stipulated Deadline Remarks;Text200;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                TESTFIELD("Stipulated Deadline",TRUE);
                                                              END;
                                                               }
    { 135 ;   ;Others Last         ;Boolean       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                IF "Others Last" = FALSE THEN
                                                                  Remarks := '';
                                                              END;

                                                   CaptionML=ENU=Others }
    { 140 ;   ;Remarks             ;Text200       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                TESTFIELD("Others Last",TRUE);
                                                              END;
                                                               }
    { 150 ;   ;Timeline            ;Date          ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                TESTFIELD(Timeline);
                                                              END;
                                                               }
    { 160 ;   ;Scope/Deliverables  ;Text250       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 170 ;   ;Receiving Department;Text50        ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;

                                                   Editable=No }
    { 180 ;   ;Personnel 1         ;Code10        ;TableRelation=Employee;
                                                   OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 181 ;   ;Personnel 2         ;Code10        ;TableRelation=Employee;
                                                   OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 182 ;   ;Personnel 3         ;Code10        ;TableRelation=Employee;
                                                   OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 183 ;   ;Personnel 4         ;Code10        ;TableRelation=Employee;
                                                   OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 184 ;   ;Personnel 5         ;Code10        ;TableRelation=Employee;
                                                   OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 185 ;   ;Personnel 6         ;Code10        ;TableRelation=Employee;
                                                   OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 190 ;   ;Date Request Received;Date         ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 200 ;   ;No. Series          ;Code20        ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 210 ;   ;Document Date       ;Date          ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 220 ;   ;Request Status      ;Option        ;OnValidate=BEGIN
                                                                IF "Request Status" = "Request Status"::"3" THEN BEGIN
                                                                  IF "Site Survey" = "Site Survey"::"1" THEN BEGIN
                                                                     TESTFIELD("SSS Actual Date From");
                                                                     TESTFIELD("SSS Actual Date To");
                                                                  END;
                                                                  IF "Demo Testing" = "Demo Testing"::"1" THEN BEGIN
                                                                   TESTFIELD("DTS Expected Date From");
                                                                   TESTFIELD("DTS Expected Date To");
                                                                   TESTFIELD("DTS Actual Date From");
                                                                   TESTFIELD("DTS Actual Date To");
                                                                   TESTFIELD("DT Equipment");
                                                                   TESTFIELD("DT Area");
                                                                  END;
                                                                END;
                                                              END;

                                                   OptionCaptionML=ENU=" ,Cancelled,Done";
                                                   OptionString=[ ,Cancelled,Done];
                                                   Editable=No }
    { 300 ;   ;Service Engineering ;Boolean       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;

                                                                SetScopeDeliverables;
                                                              END;

                                                   CaptionML=ENU=Service Engineering (SE) }
    { 400 ;   ;Others              ;Boolean       ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 600 ;   ;Status              ;Option        ;OptionCaptionML=ENU=Open,Pending Approval,Released,Cancelled,Closed,Completed;
                                                   OptionString=Open,Pending Approval,Released,Cancelled,Closed,Completed;
                                                   Editable=No }
    { 601 ;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   OnValidate=BEGIN
                                                                IF NOT UserSetupMgt.CheckRespCenter(5,"Responsibility Center") THEN
                                                                 ERROR(Text026, ResponsibilityCenter.TABLECAPTION, UserSetupMgt.GetRTPSFilter);
                                                              END;
                                                               }
    { 1010;   ;Created By User ID  ;Text50        ;Editable=No }
    { 1011;   ;Modified By User ID ;Text50        ;Editable=No }
    { 1012;   ;Technical In-charge ;Code20        ;TableRelation=Resource WHERE (Blocked=CONST(No));
                                                   OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                Resource.RESET;
                                                                IF "Technical In-charge" <> '' THEN
                                                                  Resource.GET("Technical In-charge")
                                                                ELSE BEGIN
                                                                  CLEAR(Resource);
                                                                END;
                                                                "Technical In-charge Name" := Resource.Name;
                                                                "Department Code" := Resource."User Group Code";
                                                                VALIDATE("Department Code");
                                                              END;
                                                               }
    { 1013;   ;Salesperson Code    ;Code20        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 1014;   ;Technical In-charge Name;Text50    ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;

                                                   Editable=No }
    { 1015;   ;Department Code     ;Code20        ;TableRelation="User Group";
                                                   OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                                IF "Department Code" <> '' THEN
                                                                  UserGroup.GET("Department Code")
                                                                ELSE BEGIN
                                                                  CLEAR(UserGroup);
                                                                END;

                                                                "Receiving Department" := UserGroup.Name;
                                                              END;
                                                               }
    { 1016;   ;Assigned User ID    ;Code50        ;OnValidate=BEGIN
                                                                TestRTPSAdmin;
                                                              END;
                                                               }
    { 1017;   ;Base Approver User ID;Code50       ;TableRelation="User Setup";
                                                   Editable=No }
    { 1018;   ;Completed By        ;Text50        ;Editable=No }
    { 1019;   ;Completed Date      ;Date          ;Editable=No }
    { 1020;   ;Job No.             ;Code20        ;TableRelation=Job }
    { 1030;   ;Override Completed By;Code50       ;TableRelation="User Setup" }
    { 1035;   ;Override Completed Date;Date        }
    { 1040;   ;Override Status     ;Option        ;OptionCaptionML=ENU=" ,Completed,Cancelled";
                                                   OptionString=[ ,Completed,Cancelled] }
    { 50500;  ;Opportunity No.     ;Code20        ;TableRelation=Opportunity WHERE (Closed=CONST(No),
                                                                                    Contact No.=FIELD(Contact No.));
                                                   OnValidate=BEGIN
                                                                LinkOpportunity(xRec."Opportunity No.");
                                                              END;
                                                               }
    { 500010; ;Cancelled By        ;Text50        ;Editable=No }
    { 500015; ;Cancelled Date      ;DateTime      ;Editable=No }
    { 500020; ;Incoming Document Entry No.;Integer }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Project Description                      }
    {    ;Technical In-charge                      }
    {    ;Salesperson Code                         }
    {    ;Customer No.                             }
    {    ;Customer Name                            }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Project Description,Salesperson Code,Technical In-charge,Customer No.,Customer Name }
  }
  CODE
  {
    VAR
      CustomSetup@1028 : Record 50001;
      Cust@1001 : Record 18;
      Employee@1000 : Record 5200;
      UserSetup@1002 : Record 91;
      Resource@1003 : Record 156;
      UserGroup@1004 : Record 9000;
      Text001@1005 : TextConst 'ENU=Do you want to done the Request for Technical Support %1?';
      Text002@1006 : TextConst 'ENU=Do you want to cancel the Request for Technical Support %1?';
      Text003@1009 : TextConst 'ENU=Do you want to open the Request for Technical Support %1?';
      Text004@1026 : TextConst 'ENU=Please check atleast one (1) from the Type of Request.';
      Text005@1016 : TextConst 'ENU=Do you want to change %1?';
      Text006@1027 : TextConst 'ENU=%1 must not be later then %2. Current value of %2 is %3. Do you want to update the %2?';
      Text007@1029 : TextConst 'ENU=You do not have a valid User Setup. Please contact your administrator.';
      Text038@1012 : TextConst 'ENU=Contact %1 %2 is related to a different company than customer %3.';
      Text049@1013 : TextConst 'ENU=The %1 field cannot be blank because this document is linked to an opportunity.';
      Error001@1007 : TextConst 'ENU=RFTS No. %1 is already done.';
      Error002@1008 : TextConst 'ENU=RFTS No. %1 is already cancelled.';
      Error003@1010 : TextConst 'ENU=RFTS No. %1 is already opened.';
      Emp@1011 : Record 5200;
      ResponsibilityCenter@1024 : Record 5714;
      UserSetupMgt@1022 : Codeunit 5700;
      HideValidationDialog@1014 : Boolean;
      Confirmed@1015 : Boolean;
      Text037@1017 : TextConst 'ENU=Contact %1 %2 is not related to customer %3.';
      Text039@1018 : TextConst 'ENU=Contact %1 %2 is not related to a customer.';
      SkipSellToContact@1019 : Boolean;
      SkipBillToContact@1020 : Boolean;
      Text048@1021 : TextConst 'ENU=Request for Technical/Product Support %1 has already been assigned to opportunity %2. Would you like to reassign this document?';
      Text026@1023 : TextConst 'ENU=Your identification is set up to process from %1 %2 only.';
      Text062@1025 : TextConst 'ENU=You cannot change %1 because the corresponding %2 %3 has been assigned to this document.';

    PROCEDURE InitInsert@61();
    VAR
      NoSeriesMgt@1000 : Codeunit 396;
    BEGIN
      IF "No." = '' THEN BEGIN
        NoSeriesMgt.InitSeries(GetNoSeriesCode,xRec."No. Series","Document Date","No.","No. Series");
      END;

      InitRecord;
    END;

    LOCAL PROCEDURE InitRecord@48();
    BEGIN
      TestDefaultNoSeries;
      SetGeneralInfo;
      Checkfield;
    END;

    PROCEDURE InitPageValues@53();
    BEGIN
      IF "No." = '' THEN BEGIN
        TestGeneralSetup;
        SetGeneralInfo;
      END;
    END;

    LOCAL PROCEDURE SetGeneralInfo@55();
    BEGIN
      "Document Date" := TODAY;
      "Date Requested" := TODAY;
      "Created By User ID" := USERID;
      Timeline := TODAY + 1;
      "Responsibility Center" := UserSetupMgt.GetRTPSFilter;
      "Salesperson Code" := UserSetupMgt.GetSalespersonPurchaserCode;
      GetUserSetup;
      IF Employee.GET(UserSetup."Employee No.") THEN BEGIN
        "Employee No." := Employee."No.";
        "Employee Name" := Employee.FullName;
      END;
    END;

    LOCAL PROCEDURE GetNoSeriesCode@1() : Code[20];
    VAR
      CustomSetup@1000 : Record 50001;
    BEGIN
      CustomSetup.GET;
      CustomSetup.TESTFIELD("RFTS Nos.");
      EXIT(CustomSetup."RFTS Nos.");
    END;

    PROCEDURE PrintDocument@2();
    VAR
      RFTS@1000 : Report 50010;
    BEGIN
      CLEAR(RFTS);
      RFTS.SetReportFilter("No.");
      RFTS.RUNMODAL;
    END;

    PROCEDURE GetEmployeeName@3(EmpNo@1000 : Code[20]) : Text;
    VAR
      Emp@1001 : Record 5200;
    BEGIN
      IF Emp.GET(EmpNo) THEN
        EXIT(Emp."First Name"+ ' '+Emp."Last Name");
    END;

    PROCEDURE Checkfield@8();
    BEGIN
      TESTFIELD("Employee No.");
      TESTFIELD("Customer No.");
      TESTFIELD("Contact No.");
      TESTFIELD("Project Description");
      TESTFIELD(Timeline);
      TESTFIELD("Technical In-charge");
      TESTFIELD("Department Code");

      IF NOT "Site Survey" AND NOT "Demo Testing" AND NOT "Product Presentation" AND
         NOT"Bill of Materials" AND NOT "Service Engineering" AND NOT Others THEN
        ERROR(Text004);

      IF "Site Survey" = TRUE THEN
        TESTFIELD("SS Area");
      IF "Demo Testing" = TRUE THEN BEGIN
        TESTFIELD("DT Equipment");
        TESTFIELD("DT Area");
      END;
      IF "Bill of Materials" = TRUE THEN BEGIN
        TESTFIELD("Information of Project");
        TESTFIELD("Date of Submission to PM/AM");
      END;
      TESTFIELD("Scope/Deliverables");
    END;

    PROCEDURE DoneDocument@6() : Boolean;
    BEGIN
      TESTFIELD(Status, Status::Released);
      TestDemoTestingDetails;
      TestSiteSurveyDetails;
      TestBomDetails;
      IF "Request Status" = "Request Status"::Done THEN BEGIN
        ERROR(Error001, "No.");
        EXIT(FALSE);
      END;

      IF NOT CONFIRM(Text001,TRUE, "No.") THEN
        EXIT(FALSE);

      Rec."Request Status" := "Request Status"::Done;
      Rec."Completed By" := USERID;
      Rec."Completed Date" := TODAY;
      Rec.MODIFY;
      EXIT(TRUE);
    END;

    PROCEDURE CancelDocument@7() : Boolean;
    BEGIN
      TESTFIELD(Status, Status::Released);
      IF "Request Status" = "Request Status"::Cancelled THEN BEGIN
        ERROR(Error002, "No.");
        EXIT(FALSE);
      END;

      IF NOT CONFIRM(Text002, TRUE, "No.") THEN
        EXIT(FALSE);

      Rec."Request Status" := "Request Status"::Cancelled;
      Rec.MODIFY;
      EXIT(TRUE);
    END;

    PROCEDURE OpenDocument@15() : Boolean;
    BEGIN
      TESTFIELD(Status, Status::Released);
      IF "Request Status" = "Request Status"::" " THEN BEGIN
        ERROR(Error003, "No.");
        EXIT(FALSE);

      END;

      IF NOT CONFIRM(Text003, TRUE, "No.") THEN
        EXIT(FALSE);

      Rec."Request Status" := "Request Status"::" ";
      CLEAR(Rec."Completed By");
      CLEAR(Rec."Completed Date");
      Rec.MODIFY;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE TestGeneralSetup@20();
    BEGIN
      TestDefaultNoSeries;
      IF NOT UserSetup.GET(USERID) THEN
        ERROR(Text007);
    END;

    LOCAL PROCEDURE TestDefaultNoSeries@14();
    BEGIN
      CustomSetup.GET;
      CustomSetup.TESTFIELD("RFTS Nos.");
    END;

    PROCEDURE TestSiteSurveyDetails@5();
    BEGIN
      IF "Site Survey" = TRUE THEN BEGIN
        TESTFIELD("SSS Actual Date From");
        TESTFIELD( "SSS Actual Date To");
      END;
    END;

    PROCEDURE TestDemoTestingDetails@9();
    BEGIN
      IF "Demo Testing" = TRUE THEN BEGIN
        TESTFIELD("DTS Actual Date From");
        TESTFIELD("DTS Actual Date To");
      END;
    END;

    PROCEDURE TestBomDetails@10();
    BEGIN
      IF "Bill of Materials" = TRUE THEN BEGIN
        //TESTFIELD("Job No.");
      END;
    END;

    LOCAL PROCEDURE TestRTPSAdmin@4();
    BEGIN
      IF ((UserSetup.GET(USERID)) AND (UserSetup."RTPS Admin" = FALSE)) OR NOT UserSetup.GET(USERID) THEN
        TESTFIELD(Status, Status::Open);
    END;

    PROCEDURE IsRTPSAdmin@11() : Boolean;
    BEGIN
      IF (UserSetup.GET(USERID)) AND (UserSetup."RTPS Admin" = TRUE) THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE UpdateCustomer@25(ContactNo@1002 : Code[20]);
    VAR
      ContBusinessRelation@1007 : Record 5054;
      Customer@1006 : Record 18;
      Cont@1005 : Record 5050;
      CustTemplate@1004 : Record 5105;
      ContComp@1003 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN
        "Contact No." := Cont."No."
      ELSE BEGIN
        "Contact Name" := '';
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF ("Customer No." <> '') AND
           ("Customer No." <> ContBusinessRelation."No.")
        THEN
          ERROR(Text037,Cont."No.",Cont.Name,"Customer No.");
        IF "Customer No." = '' THEN BEGIN
          SkipSellToContact := TRUE;
          VALIDATE("Customer No.",ContBusinessRelation."No.");
          SkipSellToContact := FALSE;
        END;
      END;

      IF Cont.Type = Cont.Type::Person THEN
        "Contact Name" := Cont.Name
      ELSE
        IF Customer.GET("Customer No.") THEN BEGIN
          "Contact Name" := Customer.Contact;
        END ELSE BEGIN
          "Contact Name" := '';
        END;

      // IF "Document Type" = "Document Type"::Quote THEN BEGIN
      //  IF Customer.GET("Sell-to Customer No.") OR Customer.GET(ContBusinessRelation."No.") THEN BEGIN
      //    IF Customer."Copy Sell-to Addr. to Qte From" = Customer."Copy Sell-to Addr. to Qte From"::Company THEN BEGIN
      //      Cont.TESTFIELD("Company No.");
      //      Cont.GET(Cont."Company No.");
      //    END;
      //  END ELSE BEGIN
      //    Cont.TESTFIELD("Company No.");
      //    Cont.GET(Cont."Company No.");
      //  END;
      //  "Sell-to Address" := Cont.Address;
      //  "Sell-to Address 2" := Cont."Address 2";
      //  "Sell-to City" := Cont.City;
      //  "Sell-to Post Code" := Cont."Post Code";
      //  "Sell-to County" := Cont.County;
      //  "Sell-to Country/Region Code" := Cont."Country/Region Code";
      // END;
      // IF ("Customer No." = "Bill-to Customer No.") OR
      //   ("Bill-to Customer No." = '')
      // THEN
      //  VALIDATE("Bill-to Contact No.","Sell-to Contact No.");
    END;

    LOCAL PROCEDURE UpdateBillToCont@27(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cust@1001 : Record 18;
    BEGIN
      IF Cust.GET(CustomerNo) THEN BEGIN
        IF Cust."Primary Contact No." <> '' THEN
          "Contact No." := Cust."Primary Contact No."
        ELSE BEGIN
          ContBusRel.RESET;
          ContBusRel.SETCURRENTKEY("Link to Table","No.");
          ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
          ContBusRel.SETRANGE("No.","Customer No.");
          IF ContBusRel.FINDFIRST THEN
            "Contact No." := ContBusRel."Contact No."
          ELSE
            "Contact No." := '';
        END;
        "Contact Name" := Cust.Contact;
      END;
    END;

    LOCAL PROCEDURE GetCust@13(CustNo@1000 : Code[20]);
    BEGIN
      IF NOT (CustNo = '') THEN BEGIN
        IF CustNo <> Cust."No." THEN
          Cust.GET(CustNo);
      END ELSE
        CLEAR(Cust);
    END;

    LOCAL PROCEDURE GetFilterContNo@65() : Code[20];
    BEGIN
      IF GETFILTER("Contact No.") <> '' THEN
        IF GETRANGEMIN("Contact No.") = GETRANGEMAX("Contact No.") THEN
          EXIT(GETRANGEMAX("Contact No."));
    END;

    LOCAL PROCEDURE GetUserSetup@29();
    BEGIN
      UserSetup.GET(USERID);
    END;

    PROCEDURE LinkOpportunity@79(OldOpportunityNo@1000 : Code[20]);
    VAR
      SalesHeader@1001 : Record 36;
      Opportunity@1002 : Record 5092;
    BEGIN
       IF "Opportunity No." <> OldOpportunityNo THEN
        IF "Opportunity No." <> '' THEN
          IF Opportunity.GET("Opportunity No.") THEN BEGIN
            Opportunity.TESTFIELD(Status,Opportunity.Status::"In Progress");
            "Project Description" := Opportunity.Description;
          END;
    END;

    LOCAL PROCEDURE UpdateOpportunityLink@80(Opportunity@1000 : Record 5092;RTPSNo@1002 : Code[20]);
    BEGIN
       Opportunity."Sales Document No." := RTPSNo;
       Opportunity.MODIFY;
    END;

    LOCAL PROCEDURE SetScopeDeliverables@12();
    BEGIN
      CLEAR("Scope/Deliverables");
      IF "Site Survey" THEN
        "Scope/Deliverables" += ', ' + FIELDCAPTION("Site Survey");
      IF "Demo Testing" THEN
        "Scope/Deliverables" += ', ' + FIELDCAPTION("Demo Testing");
      IF "Product Presentation" THEN
        "Scope/Deliverables" += ', ' + FIELDCAPTION("Product Presentation");
      IF "Bill of Materials" THEN
        "Scope/Deliverables" += ', ' + FIELDCAPTION("Bill of Materials");
      IF "Service Engineering" THEN
        "Scope/Deliverables" += ', ' + FIELDCAPTION("Service Engineering");


      "Scope/Deliverables" := COPYSTR("Scope/Deliverables", 3, STRLEN("Scope/Deliverables"));
    END;

    LOCAL PROCEDURE AdjustTimelineOfSpecificRequest@51();
    BEGIN
      // IF "Site Survey" THEN BEGIN
      //  IF Timeline < "SSS Actual Date To" THEN
      // END;
    END;

    BEGIN
    END.
  }
}

