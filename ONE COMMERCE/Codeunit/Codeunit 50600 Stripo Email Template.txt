OBJECT Codeunit 50600 Stripo Email Template
{
  OBJECT-PROPERTIES
  {
    Date=06/26/18;
    Time=[ 4:12:04 AM];
    Modified=Yes;
    Version List=NAVOC1.00.02.00.01;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      StringConversionManagement@1000 : Codeunit 47;

    PROCEDURE ReplaceTokenWithStripoApprovalEntry@17(VAR NotificationBody@1001 : DotNet "'mscorlib'.System.String";RecID@1000 : RecordID);
    VAR
      ApprovalEntry@1006 : Record 454;
      FirstSeqApprovalEntry@1035 : Record 454;
      StripoApprovalEntryBody@1005 : Text;
      StripoApprovalEntryStripe@1004 : Text;
      TempStripoApprovalEntryStripe@1027 : Text;
      i@1003 : Integer;
      StripoCommentBodyDotNet@1002 : DotNet "'mscorlib'.System.String";
      StripoApprovalEntryHeader1@1026 : TextConst 'ENU="<table cellpadding=""0"" cellspacing=""0"" class=""es-content"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%""> 
        <tr> 
         <td align=""center"" id=""system-generated-approvals"" style=""padding:0;Margin:0""> 
          <table bgcolor=""#ffffff"" class=""es-content-body"" align=""center"" cellpadding=""0"" cellspacing=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:900px""> 
            <tr> 
             <td align=""left"" style=""padding:0;Margin:0""> 
              <table cellpadding=""0"" cellspacing=""0"" width=""100%"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
                <tr> 
                 <td align=""center"" valign=""top"" style=""padding:0;Margin:0;width:900px""> "';
      StripoApprovalEntryHeader2@1025 : TextConst 'ENU="              <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
                    <tr> 
                     <td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-left:10px""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:19px;color:#333333;font-size:16px""><b><u>SYSTEM GENERATED APPROVAL/S:</u></b></p></td> 
                    </tr> 
                  </table></td> 
                </tr> 
              </table></td> 
            </tr> 
            <tr> 
             <td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-left:5px;padding-right:5px""><!--[if mso]><table style=""width:890px"" cellpadding=""0"" cellspacing=""0""><tr><td style=""width:177px"" valign=""top""><![endif]--> 
    "';

      StripoApprovalEntryHeader3@1024 : TextConst
        'ENU="          <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
                <tr> 
                 <td class=""es-m-p0r es-m-p20b"" align=""center"" style=""padding:0;Margin:0;width:177px""> 
                  <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
                    <tr> 
                     <td align=""left"" bgcolor=""#990000"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px""><strong>Sender ID</strong></p></td> 
                    </tr> 
                  </table></td> 
    "';
      StripoApprovalEntryHeader4@1023 : TextConst 'ENU="            </tr> 
              </table><!--[if mso]></td><td style=""width:177px"" valign=""top""><![endif]--> 
              <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
                <tr> 
                 <td class=""es-m-p20b"" align=""center"" style=""padding:0;Margin:0;width:177px""> 
                  <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
                    <tr> 
    "';
      StripoApprovalEntryHeader5@1022 : TextConst 'ENU="                 <td align=""left"" bgcolor=""#990000"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px""><strong>Approver ID</strong></p></td> 
                    </tr> 
                  </table></td> 
                </tr> 
              </table><!--[if mso]></td><td style=""width:87px"" valign=""top""><![endif]--> 
              <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
                <tr> 
                 <td class=""es-m-p20b"" align=""center"" style=""padding:0;Margin:0;width:87px""> 
    "';

      StripoApprovalEntryHeader6@1021 : TextConst
        'ENU="              <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
                    <tr> 
                     <td align=""left"" bgcolor=""#990000"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px""><strong>Status</strong></p></td> 
                    </tr> 
                  </table></td> 
                </tr> 
              </table><!--[if mso]></td><td style=""width:80px"" valign=""top""><![endif]--> 
              <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
                <tr> 
    "';
      StripoApprovalEntryHeader7@1020 : TextConst 'ENU="             <td align=""center"" class=""es-m-p20b"" style=""padding:0;Margin:0;width:80px""> 
                  <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
                    <tr> 
                     <td align=""left"" bgcolor=""#990000"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px""><strong>Sequence</strong></p></td> 
                    </tr> 
                  </table></td> 
                </tr> 
              </table><!--[if mso]></td><td style=""width:198px"" valign=""top""><![endif]--> 
    "';

      StripoApprovalEntryHeader8@1028 : TextConst
        'ENU="          <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
                <tr> 
                 <td align=""left"" class=""es-m-p20b"" style=""padding:0;Margin:0;width:198px""> 
                  <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
                    <tr> 
                     <td align=""right"" bgcolor=""#990000"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-right:10px;border-width:thin;border-style:solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px""><strong>Date-Time Sent for Appvl.</strong></p></td> 
                    </tr> 
                  </table></td> 
    "';
      StripoApprovalEntryHeader9@1029 : TextConst 'ENU="            </tr> 
              </table><!--[if mso]></td><td style=""width:0px""></td><td style=""width:171px"" valign=""top""><![endif]--> 
              <table cellpadding=""0"" cellspacing=""0"" class=""es-right"" align=""right"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right""> 
                <tr> 
                 <td align=""left"" style=""padding:0;Margin:0;width:171px""> 
                  <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
                    <tr> 
    "';
      StripoApprovalEntryHeader10@1030 : TextConst 'ENU="                 <td align=""right"" bgcolor=""#990000"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-right:10px;border-width:thin;border-style:solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px""><strong>Date-Time Modified</strong></p></td> 
                    </tr> 
                  </table></td> 
                </tr> 
              </table><!--[if mso]></td></tr></table><![endif]--></td> 
            </tr> 
    "';
      StripoApprovalEntryStripe1_1@1019 : TextConst 'ENU="<tr> 
      <td align=""left"" style=""padding:0;Margin:0;padding-left:5px;padding-right:5px""><!--[if mso]><table style=""width:890px"" cellpadding=""0"" cellspacing=""0""><tr><td style=""width:177px"" valign=""top""><![endif]--> 
       <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
         <tr> 
          <td class=""es-m-p0r es-m-p20b"" align=""center"" style=""padding:0;Margin:0;width:177px""> 
           <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
             <tr> 
    "';
      StripoApprovalEntryStripe1_2@1018 : TextConst 'ENU="          <td align=""left"" bgcolor=""#f4cccc"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-left:1px solid;border-bottom:1px solid;border-right:1px solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px""><strong>%1</strong></p></td> 
             </tr> 
           </table></td> 
         </tr> 
       </table><!--[if mso]></td><td style=""width:177px"" valign=""top""><![endif]--> 
       <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
         <tr> 
          <td class=""es-m-p20b"" align=""center"" style=""padding:0;Margin:0;width:177px""> 
    "';
      StripoApprovalEntryStripe1_3@1017 : TextConst 'ENU="       <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
             <tr> 
              <td align=""left"" bgcolor=""#f4cccc"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-bottom:1px solid;border-right:1px solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px""><strong>%2</strong></p></td> 
             </tr> 
           </table></td> 
         </tr> 
       </table><!--[if mso]></td><td style=""width:87px"" valign=""top""><![endif]--> 
       <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
         <tr> 
    "';
      StripoApprovalEntryStripe1_4@1016 : TextConst 'ENU="      <td class=""es-m-p20b"" align=""center"" style=""padding:0;Margin:0;width:87px""> 
           <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
             <tr> 
              <td align=""left"" bgcolor=""#f4cccc"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-bottom:1px solid;border-right:1px solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px""><strong>%3</strong></p></td> 
             </tr> 
           </table></td> 
         </tr> 
       </table><!--[if mso]></td><td style=""width:80px"" valign=""top""><![endif]--> 
    "';
      StripoApprovalEntryStripe1_5@1015 : TextConst 'ENU="   <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
         <tr> 
          <td align=""center"" class=""es-m-p20b"" style=""padding:0;Margin:0;width:80px""> 
           <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
             <tr> 
              <td align=""center"" bgcolor=""#f4cccc"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-bottom:1px solid;border-right:1px solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px""><strong>%4</strong></p></td> 
             </tr> 
           </table></td> 
         </tr> 
    "';

      StripoApprovalEntryStripe1_6@1014 : TextConst
        'ENU="   </table><!--[if mso]></td><td style=""width:198px"" valign=""top""><![endif]--> 
       <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
         <tr> 
          <td align=""left"" class=""es-m-p20b"" style=""padding:0;Margin:0;width:198px""> 
           <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
             <tr> 
              <td align=""right"" bgcolor=""#f4cccc"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-right:10px;border-bottom:1px solid;border-right:1px solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">%5</p></td> 
             </tr> 
           </table></td> 
    "';

      StripoApprovalEntryStripe1_7@1031 : TextConst
        'ENU="     </tr> 
       </table><!--[if mso]></td><td style=""width:0px""></td><td style=""width:171px"" valign=""top""><![endif]--> 
       <table cellpadding=""0"" cellspacing=""0"" class=""es-right"" align=""right"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right""> 
         <tr> 
          <td align=""left"" style=""padding:0;Margin:0;width:171px""> 
           <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
             <tr> 
              <td align=""right"" bgcolor=""#f4cccc"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-right:10px;border-bottom:1px solid;border-right:1px solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">%6</p></td> 
             </tr> 
    "';
      StripoApprovalEntryStripe1_8@1032 : TextConst 'ENU="       </table></td> 
         </tr> 
       </table><!--[if mso]></td></tr></table><![endif]--></td> 
     </tr> "';
      StripoApprovalEntryStripe2_1@1013 : TextConst 'ENU=" <tr> 
      <td align=""left"" style=""padding:0;Margin:0;padding-left:5px;padding-right:5px""><!--[if mso]><table style=""width:890px"" cellpadding=""0"" cellspacing=""0""><tr><td style=""width:177px"" valign=""top""><![endif]--> 
       <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
         <tr> 
          <td class=""es-m-p0r es-m-p20b"" align=""center"" style=""padding:0;Margin:0;width:177px""> 
           <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
             <tr> 
    "';
      StripoApprovalEntryStripe2_2@1012 : TextConst 'ENU="          <td align=""left"" bgcolor=""#ea9999"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-left:1px solid;border-bottom:1px solid;border-right:1px solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px""><strong>%1</strong></p></td> 
             </tr> 
           </table></td> 
         </tr> 
       </table><!--[if mso]></td><td style=""width:177px"" valign=""top""><![endif]--> 
       <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
         <tr> 
          <td class=""es-m-p20b"" align=""center"" style=""padding:0;Margin:0;width:177px""> 
    "';
      StripoApprovalEntryStripe2_3@1011 : TextConst 'ENU="       <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
             <tr> 
              <td align=""left"" bgcolor=""#ea9999"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-bottom:1px solid;border-right:1px solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px""><strong>%2</strong></p></td> 
             </tr> 
           </table></td> 
         </tr> 
       </table><!--[if mso]></td><td style=""width:87px"" valign=""top""><![endif]--> 
       <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
         <tr> 
    "';
      StripoApprovalEntryStripe2_4@1010 : TextConst 'ENU="      <td class=""es-m-p20b"" align=""center"" style=""padding:0;Margin:0;width:87px""> 
           <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
             <tr> 
              <td align=""left"" bgcolor=""#ea9999"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-bottom:1px solid;border-right:1px solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px""><strong>%3</strong></p></td> 
             </tr> 
           </table></td> 
         </tr> 
       </table><!--[if mso]></td><td style=""width:80px"" valign=""top""><![endif]--> 
    "';
      StripoApprovalEntryStripe2_5@1009 : TextConst 'ENU="   <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
         <tr> 
          <td align=""center"" class=""es-m-p20b"" style=""padding:0;Margin:0;width:80px""> 
           <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
             <tr> 
              <td align=""center"" bgcolor=""#ea9999"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-bottom:1px solid;border-right:1px solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px""><strong>%4</strong></p></td> 
             </tr> 
           </table></td> 
         </tr> 
    "';

      StripoApprovalEntryStripe2_6@1008 : TextConst
        'ENU="   </table><!--[if mso]></td><td style=""width:198px"" valign=""top""><![endif]--> 
       <table cellpadding=""0"" cellspacing=""0"" class=""es-left"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left""> 
         <tr> 
          <td align=""left"" class=""es-m-p20b"" style=""padding:0;Margin:0;width:198px""> 
           <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
             <tr> 
              <td align=""right"" bgcolor=""#ea9999"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-right:10px;border-bottom:1px solid;border-right:1px solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">%5</p></td> 
             </tr> 
           </table></td> 
    "';

      StripoApprovalEntryStripe2_7@1033 : TextConst
        'ENU="     </tr> 
       </table><!--[if mso]></td><td style=""width:0px""></td><td style=""width:171px"" valign=""top""><![endif]--> 
       <table cellpadding=""0"" cellspacing=""0"" class=""es-right"" align=""right"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right""> 
         <tr> 
          <td align=""left"" style=""padding:0;Margin:0;width:171px""> 
           <table cellpadding=""0"" cellspacing=""0"" width=""100%"" role=""presentation"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px""> 
             <tr> 
              <td align=""right"" bgcolor=""#ea9999"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-right:10px;border-bottom:1px solid;border-right:1px solid;border-color:#990000""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">%6</p></td> 
             </tr> 
    "';
      StripoApprovalEntryStripe2_8@1034 : TextConst 'ENU="       </table></td> 
         </tr> 
       </table><!--[if mso]></td></tr></table><![endif]--></td> 
     </tr> "';
      StripoApprovalEntryFooter1@1007 : TextConst 'ENU="
               </table></td> 
             </tr> 
           </table> "';
    BEGIN
       FirstSeqApprovalEntry.SETRANGE("Record ID to Approve", RecID);
       FirstSeqApprovalEntry.SETRANGE("Sequence No.", 1);
       IF NOT FirstSeqApprovalEntry.FINDLAST THEN
         EXIT;

       ApprovalEntry.SETRANGE("Record ID to Approve", RecID);
       ApprovalEntry.SETFILTER("Entry No.", '%1..',FirstSeqApprovalEntry."Entry No.");
       IF ApprovalEntry.FINDSET THEN BEGIN
         i := 1;
        StripoApprovalEntryBody := StripoApprovalEntryHeader1 + StripoApprovalEntryHeader2 + StripoApprovalEntryHeader3 + StripoApprovalEntryHeader4 + StripoApprovalEntryHeader5 +
            StripoApprovalEntryHeader6 + StripoApprovalEntryHeader7 + StripoApprovalEntryHeader8 + StripoApprovalEntryHeader9 + StripoApprovalEntryHeader10;
        REPEAT
          i  += 1;
           IF (i MOD 2) = 0 THEN BEGIN
             TempStripoApprovalEntryStripe := StripoApprovalEntryStripe1_1 + StripoApprovalEntryStripe1_2 + StripoApprovalEntryStripe1_3 +
                StripoApprovalEntryStripe1_4 + StripoApprovalEntryStripe1_5 + StripoApprovalEntryStripe1_6 + StripoApprovalEntryStripe1_7 +
                StripoApprovalEntryStripe1_8;
           END ELSE BEGIN
             TempStripoApprovalEntryStripe := StripoApprovalEntryStripe2_1 + StripoApprovalEntryStripe2_2 + StripoApprovalEntryStripe2_3 +
                StripoApprovalEntryStripe2_4 + StripoApprovalEntryStripe2_5 + StripoApprovalEntryStripe2_6 + StripoApprovalEntryStripe2_7 +
                StripoApprovalEntryStripe2_8;
           END;

          StripoApprovalEntryStripe += STRSUBSTNO(TempStripoApprovalEntryStripe, ApprovalEntry."Sender ID", ApprovalEntry."Approver ID",
            ApprovalEntry.Status, ApprovalEntry."Sequence No.", ApprovalEntry."Date-Time Sent for Approval", ApprovalEntry."Last Date-Time Modified");
        UNTIL ApprovalEntry.NEXT = 0;
        StripoApprovalEntryBody += StripoApprovalEntryStripe + StripoApprovalEntryFooter1;
        NotificationBody := NotificationBody.Replace('%StripoApprovalEntry%', StripoApprovalEntryBody);
       END ELSE BEGIN
        NotificationBody := NotificationBody.Replace('%StripoApprovalEntry%', '');
       END;
    END;

    PROCEDURE ReplaceTokenWithJOVehicleRequest@8(VAR NotificationBody@1000 : DotNet "'mscorlib'.System.String";JobOrder@1001 : Record 50012);
    VAR
      JobOrderLine@1002 : Record 50551;
      TempRowVehicle@1004 : Text;
      TableRowVehicle@1003 : Text;
      VehicleRequest1_1@1009 : TextConst 'ENU="<tr>
    <td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%1</p>
    </td>
    <td align=""left"" style=""border-left: thin solid #cccccc; border-top: #fff; border-bottom: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; border-right: #fff; width: 166px; padding-right: 0"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%2</p>
    </td>"';
      VehicleRequest1_2@1008 : TextConst 'ENU="<td align=""left"" style=""border-left: thin solid #cccccc; border-top: #fff; border-bottom: thin solid #cccccc; margin: 0;padding-top:5px; padding-bottom:5px; padding-left:10px; border-right: #fff; width: 156px; padding-right: 0"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%3</p>
    </td>
    <td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%4</p>
    </td>"';
      VehicleRequest1_3@1007 : TextConst 'ENU="<td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%5</p>
    </td>
    <td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%6</p>
    </td>"';
      VehicleRequest1_4@1006 : TextConst 'ENU="<td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%7</p>
    </td>
    <td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%8</p>
    </td>
    </tr>"';
      VehicleRequest2_1@1005 : TextConst 'ENU="<tr>
    <td style=""border-width:thin;border-style:solid;border-color:#cccccc"" colspan=""8"" align=""center"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">No Data</p>
    </td>
    </tr>"';
      HeadeVehicleRequest_1@1010 : TextConst 'ENU="<table style=""width: 100%"" cellpadding=""0"" cellspacing=""0"">
      <tr>
      <td colspan=""8"" style=""padding-bottom:5px"">
          <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly; font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px; text-decoration:underline"">
      <strong>VEHICLE REQUEST</strong></p>
      </td>  
           </tr>
             <tr>
             <td style=""padding-top:"">
             <table style=""width: 100%; table-layout:fixed; white-space:normal"" cellspacing=""0"" cellpadding=""0"">"';
      HeadeVehicleRequest_2@1011 : TextConst 'ENU="<tr>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 10%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Date Needed</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 23%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Destination</strong></p></td>"';
      HeadeVehicleRequest_3@1012 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 23%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Site Name</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; width: 8%; border-width :thin;border-style:solid;border-color:#990000"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Time of Departure</strong></p></td>"';
      HeadeVehicleRequest_4@1013 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 8%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Time of Return</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; width: 10%; border-width :thin;border-style:solid;border-color:#990000"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Driver Name</strong></p></td>"';

      HeadeVehicleRequest_5@1014 : TextConst
        'ENU="<td align=""left"" bgcolor=""#990000""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; width: 10%; border-width :thin;border-style:solid;border-color:#990000"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Vehicle Description</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; width: 8%; border-width :thin;border-style:solid;border-color:#990000"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Vehicle Plate No.</strong></p></td>
    </tr>"';
      VehicleRequestTableEndTag@1015 : TextConst 'ENU=</table>
      </td>
        </tr>
        </table>';
      LineVehicleRequest_1@1016 : TextConst 'ENU="<tr>
    <td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %1</p></td>
    <td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %2</p></td>"';
      LineVehicleRequest_2@1017 : TextConst 'ENU="<td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %3</p></td>
    <td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %4</p></td>"';
      LineVehicleRequest_3@1018 : TextConst 'ENU="<td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %5</p></td>
    <td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %6</p></td>"';
      LineVehicleRequest_4@1019 : TextConst 'ENU="<td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %7</p></td>
    <td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %8</p></td>
    </tr>"';
      LineVehicleRequestNoData@1020 : TextConst 'ENU="<tr>
    <td align=""center"" colspan=""8"" 
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    No Data</p></td>
    </tr>"';
      TableHeaderVehicle@1021 : Text;
      TableVehicleRequest@1022 : Text;
    BEGIN
      // init table header
      TableHeaderVehicle := HeadeVehicleRequest_1 + HeadeVehicleRequest_2 + HeadeVehicleRequest_3 + HeadeVehicleRequest_4 + HeadeVehicleRequest_5;

      JobOrderLine.RESET;
      JobOrderLine.SETRANGE("Job Order No.", JobOrder."No.");
      JobOrderLine.SETRANGE("Line Type", JobOrderLine."Line Type"::"Car Request");
      IF JobOrderLine.FINDSET THEN BEGIN
        REPEAT
          TempRowVehicle := LineVehicleRequest_1 + LineVehicleRequest_2 + LineVehicleRequest_3 +LineVehicleRequest_4;
          TableRowVehicle += STRSUBSTNO(TempRowVehicle, FORMAT(JobOrderLine."Date Needed"), FORMAT(JobOrderLine.Destination),  FORMAT(JobOrderLine."Site Name"),
          FORMAT(JobOrderLine."Time of Departure"), FORMAT(JobOrderLine."Time of Arrival"), FORMAT(JobOrderLine."Driver Name"), FORMAT(JobOrderLine."Vehicle Descrition"), FORMAT(JobOrderLine."Vehicle Plate No."));
        UNTIL JobOrderLine.NEXT = 0;
        TableVehicleRequest := TableHeaderVehicle + TableRowVehicle + VehicleRequestTableEndTag;
      END ELSE
        TableVehicleRequest := TableHeaderVehicle + LineVehicleRequestNoData + VehicleRequestTableEndTag;
      NotificationBody := NotificationBody.Replace('%TableVehicleRequest%', TableVehicleRequest);
    END;

    PROCEDURE ReplaceTokenWithJOPublicTranspoRequest@14(VAR NotificationBody@1001 : DotNet "'mscorlib'.System.String";JobOrder@1000 : Record 50012);
    VAR
      JobOrderLine@1002 : Record 50551;
      TempRowPublicTranspo@1004 : Text;
      TableRowPublicTranspo@1003 : Text;
      PublicTranspoRequest1_1@1008 : TextConst 'ENU="<tr>
    <td align=""left"" style=""border-left: thin solid #cccccc; border-top: #fff; border-bottom: thin solid #cccccc; margin: 0;padding-top:5px; padding-bottom:5px; padding-left:10px; border-right: #fff; width: 102px; padding-right: 0"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%1</p>
    </td>
    <td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%2</p>
    </td>"';
      PublicTranspoRequest1_2@1007 : TextConst 'ENU="<td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%3</p>
    </td>
    <td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%4</p>
    </td>"';
      PublicTranspoRequest1_3@1006 : TextConst 'ENU="<td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">%5</p>
    </td>
    </tr>"';
      PublicTranspoRequest2_1@1005 : TextConst 'ENU="<tr>
    <td style=""border-width:thin;border-style:solid;border-color:#cccccc"" colspan=""5"" align=""center"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">No Data</p>
    </td>
    </tr>"';
      TableHeaderPublicTranspo@1009 : Text;
      HeaderPublicTranspo_1@1010 : TextConst 'ENU="<table style=""width: 100%"" cellpadding=""0"" cellspacing=""0"">
      <tr>
      <td style=""padding-bottom: 5px;"">
      <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly; font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px; text-decoration:underline"">
        <strong>PUBLIC TRANSPORTATION REQUEST</strong></p>
        </td>
        </tr>
        <tr>
        <td>
        <table style=""width: 100%; table-layout:fixed; white-space:normal"" cellspacing=""0"" cellpadding=""0"">"';
      HeaderPublicTranspo_2@1011 : TextConst 'ENU="<tr>
    <td align=""left"" bgcolor=""#990000""
    style=""padding: 5px; border: thin solid #990000; margin: 0; width: 10%; height: 27px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Date Needed</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""padding: 5px; border: thin solid #990000; margin: 0; width: 40%; height: 27px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Destination</strong></p></td>"';
      HeaderPublicTranspo_3@1012 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""padding: 5px; border: thin solid #990000; margin: 0; width: 20%; height: 27px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Name of Passengers</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; padding: 5px; margin: 0; width: 15%; height: 27px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Date From</strong></p></td>"';
      HeaderPublicTranspo_4@1013 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""padding: 5px; border: thin solid #990000; margin: 0; width: 15%; height: 27px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Date To</strong></p></td>
    </tr>"';
      LinePublicTranspo_1@1014 : TextConst 'ENU="<tr>
    <td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %1</p></td>
    <td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %2</p></td>"';
      LinePublicTranspo_2@1015 : TextConst 'ENU="<td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %3</p></td>
    <td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %4</p></td>"';
      LinePublicTranspo_3@1016 : TextConst 'ENU="<td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %5</p></td>
    </tr>"';
      LinePublicTranspoNoData@1018 : TextConst 'ENU="<tr>
    
    
    <td align=""center"" colspan=""5"" 
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    No Data</p></td>
    </tr>"';
      TableEndTag@1017 : TextConst 'ENU=</table>
      </td>
      </tr>
    </table>';
      TablePublicTranspoRequest@1019 : Text;
    BEGIN
      // init table header
      TableHeaderPublicTranspo := HeaderPublicTranspo_1 + HeaderPublicTranspo_2 + HeaderPublicTranspo_3 + HeaderPublicTranspo_4;

      JobOrderLine.RESET;
      JobOrderLine.SETRANGE("Job Order No.", JobOrder."No.");
      JobOrderLine.SETRANGE("Line Type", JobOrderLine."Line Type"::"Public Transpo Request");
      IF JobOrderLine.FINDSET THEN BEGIN
        REPEAT
          TempRowPublicTranspo := LinePublicTranspo_1 + LinePublicTranspo_2 + LinePublicTranspo_3;
          TableRowPublicTranspo += STRSUBSTNO(TempRowPublicTranspo, FORMAT(JobOrderLine."Date Needed"), FORMAT(JobOrderLine."Destination To"),
          FORMAT(JobOrderLine."Name of Passengers"), FORMAT(JobOrderLine."Date From"), FORMAT(JobOrderLine."Date To"));
        UNTIL JobOrderLine.NEXT = 0;
        TablePublicTranspoRequest := TableHeaderPublicTranspo + TableRowPublicTranspo + TableEndTag;
      END ELSE
        TablePublicTranspoRequest := TableHeaderPublicTranspo + LinePublicTranspoNoData + TableEndTag;
      NotificationBody := NotificationBody.Replace('%TablePublicTranspoRequest%', TablePublicTranspoRequest);
    END;

    PROCEDURE ReplaceTokenWithJOAirplaneTicketRequest@19(VAR NotificationBody@1001 : DotNet "'mscorlib'.System.String";JobOrder@1000 : Record 50012);
    VAR
      JobOrderLine@1002 : Record 50551;
      TempRowAirplaneTicket@1004 : Text;
      TableRowAirplaneTicket@1003 : Text;
      AirplaneTicketRequest1_1@1009 : TextConst 'ENU="<tr>
    <td align=""left"" style=""border-left: thin solid #cccccc; border-top: #fff; border-bottom: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; border-right: #fff; width: 106px; padding-right: 0"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; color: #333333; font-size: 14px"">%1</p>
    </td>
    <td align=""left"" style=""border-left: thin solid #cccccc; border-top: #fff; border-bottom: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; border-right: #fff; width: 109px; padding-right: 0"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; color: #333333; font-size: 14px"">%2</p>
    </td>"';
      AirplaneTicketRequest1_2@1008 : TextConst 'ENU="<td align=""left"" style=""border-left: thin solid #cccccc; border-top: #fff; border-bottom: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; border-right: #fff; width: 121px; padding-right: 0"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; color: #333333; font-size: 14px"">%3</p>
    </td>
    <td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; color: #333333; font-size: 14px"">%4</p>
    </td>"';
      AirplaneTicketRequest1_3@1007 : TextConst 'ENU="<td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; color: #333333; font-size: 14px"">%5</p>
    </td>
    <td align=""left"" style=""border-left: thin solid #cccccc; border-top: #fff; border-bottom: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; border-right: #fff; width: 183px; padding-right: 0"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; color: #333333; font-size: 14px"">%6</p>
    </td>"';
      AirplaneTicketRequest1_4@1006 : TextConst 'ENU="<td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; color: #333333; font-size: 14px"">%7</p>
    </td>
    <td align=""left"" style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; color: #333333; font-size: 14px"">%8</p>
    </td>
    </tr>"';
      AirplaneTicketRequest2_1@1005 : TextConst 'ENU="<tr>
    <td style=""border-width:thin;border-style:solid;border-color:#cccccc"" colspan=""8"" align=""center"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-size: 14px; color: #333333"">No Data</p>
    </td>
    </tr>"';
      HeaderAirplaneTicket_1@1010 : TextConst 'ENU="<table style=""width: 100%"" cellpadding=""0"" cellspacing=""0"">
      <tr>
      <td style=""padding-bottom: 5px;"">
       <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly; font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px; text-decoration:underline"">
        <strong>AIRPLANE TICKET REQUEST</strong></p>
        </td>
        </tr>
        <tr>
        <td>
        <table style=""width: 100%; table-layout:fixed; white-space:normal"" cellspacing=""0"" cellpadding=""0"">"';
      HeaderAirplaneTicket_2@1011 : TextConst 'ENU="<tr>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 10%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Date Needed</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 12%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>First Name</strong></p></td>"';
      HeaderAirplaneTicket_3@1012 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 12%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Middle Name</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; width: 12%; border-width :thin;border-style:solid;border-color:#990000"">
    <p style=""Margin:0;-webkit-text-size-adj ust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Last Name</strong></p></td>"';
      HeaderAirplaneTicket_4@1013 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 10%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Birth Date</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 24%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Destination</strong></p></td>"';
      HeaderAirplaneTicket_5@1014 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 10%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Date From</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 10%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Date To</strong></p></td>
    </tr>"';
      LineAirplaneTicket_1@1015 : TextConst 'ENU="<tr>
    <td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %1</p></td>
    <td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %2</p></td>"';
      LineAirplaneTicket_2@1016 : TextConst 'ENU="<td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %3</p></td>
    <td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %4</p></td>"';
      LineAirplaneTicket_3@1017 : TextConst 'ENU="<td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %5</p></td>
    <td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %6</p></td>"';
      LineAirplaneTicket_4@1018 : TextConst 'ENU="<td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %7</p></td>
    <td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %8</p></td>
    </tr>"';
      LineAirplaneTicketNoData@1019 : TextConst 'ENU="<tr>
    <td align=""center"" colspan=""8"" 
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    No Data</p></td>
    </tr>"';
      TableEndTag@1020 : TextConst 'ENU=</table>
      </td>
      </tr>
    </table>';
      TableHeaderAirplaneTicket@1021 : Text;
      TableAirplaneTicketRequest@1022 : Text;
    BEGIN
      // init table headers
      TableHeaderAirplaneTicket := HeaderAirplaneTicket_1 + HeaderAirplaneTicket_2 + HeaderAirplaneTicket_3 + HeaderAirplaneTicket_4 + HeaderAirplaneTicket_5;

      JobOrderLine.RESET;
      JobOrderLine.SETRANGE("Job Order No.", JobOrder."No.");
      JobOrderLine.SETRANGE("Line Type", JobOrderLine."Line Type"::"Airplane Ticket Request");
      IF JobOrderLine.FINDSET THEN BEGIN
        REPEAT
          TempRowAirplaneTicket := LineAirplaneTicket_1 + LineAirplaneTicket_2 + LineAirplaneTicket_3 + LineAirplaneTicket_4;
          TableRowAirplaneTicket += STRSUBSTNO(TempRowAirplaneTicket, FORMAT(JobOrderLine."Date Needed"), FORMAT(JobOrderLine."First Name"),
          FORMAT(JobOrderLine."Middle Name"), FORMAT(JobOrderLine."Last Name"), FORMAT(JobOrderLine.Birthdate), FORMAT(JobOrderLine.Destination),
          FORMAT(JobOrderLine."Date From"), FORMAT(JobOrderLine."Date To"));
        UNTIL JobOrderLine.NEXT = 0;
        TableAirplaneTicketRequest := TableHeaderAirplaneTicket + TableRowAirplaneTicket + TableEndTag;
      END ELSE
        TableAirplaneTicketRequest := TableHeaderAirplaneTicket + LineAirplaneTicketNoData + TableEndTag;
      NotificationBody := NotificationBody.Replace('%TableAirplaneTicketRequest%', TableAirplaneTicketRequest);
    END;

    PROCEDURE ReplaceTokenWithPurchaseHeaderLines@3(VAR NotificationBody@1001 : DotNet "'mscorlib'.System.String";PurchaseHeader@1000 : Record 38);
    VAR
      PurchaseLine@1002 : Record 39;

      PurchaseLineHeaderRFPUR1_1@1004 : TextConst
        'ENU="<table style=""width: 100%; table-layout:fixed; white-space:normal"" cellspacing=""0"" cellpadding=""0"">
        <tr>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 15%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Item Code</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 22%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Item Description</strong></p></td>"';
      PurchaseLineHeaderRFPUR1_2@1005 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 8%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>UOM</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 8%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Stocks On Hand</strong></p></td>"';
      PurchaseLineHeaderRFPUR1_3@1006 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; width: 8%; border-width :thin;border-style:solid;border-color:#990000"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Min. Stocking</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 8%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Available Stock On Hand</strong></p></td>"';
      PurchaseLineHeaderRFPUR1_4@1007 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 8%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Request</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; width: 8%; border-width :thin;border-style:solid;border-color:#990000"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Total Quantity to be Purchased</strong></p></td>"';
      PurchaseLineHeaderRFPUR1_5@1008 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; width: 15%; border-width :thin;border-style:solid;border-color:#990000"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Remarks</strong></p></td>
    </tr>"';
      PurchaseLineTableFooter1_1@1009 : TextConst 'ENU=</table>';
      PurchaseLineRFPUR1_1@1019 : TextConst 'ENU="<tr>
    <td align=""left"" 
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %1</p></td>
    <td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %2</p></td>"';
      PurchaseLineRFPUR1_2@1020 : TextConst 'ENU="<td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %3</p></td>
    <td align=""right""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %4</p></td>"';
      PurchaseLineRFPUR1_3@1021 : TextConst 'ENU="<td align=""right""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %5</p></td>
    <td align=""right""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %6</p></td>"';
      PurchaseLineRFPUR1_4@1022 : TextConst 'ENU="<td align=""right""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %7</p></td>
    <td align=""right""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %8</p></td>"';
      PurchaseLineRFPUR1_5@1023 : TextConst 'ENU="<td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %9</p></td>
    </tr>"';
      Item@1028 : Record 27;
      GLAccount@1030 : Record 15;
      GeneralLedgerSetup@1059 : Record 98;
      TotalPurchaseHeader@1041 : Record 38;
      TotalPurchaseLine@1003 : Record 39;
      DocumentTotals@1061 : Codeunit 57;
      WHTManagement@1076 : Codeunit 50500;
      PurchCalcDiscByType@1077 : Codeunit 66;
      StockOnHand@1025 : Decimal;
      MinStocking@1026 : Decimal;
      AvailableStockOnHand@1027 : Decimal;
      PurchaseLinesTotalAmount@1040 : Decimal;
      VATAmount@1055 : Decimal;
      RefreshMessageEnabled@1062 : Boolean;
      InvDiscAmountEditable@1063 : Boolean;
      TablePurchaseLines@1018 : Text;
      TempPurchaseLine@1017 : Text;
      RowsPurchaseLine@1024 : Text;
      PurchaseLinesHeaderRFPUR@1010 : Text;
      PurchaseLinesHeaderCA@1035 : Text;
      PurchaseLinesHeaderPO@1046 : Text;
      UOM@1011 : Text;
      StocksOnHandTxt@1012 : Text;
      MinStokingTxt@1013 : Text;
      AvailableStockOnHandTxt@1014 : Text;
      RequestTxt@1015 : Text;
      TotalQtyToBePurchasedTxt@1016 : Text;
      CAAccountName@1029 : Text;

      PurchaseLineHeaderCA1_1@1031 : TextConst
        'ENU="<table style=""width: 100%; table-layout:fixed; white-space:normal"" cellspacing=""0"" cellpadding=""0"">
        <tr>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 10%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>No.</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 21%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Account Name</strong></p></td>"';
      PurchaseLineHeaderCA1_2@1032 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 22%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Description</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 8%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Quantity</strong></p></td>"';
      PurchaseLineHeaderCA1_3@1033 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; width: 8%; border-width :thin;border-style:solid;border-color:#990000"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>UOM</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 8%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Direct Unit Cost</strong></p></td>"';
      PurchaseLineHeaderCA1_4@1034 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 8%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Amount</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; width: 15%; border-width :thin;border-style:solid;border-color:#990000"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Remarks</strong></p></td>
    </tr>"';
      PurchaseLineCA1_1@1036 : TextConst 'ENU="<tr>
    <td align=""left"" 
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %1</p></td>
    <td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %2</p></td>"';
      PurchaseLineCA1_2@1037 : TextConst 'ENU="<td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %3</p></td>
    <td align=""right""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %4</p></td>"';
      PurchaseLineCA1_3@1038 : TextConst 'ENU="<td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %5</p></td>
    <td align=""right""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %6</p></td>"';
      PurchaseLineCA1_4@1039 : TextConst 'ENU="<td align=""right""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %7</p></td>
    <td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %8</p></td>
    </tr>"';
      PurchaseLineCATotalAmount1@1042 : TextConst 'ENU="<tr>
    <td align=""right"" colspan=""6""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    <strong>Total: %1</strong></p></td>"';
      PurchaseLineCATotalAmount2@1043 : TextConst 'ENU="<td align=""right""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff; border-left: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px; border-left: #fff"">
    <strong>%2</strong></p></td>
    <td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff; border-left: #fff"">
    &nbsp;</td>
    </tr>"';
      RowPurchaseLineTotalAmount@1044 : Text;
      CurrencyCode@1045 : Text;

      PurchaseLineHeaderPO1_1@1047 : TextConst
        'ENU="<table style=""width: 100%; table-layout:fixed; white-space:normal"" cellspacing=""0"" cellpadding=""0"">
        <tr>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 10%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>No.</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 28%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Particulars</strong></p></td>"';
      PurchaseLineHeaderPO1_2@1048 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 8%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Quantity</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; width: 8%; border-width :thin;border-style:solid;border-color:#990000"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>UOM</strong></p></td>"';
      PurchaseLineHeaderPO1_3@1049 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; width: 12%; padding-right: 5px;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Unit Cost</strong></p></td>
    <td align=""left"" bgcolor=""#990000""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; width: 12%; border-width :thin;border-style:solid;border-color:#990000"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Price</strong></p></td>
    </tr>"';
      PurchaseLinePO1_1@1051 : TextConst 'ENU="<tr>
    <td align=""left"" 
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %1</p></td>
    <td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %2</p></td>"';
      PurchaseLinePO1_2@1052 : TextConst 'ENU="<td align=""right""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %3</p></td>
    <td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %4</p></td>"';
      PurchaseLinePO1_3@1053 : TextConst 'ENU="<td align=""right""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right: 5px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %5</p></td>
    <td align=""right""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %6</p></td>
    </tr>"';
      PurchaseLinePOTotalAmount1@1050 : TextConst 'ENU="<tr>
    
    <td align=""right"" colspan=""6""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    <strong>Total Amount Incl. VAT (%1):&nbsp;&nbsp;&nbsp; %2</strong></p></td>
    </tr>"';
      PurchaseLinePOTotalAmount2@1054 : TextConst 'ENU="<tr>
    <td align=""right"" colspan=""6""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    <strong>Total VAT (%1):&nbsp;&nbsp;&nbsp;%3</strong></p></td>
    </tr>"';
      PurchaseLinePOTotalAmount3@1060 : TextConst 'ENU="<tr>
    <td align=""right"" colspan=""6""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:5px; padding-right: 5px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    <strong>Total (%1):&nbsp;&nbsp;&nbsp;%4</strong></p></td>
    </tr>"';
      QuantityTxt@1056 : Text;
      DirectUnitCostTxt@1057 : Text;
      LineAmountTxt@1058 : Text;
      TotalAmountStyle@1071 : Text;
      RefreshMessageText@1069 : Text;
      FormatDecimal@1079 : TextConst 'ENU=<Precision,2:2><Standard Format,0>';
    BEGIN
      // init table headers
      PurchaseLinesHeaderRFPUR := PurchaseLineHeaderRFPUR1_1 + PurchaseLineHeaderRFPUR1_2 + PurchaseLineHeaderRFPUR1_3 + PurchaseLineHeaderRFPUR1_4 + PurchaseLineHeaderRFPUR1_5;
      PurchaseLinesHeaderCA := PurchaseLineHeaderCA1_1 + PurchaseLineHeaderCA1_2 + PurchaseLineHeaderCA1_3 + PurchaseLineHeaderCA1_4;
      PurchaseLinesHeaderPO := PurchaseLineHeaderPO1_1 + PurchaseLineHeaderPO1_2 + PurchaseLineHeaderPO1_3;

      PurchaseLine.RESET;
      PurchaseLine.SETRANGE("Document No.", PurchaseHeader."No.");
      IF PurchaseLine.FINDSET THEN BEGIN
        CASE PurchaseHeader."Request Type" OF
          PurchaseHeader."Request Type"::"Request for Purchase":
            BEGIN
              REPEAT
                CLEAR(UOM);
                CLEAR(StocksOnHandTxt);
                CLEAR(MinStokingTxt);
                CLEAR(AvailableStockOnHandTxt);
                CLEAR(RequestTxt);
                CLEAR(TotalQtyToBePurchasedTxt);
                StockOnHand := 0;
                MinStocking := 0;
                AvailableStockOnHand := 0;

                IF (PurchaseLine.Type = PurchaseLine.Type::Item) AND (Item.GET(PurchaseLine."No.")) THEN BEGIN
                  Item.CALCFIELDS(Inventory);
                  Item.CALCFIELDS("Qty. on TERF");
                  Item.CALCFIELDS("Qty. on Withdrawal");
                  StockOnHand := Item.Inventory;
                  MinStocking := Item."Safety Stock Quantity";
                  AvailableStockOnHand := Item.Inventory - (Item."Qty. on TERF" + Item."Qty. on Withdrawal");
                  IF AvailableStockOnHand <= 0 THEN
                    AvailableStockOnHand := 0;
                END;

                IF PurchaseLine."No." <> '' THEN BEGIN
                  UOM := FORMAT(PurchaseLine."Unit of Measure Code");
                  StocksOnHandTxt := FORMAT(StockOnHand);
                  MinStokingTxt := FORMAT(MinStocking);
                  AvailableStockOnHandTxt := FORMAT(AvailableStockOnHand);
                  RequestTxt := FORMAT(PurchaseLine.Quantity);
                  TotalQtyToBePurchasedTxt := FORMAT(PurchaseLine."Qty. to be Purchased (Base)");
                END;

                TempPurchaseLine := PurchaseLineRFPUR1_1 + PurchaseLineRFPUR1_2 + PurchaseLineRFPUR1_3 + PurchaseLineRFPUR1_4 + PurchaseLineRFPUR1_5;
                RowsPurchaseLine += STRSUBSTNO(TempPurchaseLine, FORMAT(PurchaseLine."No."), StringConversionManagement.WindowsToASCII(PurchaseLine.Description), UOM,
                StocksOnHandTxt, MinStokingTxt, AvailableStockOnHandTxt, RequestTxt, TotalQtyToBePurchasedTxt, StringConversionManagement.WindowsToASCII(PurchaseLine.Remarks));
              UNTIL PurchaseLine.NEXT = 0;
              TablePurchaseLines := PurchaseLinesHeaderRFPUR + RowsPurchaseLine + PurchaseLineTableFooter1_1;
            END;
          PurchaseHeader."Request Type"::"Cash Advance":
            BEGIN

              PurchaseHeader.CALCFIELDS(Amount);
              PurchaseLinesTotalAmount := PurchaseHeader.Amount;
              CurrencyCode := PurchaseHeader."Currency Code";

              IF (CurrencyCode = '') AND GeneralLedgerSetup.GET THEN
                CurrencyCode := GeneralLedgerSetup.GetCurrencyCode(CurrencyCode);

              REPEAT
                CLEAR(CAAccountName);
                CLEAR(QuantityTxt);

                IF PurchaseLine."No." <> '' THEN BEGIN
                  IF (PurchaseLine.Type = PurchaseLine.Type::"G/L Account") AND GLAccount.GET(PurchaseLine."No.") THEN
                    CAAccountName := GLAccount.Name;
                  IF (PurchaseLine.Type = PurchaseLine.Type::Item) AND Item.GET(PurchaseLine."No.") THEN
                    CAAccountName := Item.Description;

                  QuantityTxt := FORMAT(PurchaseLine.Quantity);
                  DirectUnitCostTxt := FORMAT(PurchaseLine."Direct Unit Cost");
                  LineAmountTxt := FORMAT(PurchaseLine."Line Amount");

                END;

                TempPurchaseLine := PurchaseLineCA1_1 + PurchaseLineCA1_2 + PurchaseLineCA1_3 +PurchaseLineCA1_4;
                RowsPurchaseLine += STRSUBSTNO(TempPurchaseLine, FORMAT(PurchaseLine."No."),  StringConversionManagement.WindowsToASCII(CAAccountName), StringConversionManagement.WindowsToASCII(PurchaseLine.Description),
                QuantityTxt, FORMAT(PurchaseLine."Unit of Measure Code"), DirectUnitCostTxt, LineAmountTxt, StringConversionManagement.WindowsToASCII(PurchaseLine.Remarks));
              UNTIL PurchaseLine.NEXT = 0;
              RowPurchaseLineTotalAmount := PurchaseLineCATotalAmount1 + PurchaseLineCATotalAmount2;
              TablePurchaseLines := PurchaseLinesHeaderCA + RowsPurchaseLine + STRSUBSTNO(RowPurchaseLineTotalAmount, CurrencyCode, FORMAT(PurchaseLinesTotalAmount,0,'<Precision,2:2><Standard Format,0>')) + PurchaseLineTableFooter1_1;
            END;
          PurchaseHeader."Request Type"::" ":
            CASE PurchaseHeader."Document Type" OF
              PurchaseHeader."Document Type"::Order:
                BEGIN
                  PurchaseHeader.CALCFIELDS(Amount);
                  PurchaseLinesTotalAmount := PurchaseHeader.Amount;
                  CurrencyCode := PurchaseHeader."Currency Code";

                  IF (CurrencyCode = '') AND GeneralLedgerSetup.GET THEN
                  CurrencyCode := GeneralLedgerSetup.GetCurrencyCode(CurrencyCode);

                  REPEAT
                    IF  PurchaseLine.Description <> '' THEN BEGIN
                      CLEAR(QuantityTxt);
                      CLEAR(DirectUnitCostTxt);
                      CLEAR(LineAmountTxt);

                      IF PurchaseLine."No." <> '' THEN BEGIN
                        QuantityTxt := FORMAT(PurchaseLine.Quantity);
                        DirectUnitCostTxt := FORMAT(PurchaseLine."Direct Unit Cost");
                        LineAmountTxt := FORMAT(PurchaseLine."Line Amount");

                        // get totals
                        DocumentTotals.PurchaseUpdateTotalsControls(
                        PurchaseLine,TotalPurchaseHeader,TotalPurchaseLine,RefreshMessageEnabled,
                        TotalAmountStyle,RefreshMessageText,InvDiscAmountEditable,VATAmount);

                      END;
                      TempPurchaseLine := PurchaseLinePO1_1 + PurchaseLinePO1_2 + PurchaseLinePO1_3;
                      RowsPurchaseLine += STRSUBSTNO(TempPurchaseLine, FORMAT(PurchaseLine."No."), StringConversionManagement.WindowsToASCII(PurchaseLine.Description), QuantityTxt, PurchaseLine."Unit of Measure Code",
                      DirectUnitCostTxt,  LineAmountTxt);
                    END;

                  UNTIL PurchaseLine.NEXT = 0;
                  RowPurchaseLineTotalAmount := PurchaseLinePOTotalAmount1 + PurchaseLinePOTotalAmount2 + PurchaseLinePOTotalAmount3;
                  TablePurchaseLines := PurchaseLinesHeaderPO + RowsPurchaseLine + STRSUBSTNO(RowPurchaseLineTotalAmount, CurrencyCode, FORMAT(TotalPurchaseLine.Amount, 0, FormatDecimal),
                  FORMAT(VATAmount, 0, FormatDecimal), FORMAT(TotalPurchaseLine."Amount Including VAT", 0, FormatDecimal)) + PurchaseLineTableFooter1_1;

                END;
              ELSE
            END;
        END;
      END;
      NotificationBody := NotificationBody.Replace('%TablePurchaseLines%', TablePurchaseLines);

    END;

    PROCEDURE ReplaceTokenWithSalesHeaderLines@2(VAR NotificationBody@1001 : DotNet "'mscorlib'.System.String";SalesHeader@1000 : Record 36);
    VAR
      SalesLine@1002 : Record 37;
      TempLine@1004 : Text;
      TableSalesLine@1003 : Text;
      SalesLine1_1@1009 : TextConst 'ENU="<tr>
    <td align=""left""
                  style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; padding-right: 0; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %1</p></td>
    <td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; padding-right: 0; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %2</p></td>"';
      SalesLine1_2@1008 : TextConst 'ENU="<td align=""left""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; padding-right: 0; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %3</p></td>"';
      SalesLine1_3@1007 : TextConst 'ENU="<td align=""right""
    style=""border: thin solid #cccccc; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; padding-right: 10px; border-top: #fff; border-right: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %4</p></td>
    <td align=""right""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px; padding-right: 10px; border-width :thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %5</p></td>
    </tr> "';
      SalesLine2_1@1005 : TextConst 'ENU="<tr>
    <td style=""border-width:thin;border-style:solid;border-color:#cccccc; padding-top:5px; padding-bottom:5px; padding-left:10px; padding-right: 10px"" colspan=""6"" align=""center"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">No Data</p>
    </td>
    </tr>"';
      QtyToRequesTtxt@1006 : Text;
      QuantityTxt@1010 : Text;
    BEGIN
      SalesLine.RESET;
      SalesLine.SETRANGE("Document No.", SalesHeader."No.");
      IF SalesLine.FINDSET THEN BEGIN
        CASE SalesHeader."Request type" OF
          SalesHeader."Request type"::Withdrawal,  SalesHeader."Request type"::"Tools & Equipment Requisition":
            BEGIN
              REPEAT
                CLEAR(QtyToRequesTtxt);
                CLEAR(QuantityTxt);

                IF SalesLine."No." <> '' THEN BEGIN
                  QtyToRequesTtxt := FORMAT(SalesLine."Quantity to Request");
                  QuantityTxt := FORMAT(SalesLine.Quantity);
                END;

                TempLine := SalesLine1_1 + SalesLine1_2 + SalesLine1_3;
                TableSalesLine += STRSUBSTNO(TempLine, FORMAT(SalesLine."No."), StringConversionManagement.WindowsToASCII(SalesLine.Description),
                (SalesLine."Unit of Measure Code"), QtyToRequesTtxt, QuantityTxt);
              UNTIL SalesLine.NEXT = 0;
            END;
          ELSE BEGIN
            TableSalesLine := SalesLine2_1;
          END;
        END;
      END ELSE
        TableSalesLine := SalesLine2_1;
      NotificationBody := NotificationBody.Replace('%TableSalesLine%', TableSalesLine);
    END;

    PROCEDURE ReplaceTokenWithRemarksNotes@116(VAR NotificationBody@1001 : DotNet "'mscorlib'.System.String";RecID@1000 : RecordID);
    VAR
      RecordLink@1002 : Record 2000000068;
      HeadersRemarksNotes@1015 : Text;
      RowsRemarksNotes@1016 : Text;
      TempRemarksNotes@1004 : Text;
      TableRemarksNotes@1003 : Text;
      NoteText@1005 : Text;
      RemarksNotesHeader1_1@1012 : TextConst 'ENU="<table style=""width: 100%; table-layout:fixed; white-space:normal"" cellspacing=""0"" cellpadding=""0"">
        <tr>
            <td style=""padding-bottom: 5px; width: 20%;"">
                <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px; text-decoration:underline"">
                    <strong>REMARKS/NOTES</strong>
                </p>
            </td>
            <td style=""padding-bottom: 5px; width: 60%;""></td>
            <td style=""padding-bottom: 5px; width: 20%;""></td>
        </tr>"';
      RemarksNotesHeader1_2@1013 : TextConst 'ENU="<tr>
            <td align=""left"" bgcolor=""#990000""
                style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; width: 20%; padding-right: 0;"">
                <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
                    <strong>User ID</strong>
                </p>
            </td>"';
      RemarksNotesHeader1_3@1011 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; width: 60%; padding-right: 0;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Note</strong>
    </p>
    </td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; width: 20%; padding-right: 0;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Date & Time</strong>
    </p>
    </td>
    </tr>"';
      RemarksNotesFooter1_1@1014 : TextConst 'ENU=</table>';
      RemarksNotes1_1@1008 : TextConst 'ENU="<tr>
    <td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top:  #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    <strong>%1</strong>
    </p>
    </td>"';
      RemarksNotes1_2@1007 : TextConst 'ENU="<td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top:  #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %2</p>
    </td>
    <td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %3</p>
    </td>
    </tr>"';
      RemarksNotes2_1@1006 : TextConst 'ENU="<tr>
      <td style=""border-width:thin;border-style:solid;border-color:#cccccc; padding-top:5px; padding-bottom:5px; padding-left:10px; padding-right: 10px"" colspan=""3"" align=""center"">
      <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">No Data</p>
      </td>
    </tr>"';
      InStr@1010 : InStream;
      OutStr@1009 : OutStream;
    BEGIN
      HeadersRemarksNotes := RemarksNotesHeader1_1 + RemarksNotesHeader1_2 + RemarksNotesHeader1_3;
      RecordLink.SETRANGE(Type, RecordLink.Type::Note);
      RecordLink.SETRANGE("Record ID", RecID);
      IF RecordLink.FINDSET THEN BEGIN
        REPEAT
          CLEAR(NoteText);
          RecordLink.CALCFIELDS(Note);
          IF RecordLink.Note.HASVALUE THEN BEGIN
            RecordLink.Note.CREATEINSTREAM(InStr);
            InStr.READ(NoteText);
          END;
          TempRemarksNotes := RemarksNotes1_1 + RemarksNotes1_2;
          RowsRemarksNotes += STRSUBSTNO(TempRemarksNotes, FORMAT(RecordLink."User ID"), StringConversionManagement.WindowsToASCII(NoteText), FORMAT(RecordLink.Created));
        UNTIL RecordLink.NEXT = 0;
        TableRemarksNotes := HeadersRemarksNotes + RowsRemarksNotes + RemarksNotesFooter1_1;
      END ELSE
        TableRemarksNotes := HeadersRemarksNotes + RemarksNotes2_1 + RemarksNotesFooter1_1;
      NotificationBody := NotificationBody.Replace('%TableRemarksNotes%', TableRemarksNotes);
    END;

    PROCEDURE ReplaceTokenWithApprovalComments@7(VAR NotificationBody@1007 : DotNet "'mscorlib'.System.String";RecID@1006 : RecordID);
    VAR
      ApprovalCommentLine@1000 : Record 455;
      HeadersApprovalComment@1011 : Text;
      RowsApprovalComment@1012 : Text;
      TempApprovalComment@1002 : Text;
      TableApprovalComment@1001 : Text;
      ApprovalCommentHeader1_1@1008 : TextConst 'ENU="<table style=""width: 100%; table-layout:fixed; white-space:normal"" cellspacing=""0"" cellpadding=""0"">
        <tr>
            <td style=""padding-bottom: 5px; width: 20%;"">
                <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:17px; font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px; text-decoration:underline"">
                    <strong>APPROVAL COMMENT</strong>
                </p>
            </td>
            <td style=""padding-bottom: 5px; width: 60%;""></td>
            <td style=""padding-bottom: 5px; width: 20%;""></td>
        </tr>"';
      ApprovalCommentHeader1_2@1009 : TextConst 'ENU="<tr>
            <td align=""left"" bgcolor=""#990000""
                style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; width: 20%; padding-right: 0;"">
                <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
                    <strong>User ID</strong>
                </p>
            </td>"';
      ApprovalCommentHeader1_3@1013 : TextConst 'ENU="<td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; width: 60%; padding-right: 0;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Comment</strong>
    </p>
    </td>
    <td align=""left"" bgcolor=""#990000""
    style=""border: thin solid #990000; margin: 0; padding-top:5px; padding-bottom:5px; padding-left:10px; width: 20%; padding-right: 0;"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#ffffff;font-size:14px"">
    <strong>Date & Time</strong>
    </p>
    </td>
    </tr>"';
      ApprovalCommentFooter1_1@1010 : TextConst 'ENU=</table>';
      ApprovalComment1_1@1005 : TextConst 'ENU="<tr>
    <td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top:  #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    <strong>%1</strong>
    </p>
    </td>"';
      ApprovalComment1_2@1004 : TextConst 'ENU="<td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-right: #fff; border-top:  #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %2</p>
    </td>
    <td align=""left""
    style=""padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-left:10px;border-width:thin;border-style:solid;border-color:#cccccc; border-top: #fff"">
    <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">
    %3</p>
    </td>
    </tr>"';
      ApprovalComment2_1@1003 : TextConst 'ENU="<tr>
      <td style=""border-width:thin;border-style:solid;border-color:#cccccc; padding-top:5px; padding-bottom:5px; padding-left:10px; padding-right: 10px"" colspan=""3"" align=""center"">
      <p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:''open sans'', ''helvetica neue'', helvetica, arial, sans-serif;line-height:17px;color:#333333;font-size:14px"">No Data</p>
      </td>
    </tr>"';
    BEGIN
      HeadersApprovalComment := ApprovalCommentHeader1_1 + ApprovalCommentHeader1_2 + ApprovalCommentHeader1_3;
      ApprovalCommentLine.SETRANGE("Record ID to Approve", RecID);
      IF ApprovalCommentLine.FINDSET THEN BEGIN
        REPEAT
          TempApprovalComment := ApprovalComment1_1 + ApprovalComment1_2;
          RowsApprovalComment += STRSUBSTNO(TempApprovalComment, FORMAT(ApprovalCommentLine."User ID"),
          FORMAT(ApprovalCommentLine.Comment), FORMAT(ApprovalCommentLine."Date and Time"));
        UNTIL ApprovalCommentLine.NEXT = 0;
        TableApprovalComment := HeadersApprovalComment + RowsApprovalComment + ApprovalCommentFooter1_1;
      END ELSE
        TableApprovalComment := HeadersApprovalComment + ApprovalComment2_1 + ApprovalCommentFooter1_1;
      NotificationBody := NotificationBody.Replace('%TableApprovalComment%', TableApprovalComment);
    END;

    BEGIN
    {
      !! Documentation Codeunit 50600 Stripo Email Template

        11:25 AM Wednesday, August 21, 2024
          Additional function for creating the HTML notification of Job Order lines.

        11:16 PM Wednesday, August 21, 2024
          Modified the Remark Notes and Approval Comment tables to make them reusable.

        2:25 PM Tuesday,  September 10, 2024
          Add function ReplaceTokenWithWithdrawal.

        3:23 PM Wednesday,  October 17, 2024
          Rename function ReplaceTokenWithWithdrawal to ReplaceTokenWithSalesHeaderLines.
          Add fucntion ReplaceTokenWithRemarksNotesV2 and ReplaceTokenWithApprovalCommentsV2.

        10:56 AM Thursday,  October 17, 2024
          Fixed No Data  row cell padding.

        3:03 PM Friday, October 18, 2024
          Chang Unit of Measure to Unit of Measure Code in function ReplaceTokenWithSalesHeaderLines.

        5:17 PM Monday, October 21, 2024
          Add function ReplaceTokenWithPurchaseHeaderLines

        8:09 PM Wednesday, October 23, 2024
          Modify function ReplaceTokenWithPurchaseHeaderLines add script for cash advance.

        2:40 PM Friday, October 25, 2024
          Modify function ReplaceTokenWithPurchaseHeaderLines add script for purchase order.

        3:09 PM Monday, October 28, 2024
          Modify function ReplaceTokenWithPurchaseHeaderLines add script for currenct and amount flowfield.

        5:21 PM Tuesday, October 29, 2024
          Modify function ReplaceTokenWithPurchaseHeaderLines add script for purchase order lines.

        11:31 AM Monday, November 4, 2024
          Modify ReplaceTokenWithPurchaseHeaderLines edit template PO line.

        5:22 PM Thursday, November 7 2024
          Modify functions ReplaceTokenWithJOVehicleRequest, ReplaceTokenWithJOPublicTranspoRequest, ReplaceTokenWithJOAirplaneTicketRequest.
          Rename ReplaceTokenWithRemarksNotesV2 to ReplaceTokenWithRemarksNotes and ReplaceTokenWithApprovalCommentsV2 to ReplaceTokenWithApprovalComments.
    }
    END.
  }
}

