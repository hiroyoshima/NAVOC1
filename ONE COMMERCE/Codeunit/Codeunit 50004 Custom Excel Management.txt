OBJECT Codeunit 50004 Custom Excel Management
{
  OBJECT-PROPERTIES
  {
    Date=09/13/18;
    Time=[ 6:49:28 PM];
    Modified=Yes;
    Version List=NAVOC1.00.02;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Navigate@1002 : Page 344;
      DimMgt@1000 : Codeunit 408;
      ConfigProgressBar@1003 : Codeunit 8615;

    PROCEDURE ExportSalesLineToExcel@1(VAR SalesHeader@1000 : Record 36;SheetName@1009 : Text[250]);
    VAR
      ExcelBuffer@1007 : TEMPORARY Record 370;
      SalesLine@1006 : Record 37;
      INTP@1005 : Record 50040;
      GenLedgerSetup@1004 : Record 98;
      ShortcutDimCode@1003 : ARRAY [8] OF Code[20];
      ProjectName@1002 : Text;
      PONoCustomer@1001 : Text;
      SellToPostCodeCommentTxt@1008 : TextConst 'ENU=Sell-to Post Code can be a site name or site details';
    BEGIN
      WITH SalesHeader DO BEGIN
        IF SalesHeader.FINDSET THEN BEGIN
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Document Type"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Document No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesHeader.FIELDCAPTION("External Document No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesHeader.FIELDCAPTION("Order Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesHeader.FIELDCAPTION("Posting Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesHeader.FIELDCAPTION("Document Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesHeader.FIELDCAPTION("Sell-to Customer Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesHeader.FIELDCAPTION("Sell-to Customer Name 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesHeader.FIELDCAPTION("Sell-to Address"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesHeader.FIELDCAPTION("Sell-to Address 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesHeader.FIELDCAPTION("Sell-to Post Code"), FALSE, SellToPostCodeCommentTxt, TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION(Type), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION(Description), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Description 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Return Reason Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Location Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Quantity to Request"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION(Quantity), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Unit of Measure Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Unit of Measure"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
      //    ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Unit Price"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
      //    ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Return Qty. to Receive"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
      //    ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Return Qty. Received"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
          IF SalesHeader."Document Type" IN [SalesHeader."Document Type"::"Return Order", SalesHeader."Document Type"::"Credit Memo"] THEN BEGIN
            ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Return Qty. to Receive"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Return Qty. Received"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          END ELSE BEGIN
            ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Qty. to Ship"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Quantity Shipped"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          END;
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Qty. to Invoice"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Quantity Invoiced"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Appl.-to Item Entry"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Appl.-from Item Entry"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
          ExcelBuffer.AddColumn(SalesHeader.FIELDCAPTION("INTP No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Project Name', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('P.O (Customer)', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Job No. 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Job Task No. 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("VAT Bus. Posting Group"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("VAT Prod. Posting Group"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Gen. Bus. Posting Group"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Gen. Prod. Posting Group"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("WHT Business Posting Group"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("WHT Product Posting Group"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Shortcut Dimension 1 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(SalesLine.FIELDCAPTION("Shortcut Dimension 2 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          GenLedgerSetup.GET;
          IF GenLedgerSetup."Shortcut Dimension 3 Code" = '' THEN
            ExcelBuffer.AddColumn(GenLedgerSetup.FIELDCAPTION("Shortcut Dimension 3 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text)
          ELSE
            ExcelBuffer.AddColumn(GenLedgerSetup."Shortcut Dimension 3 Code", FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          IF GenLedgerSetup."Shortcut Dimension 4 Code" = '' THEN
            ExcelBuffer.AddColumn(GenLedgerSetup.FIELDCAPTION("Shortcut Dimension 4 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text)
          ELSE
            ExcelBuffer.AddColumn(GenLedgerSetup."Shortcut Dimension 4 Code", FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          IF GenLedgerSetup."Shortcut Dimension 5 Code" = '' THEN
            ExcelBuffer.AddColumn(GenLedgerSetup.FIELDCAPTION("Shortcut Dimension 5 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text)
          ELSE
            ExcelBuffer.AddColumn(GenLedgerSetup."Shortcut Dimension 5 Code", FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          IF GenLedgerSetup."Shortcut Dimension 6 Code" = '' THEN
            ExcelBuffer.AddColumn(GenLedgerSetup.FIELDCAPTION("Shortcut Dimension 6 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text)
          ELSE
            ExcelBuffer.AddColumn(GenLedgerSetup."Shortcut Dimension 6 Code", FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          IF GenLedgerSetup."Shortcut Dimension 7 Code" = '' THEN
            ExcelBuffer.AddColumn(GenLedgerSetup.FIELDCAPTION("Shortcut Dimension 7 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text)
          ELSE
            ExcelBuffer.AddColumn(GenLedgerSetup."Shortcut Dimension 7 Code", FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          IF GenLedgerSetup."Shortcut Dimension 8 Code" = '' THEN
            ExcelBuffer.AddColumn(GenLedgerSetup.FIELDCAPTION("Shortcut Dimension 8 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text)
          ELSE
            ExcelBuffer.AddColumn(GenLedgerSetup."Shortcut Dimension 8 Code", FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);

          ExcelBuffer.AddColumn(SalesHeader.FIELDCAPTION(Status), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          REPEAT
            ProjectName := '';
            PONoCustomer := '';
            IF INTP.GET(SalesHeader."INTP No.") THEN BEGIN
              ProjectName := INTP."Project Name" + ' ' + INTP."Project Name 2";
              PONoCustomer := INTP."P.O No. (Customer)";
            END;
            SalesLine.RESET;
            SalesLine.SETRANGE("Document No.", SalesHeader."No.");
            SalesLine.SETRANGE("Document Type", SalesHeader."Document Type");
            IF SalesLine.FINDSET THEN
              REPEAT
                SalesLine.ShowShortcutDimCode(ShortcutDimCode);
                ExcelBuffer.NewRow;
                ExcelBuffer.AddColumn(SalesLine."Document Type", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."Document No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesHeader."External Document No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesHeader."Order Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
                ExcelBuffer.AddColumn(SalesHeader."Posting Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
                ExcelBuffer.AddColumn(SalesHeader."Document Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
                ExcelBuffer.AddColumn(SalesHeader."Sell-to Customer Name", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesHeader."Sell-to Customer Name 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesHeader."Sell-to Address", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesHeader."Sell-to Address 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesHeader."Sell-to Post Code", FALSE, SellToPostCodeCommentTxt, FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine.Type, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine.Description, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."Description 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."Return Reason Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."Location Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."Quantity to Request", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                ExcelBuffer.AddColumn(SalesLine.Quantity, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                ExcelBuffer.AddColumn(SalesLine."Unit of Measure Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."Unit of Measure", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
      //          ExcelBuffer.AddColumn(SalesLine."Unit Price", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
      //          ExcelBuffer.AddColumn(SalesLine."Return Qty. to Receive", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
      //          ExcelBuffer.AddColumn(SalesLine."Return Qty. Received", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                IF SalesHeader."Document Type" IN [SalesHeader."Document Type"::"Return Order", SalesHeader."Document Type"::"Credit Memo"] THEN BEGIN
                  ExcelBuffer.AddColumn(SalesLine."Return Qty. to Receive", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                  ExcelBuffer.AddColumn(SalesLine."Return Qty. Received", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                END ELSE BEGIN
                  ExcelBuffer.AddColumn(SalesLine."Qty. to Ship", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                  ExcelBuffer.AddColumn(SalesLine."Quantity Shipped", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                END;
                ExcelBuffer.AddColumn(SalesLine."Qty. to Invoice", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                ExcelBuffer.AddColumn(SalesLine."Quantity Invoiced", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                ExcelBuffer.AddColumn(SalesLine."Appl.-to Item Entry", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                ExcelBuffer.AddColumn(SalesLine."Appl.-from Item Entry", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                ExcelBuffer.AddColumn(SalesHeader."INTP No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ProjectName, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PONoCustomer, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."Job No. 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."Job Task No. 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."VAT Bus. Posting Group", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."VAT Prod. Posting Group", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."Gen. Bus. Posting Group", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."Gen. Prod. Posting Group", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."WHT Business Posting Group", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."WHT Product Posting Group", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."Shortcut Dimension 1 Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesLine."Shortcut Dimension 2 Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ShortcutDimCode[3], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ShortcutDimCode[4], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ShortcutDimCode[5], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ShortcutDimCode[6], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ShortcutDimCode[7], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ShortcutDimCode[8], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(SalesHeader.Status, FALSE, '', TRUE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
              UNTIL SalesLine.NEXT = 0;
          UNTIL SalesHeader.NEXT = 0;
        END;

        IF ExcelBuffer.FINDSET THEN BEGIN
          ExcelBuffer.CreateBookAndOpenExcel('',SheetName,'Sales','',USERID);
          ERROR('');
        END;
      END;
    END;

    PROCEDURE ExportPurchaseLineToExcel@2(VAR PurchaseHeader@1000 : Record 38;SheetName@1006 : Text[250]);
    VAR
      PurchaseLine@1005 : Record 39;
      ExcelBuffer@1004 : TEMPORARY Record 370;
      INTP@1003 : Record 50040;
      GeneralLedgerSetup@1002 : Record 98;
      ShortcutDimCode@1001 : ARRAY [8] OF Code[20];
    BEGIN
      WITH PurchaseHeader DO BEGIN
        IF PurchaseHeader.FINDSET THEN BEGIN
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Document Type"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Document No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseHeader.FIELDCAPTION("Vendor Invoice No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseHeader.FIELDCAPTION("Vendor Authorization No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseHeader.FIELDCAPTION("Vendor Cr. Memo No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Order Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseHeader.FIELDCAPTION("Posting Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseHeader.FIELDCAPTION("Document Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseHeader.FIELDCAPTION("Buy-from Vendor No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseHeader.FIELDCAPTION("Buy-from Vendor Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseHeader.FIELDCAPTION("Buy-from Vendor Name 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseHeader.FIELDCAPTION("Buy-from Address"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseHeader.FIELDCAPTION("Buy-from Address 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION(Type), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION(Description), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Description 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Return Reason Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Location Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION(Quantity), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Unit of Measure Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Unit of Measure"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          IF PurchaseHeader."Document Type" IN [PurchaseHeader."Document Type"::"Return Order", PurchaseHeader."Document Type"::"Credit Memo"] THEN BEGIN
            ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Return Qty. to Ship"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Return Qty. Shipped"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          END ELSE BEGIN
            ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Qty. to Receive"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Quantity Received"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          END;
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Qty. to Invoice"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Quantity Invoiced"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("INTP No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(INTP.FIELDCAPTION("Customer Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Project Name', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('P.O (Customer)', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Job No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Job Task No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("VAT Bus. Posting Group"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("VAT Prod. Posting Group"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Gen. Bus. Posting Group"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Gen. Prod. Posting Group"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("WHT Business Posting Group"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("WHT Product Posting Group"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Shortcut Dimension 1 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION("Shortcut Dimension 2 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          GeneralLedgerSetup.GET;
          IF GeneralLedgerSetup."Shortcut Dimension 3 Code" = '' THEN
            ExcelBuffer.AddColumn(GeneralLedgerSetup.FIELDCAPTION("Shortcut Dimension 3 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text)
          ELSE
            ExcelBuffer.AddColumn(GeneralLedgerSetup."Shortcut Dimension 3 Code", FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          IF GeneralLedgerSetup."Shortcut Dimension 4 Code" = '' THEN
            ExcelBuffer.AddColumn(GeneralLedgerSetup.FIELDCAPTION("Shortcut Dimension 4 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text)
          ELSE
            ExcelBuffer.AddColumn(GeneralLedgerSetup."Shortcut Dimension 4 Code", FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          IF GeneralLedgerSetup."Shortcut Dimension 5 Code" = '' THEN
            ExcelBuffer.AddColumn(GeneralLedgerSetup.FIELDCAPTION("Shortcut Dimension 5 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text)
          ELSE
            ExcelBuffer.AddColumn(GeneralLedgerSetup."Shortcut Dimension 5 Code", FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          IF GeneralLedgerSetup."Shortcut Dimension 6 Code" = '' THEN
            ExcelBuffer.AddColumn(GeneralLedgerSetup.FIELDCAPTION("Shortcut Dimension 6 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text)
          ELSE
            ExcelBuffer.AddColumn(GeneralLedgerSetup."Shortcut Dimension 6 Code", FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          IF GeneralLedgerSetup."Shortcut Dimension 7 Code" = '' THEN
            ExcelBuffer.AddColumn(GeneralLedgerSetup.FIELDCAPTION("Shortcut Dimension 7 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text)
          ELSE
            ExcelBuffer.AddColumn(GeneralLedgerSetup."Shortcut Dimension 7 Code", FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          IF GeneralLedgerSetup."Shortcut Dimension 8 Code" = '' THEN
            ExcelBuffer.AddColumn(GeneralLedgerSetup.FIELDCAPTION("Shortcut Dimension 8 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text)
          ELSE
            ExcelBuffer.AddColumn(GeneralLedgerSetup."Shortcut Dimension 8 Code", FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchaseLine.FIELDCAPTION(Status), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          REPEAT
            PurchaseLine.RESET;
            PurchaseLine.SETRANGE("Document No.", PurchaseHeader."No.");
            PurchaseLine.SETRANGE("Document Type", PurchaseHeader."Document Type");
            IF PurchaseLine.FINDSET THEN
              REPEAT
                PurchaseLine.ShowShortcutDimCode(ShortcutDimCode);
                ExcelBuffer.NewRow;
                ExcelBuffer.AddColumn(PurchaseLine."Document Type", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."Document No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseHeader."Vendor Invoice No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseHeader."Vendor Authorization No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseHeader."Vendor Cr. Memo No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseHeader."Order Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
                ExcelBuffer.AddColumn(PurchaseHeader."Posting Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
                ExcelBuffer.AddColumn(PurchaseHeader."Document Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
                ExcelBuffer.AddColumn(PurchaseHeader."Buy-from Vendor No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseHeader."Buy-from Vendor Name", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseHeader."Buy-from Vendor Name 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseHeader."Buy-from Address", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseHeader."Buy-from Address 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine.Type, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                ExcelBuffer.AddColumn(PurchaseLine.Description, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."Description 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."Return Reason Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."Location Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine.Quantity, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                ExcelBuffer.AddColumn(PurchaseLine."Unit of Measure Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."Unit of Measure", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                IF PurchaseHeader."Document Type" IN [PurchaseHeader."Document Type"::"Return Order", PurchaseHeader."Document Type"::"Credit Memo"] THEN BEGIN
                  ExcelBuffer.AddColumn(PurchaseLine."Return Qty. to Ship", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                  ExcelBuffer.AddColumn(PurchaseLine."Return Qty. Shipped", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                END ELSE BEGIN
                  ExcelBuffer.AddColumn(PurchaseLine."Qty. to Receive", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                  ExcelBuffer.AddColumn(PurchaseLine."Quantity Received", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                END;
                ExcelBuffer.AddColumn(PurchaseLine."Qty. to Invoice", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                ExcelBuffer.AddColumn(PurchaseLine."Quantity Invoiced", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                CASE TRUE OF
                  INTP.GET(PurchaseLine."INTP No."):
                    BEGIN
                      ExcelBuffer.AddColumn(INTP."No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                      ExcelBuffer.AddColumn(INTP."Customer Name", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                      ExcelBuffer.AddColumn(INTP."Project Name", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                      ExcelBuffer.AddColumn(INTP."P.O No. (Customer)", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                    END;
                  INTP.GET(PurchaseHeader."INTP No."):
                    BEGIN
                      ExcelBuffer.AddColumn(INTP."No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                      ExcelBuffer.AddColumn(INTP."Customer Name", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                      ExcelBuffer.AddColumn(INTP."Project Name", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                      ExcelBuffer.AddColumn(INTP."P.O No. (Customer)", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                    END;
                  ELSE BEGIN
                    ExcelBuffer.AddColumn('', FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                    ExcelBuffer.AddColumn('', FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                    ExcelBuffer.AddColumn('', FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                    ExcelBuffer.AddColumn('', FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                  END;
                END;
                ExcelBuffer.AddColumn(PurchaseLine."Job No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."Job Task No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."VAT Bus. Posting Group", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."VAT Prod. Posting Group", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."Gen. Bus. Posting Group", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."Gen. Prod. Posting Group", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."WHT Business Posting Group", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."WHT Product Posting Group", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."Shortcut Dimension 1 Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine."Shortcut Dimension 2 Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ShortcutDimCode[3], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ShortcutDimCode[4], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ShortcutDimCode[5], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ShortcutDimCode[6], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ShortcutDimCode[7], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(ShortcutDimCode[8], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchaseLine.Status, FALSE, '', TRUE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
              UNTIL PurchaseLine.NEXT = 0;
          UNTIL PurchaseHeader.NEXT = 0;
        END;

        IF ExcelBuffer.FINDSET THEN
          ExcelBuffer.CreateBookAndOpenExcel('',SheetName,'','',USERID);

      END;
    END;

    PROCEDURE ExportRTPSDocumentToExcel@3(VAR RTPSDocument@1000 : Record 50010);
    VAR
      ExcelBuffer@1001 : TEMPORARY Record 370;
    BEGIN
      WITH RTPSDocument DO BEGIN
        IF RTPSDocument.FINDSET THEN BEGIN
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Employee No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Employee Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Customer No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Customer Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Contact No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Contact Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Date Requested"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Project Description"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Project Description 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Opportunity No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Site Survey"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("SSS Expected Date From"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("SSS Expected Date To"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("SSS Actual Date From"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("SSS Actual Date To"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Demo Testing"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("DT Equipment"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("DTS Expected Date From"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("DTS Expected Date To"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("DTS Actual Date From"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("DTS Actual Date To"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("DT Area"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Bill of Materials"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Information of Project"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Date Of Submission', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Time Of Submission', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION(Design), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Target Audience"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Date Of Presentation"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("PP Engineering"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("PP Business / Marketing"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("PP Others"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("PP Others Remarks"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Appropriate Solution Tech"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Recomended Solution / Equip."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Recom. Sol/Equip Remarks"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Stipulated Deadline"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Stipulated Deadline Remarks"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Others Last"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION(Remarks), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION(Timeline), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Scope/Deliverables"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Technical In-charge"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Technical In-charge Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Department Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Receiving Department"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION(Status), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Completed Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RTPSDocument.FIELDCAPTION("Completed By"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);

          REPEAT
            ExcelBuffer.NewRow;
            ExcelBuffer.AddColumn(RTPSDocument."No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Employee No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Employee Name", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Customer No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Customer Name", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Contact No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Contact Name", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Date Requested", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RTPSDocument."Project Description", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Project Description 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Opportunity No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Site Survey", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."SSS Expected Date From", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RTPSDocument."SSS Expected Date To", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RTPSDocument."SSS Actual Date From", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RTPSDocument."SSS Actual Date To", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RTPSDocument."Demo Testing", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."DT Equipment", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."DTS Expected Date From", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RTPSDocument."DTS Expected Date To", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RTPSDocument."DTS Actual Date From", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RTPSDocument."DTS Actual Date To", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RTPSDocument."DT Area", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Bill of Materials", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Information of Project", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Date of Submission to PM/AM", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date); //datetime
            ExcelBuffer.AddColumn(RTPSDocument."Date of Submission to PM/AM", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Time);
            ExcelBuffer.AddColumn(RTPSDocument.Design, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Target Audience", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Date Of Presentation", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RTPSDocument."PP Engineering", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."PP Business / Marketing", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."PP Others", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."PP Others Remarks", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Appropriate Solution Tech", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Recomended Solution / Equip.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Recom. Sol/Equip Remarks", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Stipulated Deadline", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Stipulated Deadline Remarks", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Others Last", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument.Remarks, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument.Timeline, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RTPSDocument."Scope/Deliverables", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Technical In-charge", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Technical In-charge Name", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Department Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Receiving Department", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument.Status, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RTPSDocument."Completed Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RTPSDocument."Completed By", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
          UNTIL RTPSDocument.NEXT = 0;
        END;

        IF ExcelBuffer.FINDSET THEN
          ExcelBuffer.CreateBookAndOpenExcel('','RTPS','','',USERID);

      END;
    END;

    PROCEDURE ExportRFQToExcel@6(VAR RFQ@1000 : Record 50013);
    VAR
      ExcelBuffer@1003 : TEMPORARY Record 370;
      Employee@1002 : Record 5200;
      ReqByName@1001 : Text;
    BEGIN
      WITH RFQ DO BEGIN
        IF RFQ.FINDSET THEN BEGIN
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Document Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Quotation Type"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION(Purpose), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Requested By"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Name', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Job No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("RTPS No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Project Description"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Project Description 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Customer No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Customer Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION(Address), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Address 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Addressee No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION(Addressee), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Addressee Designation"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION(Email), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION(Budget), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Opportunity No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Cost Analyst No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Cost Analyst"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Related RFQ No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Technical Lead No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Technical Lead"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Technology Group Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Technology House"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Client Type Approve"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("NTC Type Approval"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Equipment Freq. Related"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Permit To Import"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Permit To Purchase"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Permit To Possess"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Construction Permit"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Radio Station License"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION(Others), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Repeat Order"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("QTP IsEquipment"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("QTP Equipment"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("QTP IsServices"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("QTP Services"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Competitor 1"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Competitor Price 1"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Competitor 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Competitor Price 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Competitor 3"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Competitor Price 3"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("ASD BOM"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("ASD Design"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("ASD Installation Material"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("ASD Service Engineering"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("ASD Others"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("ASD Others Text"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Bid Submission Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Bid Submission Time"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Timeline of the Project"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Deadline for Submission Date', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Deadline for Submission Time', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION(Remarks), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("If Revised/Cancelled Why"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION(Status), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Completed Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Time Completed', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(RFQ.FIELDCAPTION("Completed By"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          REPEAT
            ReqByName := '';
            IF Employee.GET(RFQ."Requested By") THEN BEGIN
              ReqByName := Employee."First Name" +' '+ Employee."Last Name";
            END;
            ExcelBuffer.NewRow;
            ExcelBuffer.AddColumn(RFQ."No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Document Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RFQ."Quotation Type", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ.Purpose, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Requested By", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ReqByName, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Job No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."RTPS No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Project Description", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Project Description 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Customer No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Customer Name", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ.Address, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Address 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Addressee No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ.Addressee, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Addressee Designation", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ.Email, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ.Budget, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
            ExcelBuffer.AddColumn(RFQ."Opportunity No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Cost Analyst No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Cost Analyst", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Related RFQ No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Technical Lead No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Technical Lead", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Technology Group Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Technology House", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Client Type Approve", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."NTC Type Approval", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Equipment Freq. Related", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Permit To Import", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Permit To Purchase", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Permit To Possess", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Construction Permit", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Radio Station License", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ.Others, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Repeat Order", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."QTP IsEquipment", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."QTP Equipment", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."QTP IsServices", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."QTP Services", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Competitor 1", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Competitor Price 1", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
            ExcelBuffer.AddColumn(RFQ."Competitor 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Competitor Price 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
            ExcelBuffer.AddColumn(RFQ."Competitor 3", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Competitor Price 3", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
            ExcelBuffer.AddColumn(RFQ."ASD BOM", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."ASD Design", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."ASD Installation Material", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."ASD Service Engineering", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."ASD Others", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."ASD Others Text", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Bid Submission Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RFQ."Bid Submission Time", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Timeline of the Project", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(RFQ."Deadline for Submission", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date); //datetime
            ExcelBuffer.AddColumn(RFQ."Deadline for Submission", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Time);
            ExcelBuffer.AddColumn(RFQ.Remarks, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."If Revised/Cancelled Why", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ.Status, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(RFQ."Completed Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date); //datetime
            ExcelBuffer.AddColumn(RFQ."Completed Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Time);
            ExcelBuffer.AddColumn(RFQ."Completed By", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
          UNTIL RFQ.NEXT = 0;
        END;

        IF ExcelBuffer.FINDSET THEN
          ExcelBuffer.CreateBookAndOpenExcel('','Request for Quotation','','',USERID);

      END;
    END;

    PROCEDURE ExportItemLedgerEntryToExcel@4(VAR ItemLedgerEntry@1000 : Record 32);
    VAR
      ExcelBuffer@1001 : TEMPORARY Record 370;
      INTP@1008 : Record 50040;
      PreSales@1002 : Text;
      "INTPNo."@1003 : Text;
      ProjectName@1004 : Text;
      PONumber@1005 : Text;
      SiteName@1006 : Text;
      CustomerName@1007 : Text;
      ProjectName2@1009 : Text;
    BEGIN
      WITH ItemLedgerEntry DO BEGIN
        IF ItemLedgerEntry.FINDSET THEN BEGIN

          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Document Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Posting Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Entry Type"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Document Type"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Document No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Source No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Source Type"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);

          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Purchase Order No"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("External Document No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Item No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Item Description"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION(Description), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Location Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Unit of Measure Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION(Quantity), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Invoiced Quantity"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Remaining Quantity"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Sales Amount (Actual)"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Cost Amount (Actual)"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Cost Amount (Non-Invtbl.)"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION(Open), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Order Type"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Entry No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Warranty Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("RFP Document Type"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("RFP Document No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("RFP Line No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('PRE-SALES CODE', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Global Dimension 1 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Global Dimension 2 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(ItemLedgerEntry.FIELDCAPTION("Order No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('INTP No.', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(INTP.FIELDCAPTION("Project Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(INTP.FIELDCAPTION("Project Name 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(INTP.FIELDCAPTION("P.O No. (Customer)"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(INTP.FIELDCAPTION("Site Names"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(INTP.FIELDCAPTION("Customer Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);


          REPEAT
            ExcelBuffer.NewRow;
            ExcelBuffer.AddColumn(ItemLedgerEntry."Document Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Posting Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Entry Type", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Document Type", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Document No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Source No.",FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry.GetSourceName, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);

            ExcelBuffer.AddColumn(ItemLedgerEntry."Purchase Order No", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."External Document No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Item No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Item Description", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry.Description, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Location Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Unit of Measure Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry.Quantity, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Invoiced Quantity", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Remaining Quantity", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Sales Amount (Actual)", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Cost Amount (Actual)", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Cost Amount (Non-Invtbl.)", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
            ExcelBuffer.AddColumn(ItemLedgerEntry.Open, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Order Type", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Entry No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Warranty Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
            ExcelBuffer.AddColumn(ItemLedgerEntry."RFP Document Type", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."RFP Document No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."RFP Line No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);

            PreSales := '';
      //      DimMgt.GetShortcutDimensions(ItemLedgerEntry."Dimension Set ID", ShortcutDimCode);
      //      IF ShortcutDimCode[3] <>'' THEN
      //        PreSales := ShortcutDimCode[3];

            ExcelBuffer.AddColumn(PreSales, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Global Dimension 1 Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Global Dimension 2 Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ItemLedgerEntry."Order No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);

            "INTPNo." := '';
            ProjectName := '';
            ProjectName2 := '';
            PONumber := '';
            SiteName := '';
            CustomerName := '';

            IF ItemLedgerEntry."Global Dimension 1 Code" <>'' THEN BEGIN
              INTP.RESET;
              INTP.SETRANGE("Global Dimension 1 Code", ItemLedgerEntry."Global Dimension 1 Code");
              IF INTP.FINDFIRST THEN BEGIN
               "INTPNo." := INTP."No.";
                ProjectName := INTP."Project Name";
                ProjectName2 := INTP."Project Name 2";
                PONumber := INTP."P.O No. (Customer)";
                SiteName := INTP."Site Names";
                CustomerName := INTP."Customer Name";
              END;
            END;

            ExcelBuffer.AddColumn("INTPNo.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ProjectName, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(ProjectName2, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(PONumber, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(SiteName, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(CustomerName, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);

          UNTIL ItemLedgerEntry.NEXT = 0;
        END;

        IF ExcelBuffer.FINDSET THEN
          ExcelBuffer.CreateBookAndOpenExcel('','Item Ledger Entry','','',USERID);
      END;
    END;

    PROCEDURE ExportContactForMerging@5(VAR Contact@1006 : Record 5050);
    VAR
      ExcelBuffer@1001 : TEMPORARY Record 370;
      TableRelationship@1000 : Record 52003;
      Object@1008 : Record 2000000001;
      MarketingSetup@1005 : Record 5079;
      ContactBusinessRelation@1011 : Record 5054;
      ContactBusinessRelationTemp@1016 : TEMPORARY Record 5054;
      Customer@1012 : Record 18;
      Vendor@1013 : Record 23;
      Employee@1017 : Record 5200;
      MergeData@1007 : Page 52001;
      TableRelationshipManagement@1010 : Codeunit 50012;
      ContactType@1014 : Text;
      Decision@1009 : Boolean;
      Skip@1015 : Boolean;
      TotalLinkedRecs@1004 : Integer;
      RecRef@1003 : RecordRef;
      FieldRef@1002 : FieldRef;
    BEGIN
      Object.GET(Object.Type::Table, '', DATABASE::Contact);
      MergeData.SetObjectDetails(Object);
      Decision := MergeData.RUNMODAL = ACTION::Yes;

      IF NOT Decision THEN
        EXIT;

      IF MergeData.GetReprocessTableRelationship THEN
        TableRelationshipManagement.ReProcessTableRelationship(Object);

      WITH Contact DO BEGIN
        MarketingSetup.GET;
        IF FINDSET THEN BEGIN
          ConfigProgressBar.Init(COUNT, 1, 'Exporting Contact to Excel');
          ExcelBuffer.AddColumn(Contact.FIELDCAPTION("No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(Contact.FIELDCAPTION(Name), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(Contact.FIELDCAPTION("Name 2"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(Contact.FIELDCAPTION(Type), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(Contact.FIELDCAPTION("Company No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(Contact.FIELDCAPTION("Company Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Contact Type', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          TableRelationship.SETRANGE(Enabled, TRUE);
          TableRelationship.SETRANGE("Primary Table ID", DATABASE::Contact);
          TableRelationship.SETFILTER("Data Type", '<>%1', TableRelationship."Data Type"::BLOB);
          TableRelationship.SETRANGE("Field Class", TableRelationship."Field Class"::Normal);
          IF TableRelationship.FINDSET THEN
            REPEAT
              ExcelBuffer.AddColumn(STRSUBSTNO('%1 (%2)', TableRelationship."Table Name", TableRelationship."Field Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
            UNTIL TableRelationship.NEXT = 0;
          ExcelBuffer.AddColumn('Total Linked Records', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Number);

          REPEAT
            TotalLinkedRecs := 0;
            ContactType := '';
            ConfigProgressBar.Update("No.");
            ExcelBuffer.NewRow;
            ExcelBuffer.AddColumn("No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(Name, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn("Name 2", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn(Type, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn("Company No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ExcelBuffer.AddColumn("Company Name", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            ContactBusinessRelation.SETRANGE("Contact No.", Contact."No.");
            ContactBusinessRelationTemp.DELETEALL;
            IF ContactBusinessRelation.FINDSET THEN
              REPEAT
                ContactBusinessRelationTemp.SETRANGE("Link to Table", ContactBusinessRelation."Link to Table");
                IF NOT ContactBusinessRelationTemp.FINDSET THEN BEGIN
                  ContactType += FORMAT(ContactBusinessRelation."Link to Table") + ',';
                  IF Employee.GET(ContactBusinessRelation."No.") THEN
                    ContactType := 'Employee';
                END ELSE BEGIN
                  ContactBusinessRelationTemp.INIT;
                  ContactBusinessRelationTemp := ContactBusinessRelation;
                  ContactBusinessRelation.INSERT;
                END;
              UNTIL ContactBusinessRelation.NEXT = 0;

              IF STRLEN(ContactType) = 0 THEN
                ContactType := ',';

            ExcelBuffer.AddColumn(COPYSTR(ContactType,1,STRLEN(ContactType)-1), FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
            IF TableRelationship.FINDSET THEN
              REPEAT
                RecRef.OPEN(TableRelationship."Table ID");
                FieldRef := RecRef.FIELD(TableRelationship."Field ID");
                FieldRef.SETRANGE(Contact."No.");
                TotalLinkedRecs += RecRef.COUNT;
                ExcelBuffer.AddColumn(RecRef.COUNT, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                RecRef.CLOSE;
              UNTIL TableRelationship.NEXT = 0;
            ExcelBuffer.AddColumn(TotalLinkedRecs, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
          UNTIL Contact.NEXT = 0;
        END;

        ConfigProgressBar.Close;

        IF ExcelBuffer.FINDSET THEN
          ExcelBuffer.CreateBookAndOpenExcel('','Contacts fo Merging','','',USERID);
      END;
    END;

    PROCEDURE ExportJobOrderLineToExcel@7(VAR JobOrder@1000 : Record 50012);
    VAR
      JobOrderLine@1002 : Record 50551;
      "DefaultOrigin(From)"@1003 : TextConst 'ENU=ONE COMMERCE (INTL.) CORPORATION';
      ExcelBuffer@1001 : TEMPORARY Record 370;
      ActivityName@1007 : Text;
    BEGIN
      WITH JobOrder DO BEGIN
        IF JobOrder.FINDSET THEN BEGIN
          ConfigProgressBar.Init(COUNT, 1, 'Exporting Mobilization Data to Excel');
          ExcelBuffer.AddColumn(JobOrder.FIELDCAPTION("No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Activity', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(JobOrder.FIELDCAPTION(Department), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Vehicle Type', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Origin(From)', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Destination(To)', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Tye of Request', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);

          REPEAT
            ConfigProgressBar.Update("No.");
            IF JobOrder.Status = JobOrder.Status::Released THEN BEGIN

              // Initialization of Activity
              CLEAR(ActivityName);
              IF JobOrder.Meeting THEN
                ActivityName += ',' + JobOrder.FIELDCAPTION(Meeting);
              IF JobOrder."Site Survey" THEN
                ActivityName += ',' + JobOrder.FIELDCAPTION("Site Survey");
              IF JobOrder.Permitting THEN
                ActivityName += ',' + JobOrder.FIELDCAPTION(Permitting);
              IF JobOrder."Installation and Commissioning" THEN
                ActivityName += ',' + JobOrder.FIELDCAPTION("Installation and Commissioning");
              IF JobOrder.Testing THEN
                ActivityName += ',' + JobOrder.FIELDCAPTION(Testing);
              IF JobOrder."Preliminary Acceptance" THEN
                ActivityName += ',' + JobOrder.FIELDCAPTION("Preliminary Acceptance");
              IF JobOrder."Final Acceptance" THEN
                ActivityName += ',' + JobOrder.FIELDCAPTION("Final Acceptance");
              IF JobOrder.Rectification THEN
                ActivityName += ',' + JobOrder.FIELDCAPTION(Rectification);
              IF JobOrder.Troubleshooting THEN
                ActivityName += ',' + JobOrder.FIELDCAPTION(Troubleshooting);


              JobOrderLine.SETRANGE("Job Order No.", JobOrder."No.");
              IF JobOrderLine.FINDSET THEN BEGIN
                REPEAT
                  ExcelBuffer.NewRow;
                  ExcelBuffer.AddColumn(JobOrder."No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                  ExcelBuffer.AddColumn(ActivityName, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                  ExcelBuffer.AddColumn(JobOrder.Department, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                  ExcelBuffer.AddColumn('', FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                  CASE JobOrderLine."Line Type" OF
                    JobOrderLine."Line Type"::"Car Request":
                      BEGIN
                        ExcelBuffer.AddColumn("DefaultOrigin(From)", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                        ExcelBuffer.AddColumn(JobOrderLine.Destination, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                      END;
                    JobOrderLine."Line Type"::"Public Transpo Request":
                      BEGIN
                        ExcelBuffer.AddColumn(JobOrderLine."Destination From", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                        ExcelBuffer.AddColumn(JobOrderLine."Destination To", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                      END;
                    JobOrderLine."Line Type"::"Airplane Ticket Request":
                      BEGIN
                        ExcelBuffer.AddColumn("DefaultOrigin(From)", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                        ExcelBuffer.AddColumn(JobOrderLine."Destination Airport", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                      END;
                    ELSE
                      BEGIN
                        ExcelBuffer.AddColumn('', FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                        ExcelBuffer.AddColumn('', FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                      END;
                  END;
                  ExcelBuffer.AddColumn(JobOrderLine."Line Type", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                UNTIL JobOrderLine.NEXT = 0;
              END;
            END;


          UNTIL JobOrder.NEXT = 0;

        END;

        ConfigProgressBar.Close;

        IF ExcelBuffer.FINDSET THEN
          ExcelBuffer.CreateBookAndOpenExcel('','Job Order','','',USERID);
      END;
    END;

    PROCEDURE ExportPostedCALinesToExcel@8(VAR PurchInvHeader@1000 : Record 122);
    VAR
      ExcelBuffer@1001 : TEMPORARY Record 370;
      PurchInvLine@1002 : Record 123;
      Item@1005 : Record 27;
      GLAccount@1003 : Record 15;
      MasterName@1004 : Text;
      I@1006 : Integer;
    BEGIN
      WITH PurchInvHeader DO BEGIN
        IF PurchInvHeader.FINDSET THEN BEGIN

          ConfigProgressBar.Init(COUNT, 1, 'Exporting Posted Cash Advance Lines Data to Excel');
          ExcelBuffer.AddColumn(PurchInvHeader.FIELDCAPTION("Document Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvHeader.FIELDCAPTION("Posting Date"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvHeader.FIELDCAPTION("Buy-from Vendor No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvHeader.FIELDCAPTION("Buy-from Vendor Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvHeader.FIELDCAPTION("Pay-to Vendor No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvHeader.FIELDCAPTION("Pay-to Name"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvLine.FIELDCAPTION(Type), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvHeader.FIELDCAPTION("No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvHeader.FIELDCAPTION("Vendor Invoice No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn('Masterfile Name', FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvLine.FIELDCAPTION(Description), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvLine.FIELDCAPTION(Quantity), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvLine.FIELDCAPTION("Direct Unit Cost"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvLine.FIELDCAPTION("Line Amount"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvHeader.FIELDCAPTION("INTP No."), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvLine.FIELDCAPTION("Shortcut Dimension 1 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
          ExcelBuffer.AddColumn(PurchInvLine.FIELDCAPTION("Shortcut Dimension 2 Code"), FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);

      //    GetGLSetup;
      // // //    FOR I := 3 TO 8 DO BEGIN
      // // //      ExcelBuffer.AddColumn(GLSetupShortcutDimCode[I], FALSE, '', TRUE, FALSE, TRUE, '', ExcelBuffer."Cell Type"::Text);
      // // //    END;

          REPEAT

            ConfigProgressBar.Update("No.");

            PurchInvLine.RESET;
            PurchInvLine.SETRANGE("Document No.", PurchInvHeader."No.");
            IF PurchInvLine.FINDSET THEN BEGIN
              REPEAT

                CLEAR(MasterName);
                CASE PurchInvLine.Type OF
                  PurchInvLine.Type::"G/L Account":
                    BEGIN
                      GLAccount.GET(PurchInvLine."No.");
                      MasterName := GLAccount.Name;
                    END;
                  PurchInvLine.Type::Item:
                    BEGIN
                      Item.GET(PurchInvLine."No.");
                      MasterName := Item.Description + ' ' + Item."Description 2";
                    END;
                END;

                // Get Dimensions
      //          DimMgt.GetShortcutDimensions(PurchInvLine."Dimension Set ID", ShortcutDimCode);

                ExcelBuffer.NewRow;
                ExcelBuffer.AddColumn(PurchInvHeader."Document Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
                ExcelBuffer.AddColumn(PurchInvHeader."Posting Date", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Date);
                ExcelBuffer.AddColumn(PurchInvHeader."Buy-from Vendor No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(STRSUBSTNO('%1 %2', PurchInvHeader."Buy-from Vendor Name", PurchInvHeader."Buy-from Vendor Name 2"), FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchInvHeader."Pay-to Vendor No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(STRSUBSTNO('%1 %2', PurchInvHeader."Pay-to Name", PurchInvHeader."Pay-to Name 2"), FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchInvLine.Type, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchInvHeader."No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchInvHeader."Vendor Invoice No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(MasterName, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchInvLine.Description, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchInvLine.Quantity, FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                ExcelBuffer.AddColumn(PurchInvLine."Direct Unit Cost", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                ExcelBuffer.AddColumn(PurchInvLine."Line Amount", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Number);
                ExcelBuffer.AddColumn(PurchInvHeader."INTP No.", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchInvLine."Shortcut Dimension 1 Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
                ExcelBuffer.AddColumn(PurchInvLine."Shortcut Dimension 2 Code", FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);

      //          FOR I := 3 TO 8 DO BEGIN
      //            ExcelBuffer.AddColumn(ShortcutDimCode[I], FALSE, '', FALSE, FALSE, FALSE, '', ExcelBuffer."Cell Type"::Text);
      //          END;

              UNTIL PurchInvLine.NEXT = 0;
            END;

          UNTIL PurchInvHeader.NEXT = 0;
        END;

        ConfigProgressBar.Close;

        IF ExcelBuffer.FINDSET THEN
          ExcelBuffer.CreateBookAndOpenExcel('','Posted Cash Advance Lines','','',USERID);
      END;
    END;

    PROCEDURE ImportGeneralJournalLines@9(JournalTemplateName@1006 : Code[20];JournalBatchName@1009 : Code[20]);
    VAR
      ExcelBuffer@1004 : TEMPORARY Record 370;
      ExcelBufferColumn@1007 : TEMPORARY Record 370;
      ExcelBufferLastRow@1015 : TEMPORARY Record 370;
      ExcelBufferDims@1023 : TEMPORARY Record 370;
      GenJournalLine@1008 : Record 81;
      GenJournalLine2@1012 : Record 81;
      GenJournalBatch@1011 : Record 232;
      GenJournalTemplate@1010 : Record 80;
      Field@1013 : Record 2000000041;
      Dimension@1024 : Record 348;
      GeneralLedgerSetup@1027 : Record 98;
      FileManagement@1001 : Codeunit 419;
      DimensionManagement@1025 : Codeunit 408;
      RecReference@1018 : RecordRef;
      FieldReference@1019 : FieldRef;
      DimCode@1021 : Code[20];
      FieldPriority@1014 : Text;
      ServerFileName@1000 : Text;
      SheetName@1005 : Text;
      ExcelExt@1003 : Text;
      CloseAction@1002 : Boolean;
      i@1016 : Integer;
      FieldNo@1020 : Integer;
      ExcelLastRow@1017 : Integer;
      TempDate@1022 : Date;
    BEGIN
      GenJournalBatch.GET(JournalTemplateName, JournalBatchName);
      GenJournalTemplate.GET(GenJournalBatch."Journal Template Name");

      ServerFileName := FileManagement.UploadFile('Upload Journal Entries', '.xlsx');
      IF ServerFileName = '' THEN
        EXIT;

      SheetName := ExcelBuffer.SelectSheetsName(ServerFileName);
      IF SheetName = '' THEN
        EXIT;

      ExcelBuffer.LOCKTABLE;
      ExcelBuffer.OpenBook(ServerFileName, SheetName);
      ExcelBuffer.ReadSheet;

      ExcelBufferColumn.COPY(ExcelBuffer, TRUE);
      ExcelBufferColumn.SETRANGE("Row No.", 1); // Filter table header
      IF ExcelBufferColumn.FINDSET THEN // Get only the valid column from the imported excel
        REPEAT
          Field.SETRANGE(TableNo, DATABASE::"Gen. Journal Line");
          Field.SETRANGE("Field Caption", ExcelBufferColumn."Cell Value as Text");
          IF Field.FINDFIRST THEN BEGIN
            ExcelBufferColumn."Cell Value as Text" := FORMAT(Field."No.");
            ExcelBufferColumn.MODIFY;
            ExcelBufferColumn.MARK(TRUE);
          END;
        UNTIL ExcelBufferColumn.NEXT = 0;
      ExcelBufferColumn.MARKEDONLY(TRUE);


      // Get the last row of excel from ExcelBuffer
      ExcelBufferLastRow.COPY(ExcelBuffer, TRUE);
      ExcelBufferLastRow.FINDLAST;
      ExcelLastRow := ExcelBufferLastRow."Row No.";

      // Get the dimension column
      ExcelBufferDims.COPY(ExcelBuffer, TRUE);
      ExcelBufferDims.SETRANGE("Row No.", 1);
      Dimension.SETRANGE(Blocked, FALSE);
      IF Dimension.FINDSET THEN
        REPEAT
          ExcelBufferDims.SETRANGE("Cell Value as Text", Dimension."Code Caption");
          IF ExcelBufferDims.FINDFIRST THEN BEGIN
            ExcelBufferDims."Cell Value as Text" := Dimension.Code;
            ExcelBufferDims.MODIFY;
            ExcelBufferDims.MARK(TRUE);
          END;
        UNTIL Dimension.NEXT = 0;
      ExcelBufferDims.SETRANGE("Cell Value as Text");
      ExcelBufferDims.MARKEDONLY(TRUE);

      GeneralLedgerSetup.GET;

      ConfigProgressBar.Init(ExcelBufferLastRow."Row No.", 1, STRSUBSTNO('Importing %1 Excel Records', ExcelLastRow));
      FOR i := 2 TO ExcelBufferLastRow."Row No." DO BEGIN
        // Journal Entries
        GenJournalLine2.SETRANGE("Journal Template Name", GenJournalBatch."Journal Template Name");
        GenJournalLine2.SETRANGE("Journal Batch Name", GenJournalBatch.Name);

        GenJournalLine.INIT;
        GenJournalLine.VALIDATE("Journal Template Name", GenJournalBatch."Journal Template Name");
        GenJournalLine.VALIDATE("Journal Batch Name", GenJournalBatch.Name);
        GenJournalLine.VALIDATE("Source Code", GenJournalTemplate."Source Code");

        IF GenJournalLine2.FINDLAST THEN
          GenJournalLine."Line No." := GenJournalLine2."Line No." + 10000
        ELSE
          GenJournalLine."Line No." := 10000;

        GenJournalLine.INSERT(TRUE);

        // Update table columns based from excel header
        IF ExcelBufferColumn.FINDSET THEN BEGIN
          RecReference.GETTABLE(GenJournalLine);
          REPEAT
            FieldNo := 0;
            EVALUATE(FieldNo, ExcelBufferColumn."Cell Value as Text");
            FieldReference := RecReference.FIELD(FieldNo);
            IF ExcelBuffer.GET(i, ExcelBufferColumn."Column No.") THEN BEGIN
              EVALUATE(FieldReference, ExcelBuffer."Cell Value as Text");
            END ELSE BEGIN
              CASE UPPERCASE(FORMAT(FieldReference.TYPE)) OF
                'CODE', 'TEXT':
                  FieldReference.VALUE := '';
                'DATE':
                  FieldReference.VALUE := 0D;
                'TIME':
                  FieldReference.VALUE := 0T;
              END;
            END;
            IF FieldNo IN [5,76,4,11,58,59,65,66,90,91,92,93,50500,50501,48,35,12,1009,42, 1001,1004] THEN
              FieldReference.VALIDATE;
          RecReference.MODIFY(TRUE);
          UNTIL ExcelBufferColumn.NEXT = 0;
        END;

        // Update dimensions
        IF ExcelBufferDims.FINDSET THEN BEGIN
          RecReference.SETTABLE(GenJournalLine);
          REPEAT
            CLEAR(DimCode);
            IF ExcelBuffer.GET(i, ExcelBufferDims."Column No.") THEN BEGIN
              EVALUATE(DimCode, ExcelBuffer."Cell Value as Text");
              CASE TRUE OF
                (ExcelBufferDims."Cell Value as Text" = GeneralLedgerSetup."Global Dimension 1 Code"):
                  GenJournalLine.VALIDATE("Shortcut Dimension 1 Code", DimCode);
                (ExcelBufferDims."Cell Value as Text" = GeneralLedgerSetup."Global Dimension 2 Code"):
                  GenJournalLine.VALIDATE("Shortcut Dimension 2 Code", DimCode);
                (ExcelBufferDims."Cell Value as Text" = GeneralLedgerSetup."Shortcut Dimension 3 Code"):
                  GenJournalLine.ValidateShortcutDimCode(3,DimCode);
                (ExcelBufferDims."Cell Value as Text" = GeneralLedgerSetup."Shortcut Dimension 4 Code"):
                  GenJournalLine.ValidateShortcutDimCode(4,DimCode);
                (ExcelBufferDims."Cell Value as Text" = GeneralLedgerSetup."Shortcut Dimension 5 Code"):
                  GenJournalLine.ValidateShortcutDimCode(5,DimCode);
                (ExcelBufferDims."Cell Value as Text" = GeneralLedgerSetup."Shortcut Dimension 6 Code"):
                  GenJournalLine.ValidateShortcutDimCode(6,DimCode);
                (ExcelBufferDims."Cell Value as Text" = GeneralLedgerSetup."Shortcut Dimension 7 Code"):
                  GenJournalLine.ValidateShortcutDimCode(7,DimCode);
                (ExcelBufferDims."Cell Value as Text" = GeneralLedgerSetup."Shortcut Dimension 8 Code"):
                  GenJournalLine.ValidateShortcutDimCode(8,DimCode);
              END;
              GenJournalLine.MODIFY(TRUE);
            END;
          UNTIL ExcelBufferDims.NEXT = 0;
        END;

      //  GenJournalLine.MODIFY(TRUE);
        ConfigProgressBar.Update(STRSUBSTNO('Excel row %1', i));
      END;
      ConfigProgressBar.Close;
    END;

    BEGIN
    END.
  }
}

