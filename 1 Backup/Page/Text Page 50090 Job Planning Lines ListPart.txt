OBJECT Page 50090 Job Planning Lines ListPart
{
  OBJECT-PROPERTIES
  {
    Date=08/27/18;
    Time=10:00:22 PM;
    Modified=Yes;
    Version List=OC.03.50500;
  }
  PROPERTIES
  {
    CaptionML=ENU=Job Planning Lines;
    SourceTable=Table1003;
    DataCaptionExpr=Caption;
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             "Unit CostEditable" := TRUE;
             "Line AmountEditable" := TRUE;
             "Line Discount %Editable" := TRUE;
             "Line Discount AmountEditable" := TRUE;
             "Unit PriceEditable" := TRUE;
             "Work Type CodeEditable" := TRUE;
             "Location CodeEditable" := TRUE;
             "Variant CodeEditable" := TRUE;
             "Unit of Measure CodeEditable" := TRUE;
             DescriptionEditable := TRUE;
             "No.Editable" := TRUE;
             TypeEditable := TRUE;
             "Document No.Editable" := TRUE;
             "Currency DateEditable" := TRUE;
             "Planning DateEditable" := TRUE;

             "Job Task No.Visible" := TRUE;
           END;

    OnOpenPage=VAR
                 Job@1000 : Record 167;
               BEGIN
                 IF Job.GET(JobNo) THEN
                   CurrPage.EDITABLE(NOT (Job.Blocked = Job.Blocked::All));

                 // IF Job.GET(JobNo) THEN
                 //   CurrPage.EDITABLE(NOT (Job."Job Status" <> Job."Job Status"::" "));

                 IF ActiveField = 1 THEN;
                 IF ActiveField = 2 THEN;
                 IF ActiveField = 3 THEN;
                 IF ActiveField = 4 THEN;
               END;

    OnNewRecord=BEGIN
                  SetUpNewLine(xRec);
                END;

    OnInsertRecord=BEGIN
                     // PHP Start
                     LockJobDoc;
                     // PHP Start
                   END;

    OnModifyRecord=BEGIN
                     IF "System-Created Entry" THEN BEGIN
                       IF CONFIRM(Text001,FALSE) THEN
                         "System-Created Entry" := FALSE
                       ELSE
                         ERROR('');
                     END;
                   END;

    OnDeleteRecord=BEGIN
                     // PHP Start
                     LockJobDoc;
                     // PHP Start
                   END;

    OnAfterGetCurrRecord=BEGIN
                           SetEditable("Qty. Transferred to Invoice" = 0);
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 48      ;1   ;Action    ;
                      Name=ChangeLogs;
                      CaptionML=ENU=Change Logs;
                      PromotedIsBig=Yes;
                      Image=ChangeLog;
                      OnAction=VAR
                                 ChangeLogPage@1000 : Page 595;
                                 TableIds@1001 : Text;
                                 JobNoLocal@1002 : Text;
                                 JobTaskNoLocal@1003 : Text;
                                 JobPlanningLineNoLocal@1004 : Text;
                               BEGIN
                                 TableIds := FORMAT(DATABASE::"Job Planning Line");
                                 JobNoLocal := FORMAT("Job No.");
                                 JobTaskNoLocal := FORMAT("Job Task No.");
                                 JobPlanningLineNoLocal := FORMAT("Line No.");
                                 ChangeLogPage.SetFilterJobPlanningLines(TableIds,JobNoLocal,JobTaskNoLocal,JobPlanningLineNoLocal);
                                 ChangeLogPage.RUN;
                               END;
                                }
      { 72      ;1   ;Action    ;
                      Name=Card;
                      CaptionML=ENU=Card;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      OnAction=VAR
                                 Item_@1000 : Record 27;
                                 Resource_@1001 : Record 156;
                                 GL_@1002 : Record 15;
                               BEGIN
                                 CASE Type OF
                                   Type::Item:
                                     BEGIN
                                       IF ("No." <> '') AND Item_.GET("No.") THEN BEGIN
                                         PAGE.RUN(PAGE::"Item Card",Item_);
                                       END;
                                     END;
                                   Type::Resource:
                                     BEGIN
                                         IF ("No." <> '') AND Resource_.GET("No.") THEN BEGIN
                                         PAGE.RUN(PAGE::"Resource Card",Resource_);
                                       END;
                                     END;
                                   Type::"G/L Account":
                                     BEGIN
                                       IF ("No." <> '') AND GL_.GET("No.") THEN BEGIN
                                         PAGE.RUN(PAGE::"G/L Account Card",GL_);
                                       END;
                                     END;
                                 END;
                               END;
                                }
      { 127     ;1   ;ActionGroup;
                      CaptionML=ENU=Job Planning &Line;
                      Image=Line }
      { 129     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Linked Job Ledger E&ntries;
                      Image=JobLedger;
                      OnAction=VAR
                                 JobLedgerEntry@1001 : Record 169;
                                 JobUsageLink@1000 : Record 1020;
                               BEGIN
                                 JobUsageLink.SETRANGE("Job No.","Job No.");
                                 JobUsageLink.SETRANGE("Job Task No.","Job Task No.");
                                 JobUsageLink.SETRANGE("Line No.","Line No.");

                                 IF JobUsageLink.FINDSET THEN
                                   REPEAT
                                     JobLedgerEntry.GET(JobUsageLink."Entry No.");
                                     JobLedgerEntry.MARK := TRUE;
                                   UNTIL JobUsageLink.NEXT = 0;

                                 JobLedgerEntry.MARKEDONLY(TRUE);
                                 PAGE.RUN(PAGE::"Job Ledger Entries",JobLedgerEntry);
                               END;
                                }
      { 128     ;2   ;Action    ;
                      AccessByPermission=TableData 27=R;
                      CaptionML=ENU=&Reservation Entries;
                      Image=ReservationLedger;
                      OnAction=BEGIN
                                 ShowReservationEntries(TRUE);
                               END;
                                }
      { 133     ;2   ;Separator  }
      { 134     ;2   ;Action    ;
                      Name=OrderPromising;
                      CaptionML=ENU=Order &Promising;
                      Image=OrderPromising;
                      OnAction=BEGIN
                                 ShowOrderPromisingLine;
                               END;
                                }
      { 39      ;1   ;ActionGroup;
                      CaptionML=ENU=Planning }
      { 40      ;2   ;Action    ;
                      CaptionML=ENU=Resource Job Capacity;
                      RunObject=Page 50077;
                      RunPageOnRec=No;
                      PromotedIsBig=Yes;
                      Image=Capacity }
      { 91      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions;
                      Image=Action }
      { 19      ;2   ;Action    ;
                      Name=CreateJobJournalLines;
                      CaptionML=ENU=Create Job &Journal Lines;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 JobPlanningLine@1002 : Record 1003;
                                 JobJnlLine@1004 : Record 210;
                                 JobTransferLine@1000 : Codeunit 1004;
                                 JobTransferJobPlanningLine@1003 : Page 1014;
                               BEGIN
                                 IF JobTransferJobPlanningLine.RUNMODAL = ACTION::OK THEN BEGIN
                                   JobPlanningLine.COPY(Rec);
                                   CurrPage.SETSELECTIONFILTER(JobPlanningLine);

                                   IF JobPlanningLine.FINDSET THEN
                                     REPEAT
                                       JobTransferLine.FromPlanningLineToJnlLine(
                                         JobPlanningLine,JobTransferJobPlanningLine.GetPostingDate,JobTransferJobPlanningLine.GetJobJournalTemplateName,
                                         JobTransferJobPlanningLine.GetJobJournalBatchName,JobJnlLine);
                                     UNTIL JobPlanningLine.NEXT = 0;

                                   CurrPage.UPDATE(FALSE);
                                   MESSAGE(Text002,JobPlanningLine.TABLECAPTION,JobJnlLine.TABLECAPTION);
                                 END;
                               END;
                                }
      { 14      ;2   ;Action    ;
                      CaptionML=ENU=&Open Job Journal;
                      RunObject=Page 201;
                      RunPageLink=Job No.=FIELD(Job No.),
                                  Job Task No.=FIELD(Job Task No.);
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 16      ;2   ;Separator  }
      { 79      ;2   ;Action    ;
                      CaptionML=ENU=Withdraw All Item;
                      Visible=false;
                      Image=PostOrder;
                      OnAction=VAR
                                 JobPlanningLinesLcl@1000 : Record 1003;
                               BEGIN
                                 JobPlanningLinesLcl.RESET;
                                 JobPlanningLinesLcl.COPY(Rec);
                                 CODEUNIT.RUN(CODEUNIT::"Job Withdrawal Mgt.", JobPlanningLinesLcl);
                               END;
                                }
      { 77      ;2   ;Action    ;
                      CaptionML=ENU=Create Withdrawal;
                      Image=PostOrder;
                      OnAction=VAR
                                 JobPlanningLinesLcl@1000 : Record 1003;
                               BEGIN
                                 JobPlanningLinesLcl.RESET;
                                 JobPlanningLinesLcl.COPY(Rec);
                                 CurrPage.SETSELECTIONFILTER(JobPlanningLinesLcl);
                                 CODEUNIT.RUN(CODEUNIT::"Job Withdrawal Mgt.", JobPlanningLinesLcl);
                               END;
                                }
      { 75      ;2   ;Action    ;
                      CaptionML=ENU=Open Withdrawal;
                      Image=Journals;
                      OnAction=VAR
                                 SalesLine@1000 : Record 37;
                               BEGIN
                                 OpenWithdrawalTERF(Rec, SalesLine."Request type"::Withdrawal);
                               END;
                                }
      { 50      ;2   ;Separator  }
      { 46      ;2   ;Action    ;
                      CaptionML=ENU=TERF All Items;
                      Visible=FALSE;
                      Image=PostOrder;
                      OnAction=VAR
                                 JobPlanningLinesLcl@1000 : Record 1003;
                               BEGIN
                                 JobPlanningLinesLcl.RESET;
                                 JobPlanningLinesLcl.COPY(Rec);
                                 CODEUNIT.RUN(CODEUNIT::"Job TERF Mgt.", JobPlanningLinesLcl);
                               END;
                                }
      { 44      ;2   ;Action    ;
                      CaptionML=ENU=Create Tools & Equipment Requisition Form;
                      Visible=FALSE;
                      Image=PostOrder;
                      OnAction=VAR
                                 JobPlanningLinesLcl@1000 : Record 1003;
                               BEGIN
                                 JobPlanningLinesLcl.RESET;
                                 JobPlanningLinesLcl.COPY(Rec);
                                 CurrPage.SETSELECTIONFILTER(JobPlanningLinesLcl);
                                 CODEUNIT.RUN(CODEUNIT::"Job TERF Mgt.", JobPlanningLinesLcl);
                               END;
                                }
      { 42      ;2   ;Action    ;
                      CaptionML=ENU=Open Tools & Equipment Requisition Form;
                      Visible=FALSE;
                      Image=Journals;
                      OnAction=VAR
                                 SalesLine@1000 : Record 37;
                               BEGIN
                                 OpenWithdrawalTERF(Rec, SalesLine."Request type"::"Tools & Equipment Requisition");
                               END;
                                }
      { 88      ;2   ;Separator  }
      { 87      ;2   ;Action    ;
                      CaptionML=ENU=Cash Advance All Items;
                      Visible=false;
                      Image=PostOrder;
                      OnAction=VAR
                                 JobPlanningLinesLcl@1000 : Record 1003;
                               BEGIN
                                 JobPlanningLinesLcl.RESET;
                                 JobPlanningLinesLcl.COPY(Rec);
                                 CODEUNIT.RUN(CODEUNIT::"Job Cash Advance Mgt.", JobPlanningLinesLcl);
                               END;
                                }
      { 85      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Cash Advance;
                      Promoted=Yes;
                      Image=CreditMemo;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 JobRFPayMgt@1000 : Codeunit 50558;
                                 JobPlanningLine@1001 : Record 1003;
                                 PurchHeader@1002 : Record 38;
                               BEGIN
                                 TESTFIELD("Line No.");
                                 JobPlanningLine.COPY(Rec);
                                 CurrPage.SETSELECTIONFILTER(JobPlanningLine);
                                 JobRFPayMgt.CreatePurchaseInvoice(JobPlanningLine, PurchHeader."Request Type"::"Cash Advance");
                               END;
                                }
      { 83      ;2   ;Action    ;
                      CaptionML=ENU=Open Cash Advance;
                      Image=Journals;
                      OnAction=VAR
                                 PurchLine@1000 : Record 39;
                               BEGIN
                                 OpenPurchaseHeader(Rec, PurchLine."Request Type"::"Cash Advance");
                               END;
                                }
      { 81      ;2   ;Separator  }
      { 71      ;2   ;Action    ;
                      CaptionML=ENU=Request for Payment All Items;
                      Visible=false;
                      Image=PostOrder;
                      OnAction=VAR
                                 JobPlanningLinesLcl@1000 : Record 1003;
                               BEGIN
                                 JobPlanningLinesLcl.RESET;
                                 JobPlanningLinesLcl.COPY(Rec);
                                 CODEUNIT.RUN(CODEUNIT::"Job RFPayment Mgt.", JobPlanningLinesLcl);
                               END;
                                }
      { 70      ;2   ;Action    ;
                      Name=CreateRequestForPayment;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Request for Payment;
                      Promoted=Yes;
                      Image=CreditMemo;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 JobRFPayMgt@1000 : Codeunit 50558;
                                 JobPlanningLine@1001 : Record 1003;
                                 PurchHeader@1002 : Record 38;
                               BEGIN
                                 TESTFIELD("Line No.");
                                 JobPlanningLine.COPY(Rec);
                                 CurrPage.SETSELECTIONFILTER(JobPlanningLine);
                                 JobRFPayMgt.CreatePurchaseInvoice(JobPlanningLine, PurchHeader."Request Type"::"Request for Payment");
                               END;
                                }
      { 68      ;2   ;Action    ;
                      Name=OpenRequestForPayment;
                      CaptionML=ENU=Open Request for Payment;
                      Image=Journals;
                      OnAction=VAR
                                 PurchLine@1000 : Record 39;
                               BEGIN
                                 OpenPurchaseHeader(Rec, PurchLine."Request Type"::"Request for Payment");
                               END;
                                }
      { 57      ;2   ;Separator  }
      { 51      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create &Sales Invoice;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Invoice;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateSalesInvoice(FALSE);
                               END;
                                }
      { 60      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Sales &Credit Memo;
                      Promoted=Yes;
                      Image=CreditMemo;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateSalesInvoice(TRUE);
                               END;
                                }
      { 69      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Sales &Invoices/Credit Memos;
                      Promoted=Yes;
                      Image=GetSourceDoc;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 JobCreateInvoice.GetJobPlanningLineInvoices(Rec);
                               END;
                                }
      { 123     ;2   ;Separator  }
      { 124     ;2   ;Action    ;
                      Name=Reserve;
                      Ellipsis=Yes;
                      CaptionML=ENU=&Reserve;
                      Image=Reserve;
                      OnAction=BEGIN
                                 ShowReservation;
                               END;
                                }
      { 132     ;2   ;Action    ;
                      CaptionML=ENU=Order &Tracking;
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 ShowTracking;
                               END;
                                }
      { 130     ;2   ;Separator  }
      { 131     ;2   ;Action    ;
                      Name=DemandOverview;
                      CaptionML=ENU=&Demand Overview;
                      Image=Forecast;
                      OnAction=VAR
                                 DemandOverview@1000 : Page 5830;
                               BEGIN
                                 DemandOverview.SetCalculationParameter(TRUE);

                                 DemandOverview.Initialize(0D,3,"Job No.",'','');
                                 DemandOverview.RUNMODAL;
                               END;
                                }
      { 38      ;2   ;Action    ;
                      Name=InsertExtdTxt;
                      CaptionML=ENU=Insert Ext. Txt.;
                      OnAction=VAR
                                 JobPlanningLine@1000 : Record 1003;
                                 TmpExtTextLine@1003 : TEMPORARY Record 280;
                                 ExtendedLine@1007 : Record 280;
                                 NextLineNo@1002 : Integer;
                                 LineSpacing@1001 : Integer;
                                 MakeUpdateRequired@1005 : Boolean;
                                 AutoText@1004 : Boolean;
                                 Objects@1006 : Record 2000000001;
                               BEGIN
                                 JobPlanningLine.RESET;
                                 JobPlanningLine.SETRANGE("Job No.", Rec."Job No.");
                                 JobPlanningLine.SETRANGE("Job Task No.", Rec."Job Task No.");
                                 JobPlanningLine := Rec;

                                 IF JobPlanningLine.FIND('>') THEN BEGIN
                                   ExtendedLine.SETRANGE("No.", Rec."No.");
                                   LineSpacing :=
                                     (JobPlanningLine."Line No." - Rec."Line No.") DIV
                                     (1 + ExtendedLine.COUNT);
                                   IF LineSpacing = 0 THEN
                                     ERROR('error');
                                   END ELSE
                                   LineSpacing := 10000;
                                 NextLineNo := Rec."Line No." + LineSpacing;

                                 ExtendedLine.SETRANGE("No.", Rec."No.");
                                 IF ExtendedLine.FIND('-') THEN BEGIN
                                   REPEAT
                                     JobPlanningLine.INIT;
                                     JobPlanningLine."Job No." := Rec."Job No.";
                                     JobPlanningLine."Job Task No." := Rec."Job Task No.";
                                     JobPlanningLine."Line No." := NextLineNo;
                                     JobPlanningLine.Type := JobPlanningLine.Type::Text;
                                     NextLineNo := NextLineNo + LineSpacing;
                                     JobPlanningLine.Description := ExtendedLine.Text;
                                     JobPlanningLine."Attached to Line No." := Rec."Line No.";
                                     JobPlanningLine.INSERT(TRUE);
                                   UNTIL ExtendedLine.NEXT = 0;
                                   MakeUpdateRequired := TRUE;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 35  ;2   ;Field     ;
                SourceExpr="Job Task No.";
                Visible="Job Task No.Visible";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 73  ;2   ;Field     ;
                Lookup=No;
                DrillDown=No;
                SourceExpr="Job Task";
                Visible=false;
                LookupPageID=Page0;
                DrillDownPageID=Page0 }

    { 4   ;2   ;Field     ;
                SourceExpr="Line Type";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 98  ;2   ;Field     ;
                SourceExpr="Usage Link";
                Visible=FALSE;
                OnValidate=BEGIN
                             UsageLinkOnAfterValidate;
                             LockJobDoc;
                           END;
                            }

    { 7   ;2   ;Field     ;
                SourceExpr="Planning Date";
                Editable="Planning DateEditable";
                OnValidate=BEGIN
                             PlanningDateOnAfterValidate;
                             LockJobDoc;
                           END;
                            }

    { 3   ;2   ;Field     ;
                SourceExpr="Planned Delivery Date";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 76  ;2   ;Field     ;
                SourceExpr="Currency Date";
                Visible=FALSE;
                Editable="Currency DateEditable";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 9   ;2   ;Field     ;
                SourceExpr="Document No.";
                Editable="Document No.Editable";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 49  ;2   ;Field     ;
                SourceExpr="Line No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 13  ;2   ;Field     ;
                SourceExpr=Type;
                Editable=TypeEditable;
                OnValidate=BEGIN
                             NoOnAfterValidate;
                             LockJobDoc;
                           END;
                            }

    { 23  ;2   ;Field     ;
                SourceExpr="No.";
                Editable="No.Editable";
                OnValidate=BEGIN
                             NoOnAfterValidate;
                             LockJobDoc;
                           END;
                            }

    { 29  ;2   ;Field     ;
                SourceExpr="Part No.";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 11  ;2   ;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 78  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 80  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 82  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE;
                Editable="Variant CodeEditable";
                OnValidate=BEGIN
                             VariantCodeOnAfterValidate;
                             LockJobDoc;
                           END;
                            }

    { 65  ;2   ;Field     ;
                SourceExpr="Location Code";
                Editable="Location CodeEditable";
                OnValidate=BEGIN
                             LocationCodeOnAfterValidate;
                             LockJobDoc;
                           END;
                            }

    { 67  ;2   ;Field     ;
                SourceExpr="Work Type Code";
                Editable="Work Type CodeEditable";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 21  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code";
                Editable="Unit of Measure CodeEditable";
                OnValidate=BEGIN
                             UnitofMeasureCodeOnAfterValida;
                             LockJobDoc;
                           END;
                            }

    { 53  ;2   ;Field     ;
                SourceExpr="Resource Group No.";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 55  ;2   ;Field     ;
                Lookup=Yes;
                SourceExpr="Resource Group Name";
                DrillDownPageID=Page0;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 5   ;2   ;Field     ;
                SourceExpr=Reserve;
                Visible=FALSE;
                OnValidate=BEGIN
                             ReserveOnAfterValidate;
                             LockJobDoc;
                           END;
                            }

    { 15  ;2   ;Field     ;
                SourceExpr=Quantity;
                OnValidate=BEGIN
                             QuantityOnAfterValidate;
                             LockJobDoc;
                           END;
                            }

    { 25  ;2   ;Field     ;
                SourceExpr="Vendor No.";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 28  ;2   ;Field     ;
                SourceExpr="Vendor Name";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 125 ;2   ;Field     ;
                SourceExpr="Reserved Quantity";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 86  ;2   ;Field     ;
                SourceExpr="Quantity (Base)";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 100 ;2   ;Field     ;
                SourceExpr="Remaining Qty.";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 43  ;2   ;Field     ;
                SourceExpr="Direct Unit Cost (LCY)";
                Visible=FALSE;
                Editable=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 41  ;2   ;Field     ;
                SourceExpr="Unit Cost";
                Editable="Unit CostEditable";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 26  ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)" }

    { 93  ;2   ;Field     ;
                SourceExpr="Total Cost";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 90  ;2   ;Field     ;
                SourceExpr="Communication Cost";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 89  ;2   ;Field     ;
                SourceExpr="Total Communication Cost";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 59  ;2   ;Field     ;
                SourceExpr="Backroom Support Cost";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 62  ;2   ;Field     ;
                SourceExpr="Total Backroom Support Cost";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 64  ;2   ;Field     ;
                SourceExpr="In-House Benefits Cost";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 66  ;2   ;Field     ;
                SourceExpr="Total In-House Benefits Cost";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 102 ;2   ;Field     ;
                SourceExpr="Remaining Total Cost";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Total Cost (LCY)" }

    { 104 ;2   ;Field     ;
                SourceExpr="Remaining Total Cost (LCY)";
                Visible=FALSE }

    { 27  ;2   ;Field     ;
                SourceExpr="Unit Price";
                Editable="Unit PriceEditable";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 58  ;2   ;Field     ;
                SourceExpr="Unit Price (LCY)";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Line Amount";
                Editable="Line AmountEditable";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 106 ;2   ;Field     ;
                SourceExpr="Remaining Line Amount";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Line Amount (LCY)";
                Visible=FALSE }

    { 108 ;2   ;Field     ;
                SourceExpr="Remaining Line Amount (LCY)";
                Visible=FALSE }

    { 45  ;2   ;Field     ;
                SourceExpr="Line Discount Amount";
                Editable="Line Discount AmountEditable";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 2   ;2   ;Field     ;
                SourceExpr="Line Discount %";
                Editable="Line Discount %Editable";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 52  ;2   ;Field     ;
                SourceExpr="Total Price";
                Visible=FALSE }

    { 33  ;2   ;Field     ;
                SourceExpr="Total Price (LCY)";
                Visible=FALSE }

    { 110 ;2   ;Field     ;
                SourceExpr="Qty. Posted";
                Visible=FALSE }

    { 112 ;2   ;Field     ;
                SourceExpr="Qty. to Transfer to Journal";
                OnValidate=BEGIN
                             // PHP START
                              IF(Quantity + "Qty. to Transfer to Journal" + "Qty. Posted") < Quantity THEN
                                ERROR(Text010,FIELDCAPTION("Qty. to Transfer to Journal"),(-1 * "Qty. Posted"),(-1 * "Qty. Posted"));
                             // PHP END
                           END;
                            }

    { 114 ;2   ;Field     ;
                SourceExpr="Posted Total Cost";
                Visible=FALSE }

    { 116 ;2   ;Field     ;
                SourceExpr="Posted Total Cost (LCY)";
                Visible=FALSE }

    { 118 ;2   ;Field     ;
                SourceExpr="Posted Line Amount";
                Visible=FALSE }

    { 120 ;2   ;Field     ;
                SourceExpr="Posted Line Amount (LCY)";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Qty. Transferred to Invoice";
                OnDrillDown=BEGIN
                              DrillDownJobInvoices;
                            END;
                             }

    { 8   ;2   ;Field     ;
                SourceExpr="Qty. to Transfer to Invoice" }

    { 10  ;2   ;Field     ;
                SourceExpr="Qty. Invoiced";
                OnDrillDown=BEGIN
                              DrillDownJobInvoices;
                            END;
                             }

    { 12  ;2   ;Field     ;
                SourceExpr="Qty. to Invoice";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 17  ;2   ;Field     ;
                SourceExpr="Invoiced Amount (LCY)";
                OnDrillDown=BEGIN
                              DrillDownJobInvoices;
                            END;
                             }

    { 37  ;2   ;Field     ;
                SourceExpr="Invoiced Cost Amount (LCY)";
                OnDrillDown=BEGIN
                              DrillDownJobInvoices;
                            END;
                             }

    { 84  ;2   ;Field     ;
                SourceExpr="User ID";
                Visible=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Serial No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 63  ;2   ;Field     ;
                SourceExpr="Lot No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 47  ;2   ;Field     ;
                SourceExpr="Job Contract Entry No." }

    { 92  ;2   ;Field     ;
                SourceExpr="Ledger Entry Type";
                Visible=FALSE }

    { 94  ;2   ;Field     ;
                SourceExpr="Ledger Entry No.";
                Visible=FALSE }

    { 96  ;2   ;Field     ;
                SourceExpr="System-Created Entry";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                CaptionML=ENU=Overdue;
                SourceExpr=Overdue;
                Visible=FALSE;
                Editable=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Currency Code";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 22  ;2   ;Field     ;
                SourceExpr="Modified By" }

    { 24  ;2   ;Field     ;
                SourceExpr="Created By" }

    { 31  ;2   ;Field     ;
                SourceExpr="VAT Unit Price";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 32  ;2   ;Field     ;
                SourceExpr="VAT Line Discount Amount";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 34  ;2   ;Field     ;
                SourceExpr="VAT Line Amount";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

    { 36  ;2   ;Field     ;
                SourceExpr="VAT %";
                OnValidate=BEGIN
                             LockJobDoc;
                           END;
                            }

  }
  CODE
  {
    VAR
      TmpExtTextLine@1004 : TEMPORARY Record 280;
      JobCreateInvoice@1000 : Codeunit 1002;
      TransferExtendedText@1009 : Codeunit 378;
      ActiveField@1001 : ' ,Cost,CostLCY,PriceLCY,Price';
      Text001@1002 : TextConst 'ENU=This job planning line was automatically generated. Do you want to continue?';
      JobNo@1003 : Code[20];
      "Job Task No.Visible"@19035147 : Boolean INDATASET;
      "Planning DateEditable"@19058788 : Boolean INDATASET;
      "Currency DateEditable"@19063095 : Boolean INDATASET;
      "Document No.Editable"@19064841 : Boolean INDATASET;
      TypeEditable@19028748 : Boolean INDATASET;
      "No.Editable"@19005397 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      "Unit of Measure CodeEditable"@19052748 : Boolean INDATASET;
      "Variant CodeEditable"@19003611 : Boolean INDATASET;
      "Location CodeEditable"@19048234 : Boolean INDATASET;
      "Work Type CodeEditable"@19027008 : Boolean INDATASET;
      "Unit PriceEditable"@19072822 : Boolean INDATASET;
      "Line Discount AmountEditable"@19003541 : Boolean INDATASET;
      "Line Discount %Editable"@19026131 : Boolean INDATASET;
      "Line AmountEditable"@19064331 : Boolean INDATASET;
      "Unit CostEditable"@19057007 : Boolean INDATASET;
      Text002@1005 : TextConst 'ENU=The %1 was successfully transferred to a %2.';
      AccessDeniedMsg@1007 : TextConst 'ENU=You are not authorized to modify the %1.';
      NoDocument@1014 : TextConst 'ENU=No %1 Document found.';
      UnableToCreateDoc@1015 : TextConst 'ENU=Unable to create %1 document.';
      SuccessCreateDoc@1016 : TextConst 'ENU=%1 no. %2 has been successfully created.';
      AlreadyExists@1019 : TextConst 'ENU=%1 No. %2 %3 already exists in %4 %5';
      Text010@1023 : TextConst 'ENU=%1 may not be lower than %2 and may not exceed %3.';

    LOCAL PROCEDURE CreateSalesInvoice@1(CrMemo@1000 : Boolean);
    VAR
      JobPlanningLine@1007 : Record 1003;
      JobCreateInvoice@1006 : Codeunit 1002;
    BEGIN
      TESTFIELD("Line No.");
      JobPlanningLine.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(JobPlanningLine);
      JobCreateInvoice.CreateSalesInvoice(JobPlanningLine,CrMemo);
    END;

    LOCAL PROCEDURE SetEditable@2(Edit@1000 : Boolean);
    BEGIN
      "Planning DateEditable" := Edit;
      "Currency DateEditable" := Edit;
      "Document No.Editable" := Edit;
      TypeEditable := Edit;
      "No.Editable" := Edit;
      DescriptionEditable := Edit;
      "Unit of Measure CodeEditable" := Edit;
      "Variant CodeEditable" := Edit;
      "Location CodeEditable" := Edit;
      "Work Type CodeEditable" := Edit;
      "Unit PriceEditable" := Edit;
      "Line Discount AmountEditable" := Edit;
      "Line Discount %Editable" := Edit;
      "Line AmountEditable" := Edit;
      "Unit CostEditable" := Edit;
    END;

    PROCEDURE SetActiveField@3(ActiveField2@1000 : Integer);
    BEGIN
      ActiveField := ActiveField2;
    END;

    PROCEDURE SetJobNo@12(No@1000 : Code[20]);
    BEGIN
      JobNo := No;
    END;

    PROCEDURE SetJobTaskNoVisible@5(JobTaskNoVisible@1000 : Boolean);
    BEGIN
      "Job Task No.Visible" := JobTaskNoVisible;
    END;

    LOCAL PROCEDURE PerformAutoReserve@10();
    BEGIN
      IF (Reserve = Reserve::Always) AND
         ("Remaining Qty. (Base)" <> 0)
      THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE UsageLinkOnAfterValidate@19044160();
    BEGIN
      PerformAutoReserve;
    END;

    LOCAL PROCEDURE PlanningDateOnAfterValidate@19037512();
    BEGIN
      IF "Planning Date" <> xRec."Planning Date" THEN
        PerformAutoReserve;
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      // InsertExtendedText(FALSE);
      IF "No." <> xRec."No." THEN
        PerformAutoReserve;
    END;

    LOCAL PROCEDURE VariantCodeOnAfterValidate@19003320();
    BEGIN
      IF "Variant Code" <> xRec."Variant Code" THEN
        PerformAutoReserve;
    END;

    LOCAL PROCEDURE LocationCodeOnAfterValidate@19034787();
    BEGIN
      IF "Location Code" <> xRec."Location Code" THEN
        PerformAutoReserve;
    END;

    LOCAL PROCEDURE UnitofMeasureCodeOnAfterValida@19057939();
    BEGIN
      PerformAutoReserve;
    END;

    LOCAL PROCEDURE ReserveOnAfterValidate@19004502();
    BEGIN
      PerformAutoReserve;
    END;

    LOCAL PROCEDURE QuantityOnAfterValidate@19032465();
    BEGIN
      PerformAutoReserve;
      IF (Type = Type::Item) AND (Quantity <> xRec.Quantity) THEN
        CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE SetFilterResourceAllocation@4(VAR ResourceNo_@1000 : Code[20];VAR PlanningDate_@1001 : Date);
    VAR
      LineTypeFilter_@1002 : TextConst 'ENU=%1|%2';
    BEGIN
      SETFILTER(Type, FORMAT(Type::Resource));
      SETFILTER("No.", ResourceNo_);
      SETFILTER("Planning Date", FORMAT(PlanningDate_));
      SETFILTER("Line Type", '0|2');
      CurrPage.EDITABLE(FALSE);
    END;

    LOCAL PROCEDURE InsertExtendedText@6(Unconditionally@1000 : Boolean);
    BEGIN
      IF TransferExtendedText.JobPlanningLinesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertJobPlanningLinesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE UpdateForm@28(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    PROCEDURE GetRecord@7(VAR JobTask@1000 : Record 1001);
    VAR
      JobTask_@1001 : Record 1001;
    BEGIN
      //JobTask_ :=Rec;
    END;

    LOCAL PROCEDURE OpenPurchaseHeader@42(JobPlanningLines@1000 : Record 1003;PurchaseLineReqType@1001 : Option);
    VAR
      PurchaseHeader@1006 : Record 38;
      PurchaseLine@1007 : Record 39;
      CashAdvancePage@1008 : Page 50021;
      RFPaymentPage@1002 : Page 50554;
      RFPurchasePage@1003 : Page 50031;
    BEGIN

      IF JobPlanningLines."Line Type" = JobPlanningLines."Line Type"::Contract THEN
        EXIT;

      PurchaseLine.SETFILTER("Job No.", JobPlanningLines."Job No.");
      PurchaseLine.SETFILTER("Job Task No.", JobPlanningLines."Job Task No.");
      PurchaseLine.SETRANGE("Job Planning Line No.", JobPlanningLines."Line No.");
      PurchaseLine.SETRANGE("Request Type", PurchaseLineReqType);
      IF PurchaseLine.FINDFIRST AND
        (PurchaseHeader.GET(PurchaseLine."Document Type", PurchaseLine."Document No.")) THEN BEGIN
        IF PurchaseLineReqType = PurchaseLine."Request Type"::"Cash Advance" THEN BEGIN
          CashAdvancePage.SETRECORD(PurchaseHeader);
          CashAdvancePage.RUN;
          EXIT;
        END;
        IF PurchaseLineReqType = PurchaseLine."Request Type"::"Request for Payment" THEN BEGIN
          RFPaymentPage.SETRECORD(PurchaseHeader);
          RFPaymentPage.RUN;
          EXIT;
        END;
        IF PurchaseLineReqType = PurchaseLine."Request Type"::"Request for Purchase" THEN BEGIN
          RFPurchasePage.SETRECORD(PurchaseHeader);
          RFPurchasePage.RUN;
          EXIT;
        END;
      END;

      IF PurchaseLineReqType = PurchaseLine."Request Type"::"Cash Advance" THEN BEGIN
        MESSAGE(NoDocument, PurchaseLine."Request Type"::"Cash Advance");
      END;

      IF PurchaseLineReqType = PurchaseLine."Request Type"::"Request for Payment" THEN BEGIN
        MESSAGE(NoDocument, PurchaseLine."Request Type"::"Request for Payment");
      END;

      IF PurchaseLineReqType = PurchaseLine."Request Type"::"Request for Purchase" THEN BEGIN
        MESSAGE(NoDocument, PurchaseLine."Request Type"::"Request for Purchase");
      END;
    END;

    LOCAL PROCEDURE OpenWithdrawalTERF@26(JobPlanningLines@1000 : Record 1003;SalesLineReqType@1001 : Option);
    VAR
      SalesLine@1004 : Record 37;
      SalesHeader@1003 : Record 36;
      TERFPage@1009 : Page 50568;
      WithdrawalPage@1002 : Page 50562;
    BEGIN

      IF JobPlanningLines."Line Type" = JobPlanningLines."Line Type"::Contract THEN
        EXIT;

      SalesLine.SETFILTER("Job No. 2", JobPlanningLines."Job No.");
      SalesLine.SETFILTER("Job Task No. 2", JobPlanningLines."Job Task No.");
      SalesLine.SETRANGE("Job Planning Line No.", JobPlanningLines."Line No.");
      SalesLine.SETRANGE("Request type", SalesLineReqType);
      IF (SalesLine.FINDFIRST) AND
        (SalesHeader.GET(SalesLine."Document Type", SalesLine."Document No."))THEN BEGIN
        IF SalesLineReqType = SalesLine."Request type"::Withdrawal THEN BEGIN
          WithdrawalPage.SETRECORD(SalesHeader);
          WithdrawalPage.RUN;
          EXIT;
        END;
        IF SalesLineReqType = SalesLine."Request type"::"Tools & Equipment Requisition" THEN BEGIN
          TERFPage.SETRECORD(SalesHeader);
          TERFPage.RUN;
          EXIT;
        END;
      END;

      IF SalesLineReqType = SalesLine."Request type"::Withdrawal THEN BEGIN
        MESSAGE(NoDocument, SalesLine."Request type"::Withdrawal);
      END;

      IF SalesLineReqType = SalesLine."Request type"::"Tools & Equipment Requisition" THEN BEGIN
        MESSAGE(NoDocument, SalesLine."Request type"::"Tools & Equipment Requisition");
      END;
    END;

    LOCAL PROCEDURE LockJobDoc@45();
    VAR
      Job@1001 : Record 167;
    BEGIN
      IF Job.GET("Job No.") THEN BEGIN
        Job.TESTFIELD(Status, Job.Status::Planning);
      END;
      // IF Jobs.GET(JobNo) AND (Jobs.Status = Jobs.Status::Order) THEN BEGIN
      //  Jobs.FIELDERROR(Status);
      // END;
    END;

    BEGIN
    END.
  }
}

